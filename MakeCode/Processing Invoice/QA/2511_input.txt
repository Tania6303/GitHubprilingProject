[
    {
        "input": [
            {
                "name": "learned_config",
                "value": {
                    "status": "success",
                    "supplier_id": "2511",
                    "supplier_name": "פלסאון בע\"מ",
                    "vendor_tax_id_reference": "512865254",
                    "supplier_phone": "073-2333733",
                    "supplier_email": "megi.moshe@plasson.co.il",
                    "json_files_analyzed": 1,
                    "templates_detected": 1,
                    "config": {
                        "supplier_config": {
                            "supplier_code": "2511",
                            "supplier_name": "פלסאון בע\"מ",
                            "vendor_tax_id_reference": "512865254"
                        },
                        "structure": [
                            {
                                "has_import": false,
                                "has_purchase_orders": false,
                                "has_doc": true,
                                "has_date_range": false,
                                "has_budcode": false,
                                "has_pdaccname": false,
                                "inventory_management": "managed_inventory",
                                "debit_type": "D"
                            }
                        ],
                        "rules": {
                            "invoice_date_format": "DD/MM/YY",
                            "doc_variation": "תעודה אחת (DOCNO) או מרובות (PIVDOC_SUBFORM) - שניהם בתבנית",
                            "validation_data": {
                                "TOTQUANT": 112
                            },
                            "critical_patterns": {
                                "vehicle_rules": {},
                                "partname_rules": {}
                            }
                        },
                        "document_types": [
                            {
                                "type": "חשבונית עם תעודות ללא פירוט",
                                "accnames": [
                                    "63001"
                                ]
                            }
                        ]
                    },
                    "template": {
                        "PINVOICES": [
                            {
                                "SUPNAME": "2511",
                                "CODE": "ש\"ח",
                                "DEBIT": "D",
                                "IVDATE": "25/10/25",
                                "BOOKNUM": "258001606",
                                "DOCNO": "25026833",
                                "PIVDOC_SUBFORM": [
                                    {
                                        "DOCNO": "",
                                        "BOOKNUM": ""
                                    }
                                ]
                            }
                        ],
                        "document_types_count": 1
                    },
                    "recommended_samples": {
                        "samples": [
                            {
                                "sample_ivnum": "25067860",
                                "sample_booknum": "258001606",
                                "sample_impfnum": "",
                                "sample_supname": "2511"
                            }
                        ]
                    }
                }
            },
            {
                "name": "docs_list",
                "value": {
                    "list_of_docs": [
                        "{\"DOCNO\":\"25026833\",\"BOOKNUM\":\"108367753\",\"TOTQUANT\":112}"
                    ],
                    "DOC_YES_NO": "N"
                }
            },
            {
                "name": "import_files",
                "value": {
                    "IMPFILES": [
                        ""
                    ]
                }
            },
            {
                "name": "AZURE_RESULT",
                "value": {
                    "structure": {
                        "docType": "string",
                        "fields": {
                            "BillingAddress": "string",
                            "BillingAddress_houseNumber": "string",
                            "BillingAddress_road": "string",
                            "BillingAddress_streetAddress": "string",
                            "BillingAddress_house": "string",
                            "BillingAddressRecipient": "string",
                            "CustomerAddress": "string",
                            "CustomerAddress_houseNumber": "string",
                            "CustomerAddress_road": "string",
                            "CustomerAddress_streetAddress": "string",
                            "CustomerAddressRecipient": "string",
                            "CustomerName": "string",
                            "CustomerTaxId": "string",
                            "DueDate": "YYYY-MM-DD",
                            "InvoiceDate": "YYYY-MM-DD",
                            "InvoiceId": "string",
                            "InvoiceTotal_amount": "number",
                            "InvoiceTotal_currency": "string",
                            "PaymentTerm": "string",
                            "SubTotal_amount": "number",
                            "SubTotal_currency": "string",
                            "TotalTax_amount": "number",
                            "TotalTax_currency": "string",
                            "VendorAddress": "string",
                            "VendorAddress_house": "string",
                            "VendorAddressRecipient": "string",
                            "VendorName": "string",
                            "VendorTaxId": "string",
                            "VendorTel": "string",
                            "VendorFax": "string",
                            "VendorEmail": "string",
                            "UnidentifiedNumbers": [
                                "object"
                            ]
                        },
                        "Items": [
                            {
                                "Amount_amount": "number",
                                "Amount_currency": "string",
                                "Description": "string",
                                "ProductCode": "string",
                                "Quantity": "number",
                                "Unit": "string",
                                "UnitPrice_amount": "number",
                                "UnitPrice_currency": "string"
                            }
                        ]
                    },
                    "data": {
                        "docType": "invoice",
                        "fields": {
                            "BillingAddress": "הקטיף 11\nפארק תעשיות עמק חפר 3877701\nפארק תעשיות עמק חפר 3877701",
                            "BillingAddress_houseNumber": "11",
                            "BillingAddress_road": "הקטיף",
                            "BillingAddress_streetAddress": "11 הקטיף",
                            "BillingAddress_house": "פארק תעשיות עמק חפר 3877701\nפארק תעשיות עמק חפר 3877701",
                            "BillingAddressRecipient": "ט.פ.י פל-ים בע״מ",
                            "CustomerAddress": "הקטיף 11",
                            "CustomerAddress_houseNumber": "11",
                            "CustomerAddress_road": "הקטיף",
                            "CustomerAddress_streetAddress": "11 הקטיף",
                            "CustomerAddressRecipient": "ט.פ.י פל-ים בע״מ",
                            "CustomerName": "ט.פ.י פל-ים בע״מ",
                            "CustomerTaxId": "513327064",
                            "DueDate": "2026-02-28",
                            "InvoiceDate": "2025-10-26",
                            "InvoiceId": "258001606",
                            "InvoiceTotal_amount": 13876.8,
                            "InvoiceTotal_currency": "ILS",
                            "Items": [
                                {
                                    "Amount_amount": 11760,
                                    "Amount_currency": "ILS",
                                    "Description": "מיכל קלסאון לבן מורכב",
                                    "ProductCode": "33007400",
                                    "Quantity": 112,
                                    "Unit": "חי",
                                    "UnitPrice_amount": 105,
                                    "UnitPrice_currency": "ILS"
                                }
                            ],
                            "PaymentTerm": "שוטף + 120",
                            "SubTotal_amount": 11760,
                            "SubTotal_currency": "ILS",
                            "TotalTax_amount": 2116.8,
                            "TotalTax_currency": "ILS",
                            "VendorAddress": "מעגן מיכאל, ד.נ.",
                            "VendorAddress_house": "מעגן מיכאל, ד.נ.",
                            "VendorAddressRecipient": "פלסאון בע״מ",
                            "VendorName": "PLASSON®",
                            "VendorTaxId": "512865254",
                            "VendorTel": "04-6394721",
                            "VendorFax": "04-6394816",
                            "VendorEmail": "Yaels@plasson.co.il",
                            "UnidentifiedNumbers": [
                                {
                                    "label": "לפירעון עד",
                                    "value": "28/02/2026"
                                },
                                {
                                    "label": "הקמת הזמנה",
                                    "value": "Moshe, Megi"
                                },
                                {
                                    "label": "הפקת חשבונית",
                                    "value": "Sharett, Yael"
                                },
                                {
                                    "label": "מס׳ הקצאה (BOOKNUM)",
                                    "value": "108367753",
                                    "context": "ון: 60000014 מס׳ תעודת משלוח: 108367753 הערות: מס׳ מק״ט לקוח מק״ט פלס"
                                }
                            ]
                        }
                    },
                    "metadata": {
                        "modelId": "prebuilt-invoice",
                        "totalFields": 33,
                        "uniqueDataFound": 4
                    },
                    "status": "success"
                }
            },
            {
                "name": "AZURE_TEXT",
                "value": "{\"status\":\"succeeded\",\"createdDateTime\":\"2025-11-02T09:07:02Z\",\"lastUpdatedDateTime\":\"2025-11-02T09:07:05Z\",\"analyzeResult\":{\"apiVersion\":\"2023-07-31\",\"modelId\":\"prebuilt-invoice\",\"stringIndexType\":\"textElements\",\"content\":\"מסמך ממוחשב\\nחתום דיגיטלית ומאושר\\nעל ידי גורם מאשר\\npersonal\\nפלסאון בע״מ | מס׳ עוסק מורשה 512865254 | פטור מניכוי מס הכנסה במקור לפי אישור פקיד שומה חיפה\\n-\\nPLASSON®\\nמעגן מיכאל, ד.נ. מנשה 3780500 | טלפון: 04-6394721, פקס: 04-6394816 | www.plasson.co.il | Yaels@plasson.co.il\\nעמוד 1 מתוך 1\\nחשבונית מס מספר: 258001606\\nמקור\\nמסמך ממוחשב\\nלכבוד:\\nיעד למשלוח:\\nתאריך: 26/10/2025\\nט.פ.י פל-ים בע״מ\\nט.פ.י פל-ים בע״מ\\nמס׳ לקוח: 1340 ע.מ. לקוח: 513327064\\nהקטיף 11\\nהקטיף 11\\nמס׳ הזמנת לקוח: 2501005924\\nפארק תעשיות עמק חפר 3877701\\nפארק תעשיות עמק חפר 3877701\\nמס׳ הזמנת פלסאון: 60000014\\nמס׳ תעודת משלוח: 108367753\\nהערות:\\nמס׳\\nמק״ט לקוח\\nמק״ט פלסאון\\nתיאור\\nיח׳\\nכמות\\nמחיר\\nסכום\\nאחוז\\nסכום\\nמידה\\nיח׳\\nברוטו\\nהנחה\\nנטו\\nב- ש״ח\\nב-ש״ח\\nב-ש״ח\\n1\\n33007400\\nמיכל קלסאון לבן מורכב\\nחי\\n112\\n105.00\\n11,760.00\\n0.00\\n11,760.00\\nלפירעון עד: 28/02/2026\\nסה״כ ברוטו בש״ח:\\n11,760.00\\nתנאי תשלום: שוטף + 120\\nהקמת הזמנה: Moshe, Megi\\nסה״כ נטו:\\n11,760.00\\nהפקת חשבונית: Sharett, Yael\\nמע״מ 18%:\\n2,116.80\\nפלסאון בע״מ\\nסה״כ לתשלום בש״ח:\\n13,876.80\",\"pages\":[{\"pageNumber\":1,\"angle\":0,\"width\":11.6806,\"height\":8.2639,\"unit\":\"inch\",\"words\":[{\"content\":\"מסמך\",\"polygon\":[0.4005,0.1572,0.5779,0.1572,0.5729,0.2332,0.3954,0.2332],\"confidence\":0.98,\"span\":{\"offset\":0,\"length\":4}},{\"content\":\"ממוחשב\",\"polygon\":[0.1217,0.1572,0.3853,0.1572,0.3802,0.2332,0.1217,0.2332],\"confidence\":0.982,\"span\":{\"offset\":5,\"length\":6}},{\"content\":\"חתום\",\"polygon\":[0.4563,0.2434,0.5678,0.2484,0.5678,0.3042,0.4563,0.2991],\"confidence\":0.976,\"span\":{\"offset\":12,\"length\":4}},{\"content\":\"דיגיטלית\",\"polygon\":[0.2788,0.2434,0.4461,0.2434,0.4461,0.2991,0.2788,0.2991],\"confidence\":0.961,\"span\":{\"offset\":17,\"length\":8}},{\"content\":\"ומאושר\",\"polygon\":[0.1166,0.2383,0.2687,0.2434,0.2687,0.2991,0.1217,0.2991],\"confidence\":0.976,\"span\":{\"offset\":26,\"length\":6}},{\"content\":\"על\",\"polygon\":[0.4613,0.3042,0.5171,0.3042,0.512,0.3549,0.4613,0.3549],\"confidence\":0.982,\"span\":{\"offset\":33,\"length\":2}},{\"content\":\"ידי\",\"polygon\":[0.3904,0.3042,0.4512,0.3042,0.4512,0.3549,0.3904,0.3549],\"confidence\":0.982,\"span\":{\"offset\":36,\"length\":3}},{\"content\":\"גורם\",\"polygon\":[0.2991,0.3042,0.3802,0.3042,0.3802,0.3549,0.3042,0.3549],\"confidence\":0.982,\"span\":{\"offset\":40,\"length\":4}},{\"content\":\"מאשר\",\"polygon\":[0.1673,0.3042,0.289,0.3042,0.294,0.3549,0.1724,0.3549],\"confidence\":0.982,\"span\":{\"offset\":45,\"length\":4}},{\"content\":\"personal\",\"polygon\":[0.076,0.4157,0.4411,0.4005,0.4461,0.4867,0.0811,0.4867],\"confidence\":0.767,\"span\":{\"offset\":50,\"length\":8}},{\"content\":\"פלסאון\",\"polygon\":[9.5716,0.5678,9.9163,0.5678,9.9163,0.6946,9.5716,0.6946],\"confidence\":0.961,\"span\":{\"offset\":59,\"length\":6}},{\"content\":\"בע״מ\",\"polygon\":[9.3586,0.5678,9.5462,0.5678,9.5462,0.6946,9.3586,0.6946],\"confidence\":0.954,\"span\":{\"offset\":66,\"length\":4}},{\"content\":\"|\",\"polygon\":[9.242,0.5678,9.3181,0.5678,9.3181,0.6946,9.242,0.6946],\"confidence\":0.96,\"span\":{\"offset\":71,\"length\":1}},{\"content\":\"מס׳\",\"polygon\":[9.0291,0.5678,9.2218,0.5678,9.2167,0.6946,9.0291,0.6946],\"confidence\":0.826,\"span\":{\"offset\":73,\"length\":3}},{\"content\":\"עוסק\",\"polygon\":[8.8263,0.5678,9.0088,0.5678,9.0038,0.6946,8.8263,0.6946],\"confidence\":0.976,\"span\":{\"offset\":77,\"length\":4}},{\"content\":\"מורשה\",\"polygon\":[8.5323,0.5678,8.801,0.5678,8.801,0.6946,8.5323,0.6946],\"confidence\":0.982,\"span\":{\"offset\":82,\"length\":5}},{\"content\":\"512865254\",\"polygon\":[8.0456,0.5678,8.5069,0.5678,8.5069,0.6946,8.0456,0.6946],\"confidence\":0.937,\"span\":{\"offset\":88,\"length\":9}},{\"content\":\"|\",\"polygon\":[7.9594,0.5678,8.0253,0.5678,8.0202,0.6946,7.9594,0.6946],\"confidence\":0.883,\"span\":{\"offset\":98,\"length\":1}},{\"content\":\"פטור\",\"polygon\":[7.7262,0.5678,7.9341,0.5678,7.9341,0.6946,7.7262,0.6946],\"confidence\":0.953,\"span\":{\"offset\":100,\"length\":4}},{\"content\":\"מניכוי\",\"polygon\":[7.4474,0.5678,7.7059,0.5678,7.7009,0.6946,7.4474,0.6946],\"confidence\":0.962,\"span\":{\"offset\":105,\"length\":6}},{\"content\":\"מס\",\"polygon\":[7.3358,0.5678,7.4271,0.5678,7.422,0.6946,7.3358,0.6946],\"confidence\":0.961,\"span\":{\"offset\":112,\"length\":2}},{\"content\":\"הכנסה\",\"polygon\":[7.0317,0.5678,7.3105,0.5678,7.3105,0.6946,7.0317,0.6946],\"confidence\":0.92,\"span\":{\"offset\":115,\"length\":5}},{\"content\":\"במקור\",\"polygon\":[6.7376,0.5729,7.0063,0.5678,7.0063,0.6946,6.7376,0.6946],\"confidence\":0.981,\"span\":{\"offset\":121,\"length\":5}},{\"content\":\"לפי\",\"polygon\":[6.55,0.5729,6.7123,0.5729,6.7123,0.6946,6.55,0.6946],\"confidence\":0.982,\"span\":{\"offset\":127,\"length\":3}},{\"content\":\"אישור\",\"polygon\":[6.3168,0.5729,6.5247,0.5729,6.5247,0.6946,6.3168,0.6946],\"confidence\":0.981,\"span\":{\"offset\":131,\"length\":5}},{\"content\":\"פקיד\",\"polygon\":[6.0836,0.5729,6.2965,0.5729,6.2965,0.6946,6.0786,0.6946],\"confidence\":0.98,\"span\":{\"offset\":137,\"length\":4}},{\"content\":\"שומה\",\"polygon\":[5.8453,0.5729,6.0583,0.5729,6.0583,0.6946,5.8453,0.6946],\"confidence\":0.982,\"span\":{\"offset\":142,\"length\":4}},{\"content\":\"חיפה\",\"polygon\":[5.6071,0.5729,5.82,0.5729,5.82,0.6946,5.6071,0.6946],\"confidence\":0.982,\"span\":{\"offset\":147,\"length\":4}},{\"content\":\"-\",\"polygon\":[3.3308,0.6388,3.4778,0.6337,3.4829,0.9379,3.3359,0.943],\"confidence\":0.866,\"span\":{\"offset\":152,\"length\":1}},{\"content\":\"PLASSON®\",\"polygon\":[1.1559,0.5678,2.1495,0.5628,2.1546,0.7149,1.1559,0.7453],\"confidence\":0.892,\"span\":{\"offset\":154,\"length\":8}},{\"content\":\"מעגן\",\"polygon\":[9.6882,0.7098,9.9163,0.7149,9.9214,0.8365,9.6932,0.8365],\"confidence\":0.951,\"span\":{\"offset\":163,\"length\":4}},{\"content\":\"מיכאל,\",\"polygon\":[9.3789,0.7098,9.6628,0.7098,9.6679,0.8365,9.3789,0.8365],\"confidence\":0.945,\"span\":{\"offset\":168,\"length\":6}},{\"content\":\"ד.נ.\",\"polygon\":[9.2218,0.7098,9.3536,0.7098,9.3586,0.8365,9.2218,0.8365],\"confidence\":0.976,\"span\":{\"offset\":175,\"length\":4}},{\"content\":\"מנשה\",\"polygon\":[8.9987,0.7098,9.1964,0.7098,9.1964,0.8365,8.9987,0.8365],\"confidence\":0.961,\"span\":{\"offset\":180,\"length\":4}},{\"content\":\"3780500\",\"polygon\":[8.6185,0.7098,8.9733,0.7098,8.9784,0.8365,8.6185,0.8365],\"confidence\":0.961,\"span\":{\"offset\":185,\"length\":7}},{\"content\":\"|\",\"polygon\":[8.5221,0.7098,8.5931,0.7098,8.5931,0.8365,8.5221,0.8365],\"confidence\":0.863,\"span\":{\"offset\":193,\"length\":1}},{\"content\":\"טלפון:\",\"polygon\":[8.218,0.7098,8.4968,0.7098,8.5019,0.8365,8.223,0.8365],\"confidence\":0.946,\"span\":{\"offset\":195,\"length\":6}},{\"content\":\"04-6394721,\",\"polygon\":[7.6958,0.7098,8.1977,0.7098,8.1977,0.8365,7.7009,0.8365],\"confidence\":0.892,\"span\":{\"offset\":202,\"length\":11}},{\"content\":\"פקס:\",\"polygon\":[7.4575,0.7149,7.6704,0.7098,7.6755,0.8365,7.4626,0.8365],\"confidence\":0.941,\"span\":{\"offset\":214,\"length\":4}},{\"content\":\"04-6394816\",\"polygon\":[6.981,0.7149,7.4322,0.7149,7.4372,0.8365,6.986,0.8365],\"confidence\":0.923,\"span\":{\"offset\":219,\"length\":10}},{\"content\":\"|\",\"polygon\":[6.8846,0.7149,6.9556,0.7149,6.9607,0.8365,6.8897,0.8365],\"confidence\":0.921,\"span\":{\"offset\":230,\"length\":1}},{\"content\":\"www.plasson.co.il\",\"polygon\":[5.313,0.725,6.0025,0.7199,6.0076,0.8365,5.3181,0.8315],\"confidence\":0.846,\"span\":{\"offset\":232,\"length\":17}},{\"content\":\"|\",\"polygon\":[6.0279,0.7199,6.0938,0.7199,6.0938,0.8365,6.0329,0.8365],\"confidence\":0.961,\"span\":{\"offset\":250,\"length\":1}},{\"content\":\"Yaels@plasson.co.il\",\"polygon\":[6.114,0.7199,6.8644,0.7149,6.8644,0.8365,6.1191,0.8365],\"confidence\":0.866,\"span\":{\"offset\":252,\"length\":19}},{\"content\":\"עמוד\",\"polygon\":[1.6578,1.3486,1.9468,1.3486,1.9468,1.526,1.6578,1.526],\"confidence\":0.982,\"span\":{\"offset\":272,\"length\":4}},{\"content\":\"1\",\"polygon\":[1.531,1.3486,1.6223,1.3486,1.6223,1.521,1.531,1.521],\"confidence\":0.982,\"span\":{\"offset\":277,\"length\":1}},{\"content\":\"מתוך\",\"polygon\":[1.2167,1.3486,1.4956,1.3435,1.4956,1.521,1.2167,1.521],\"confidence\":0.982,\"span\":{\"offset\":279,\"length\":4}},{\"content\":\"1\",\"polygon\":[1.09,1.3486,1.1762,1.3486,1.1762,1.521,1.09,1.521],\"confidence\":0.982,\"span\":{\"offset\":284,\"length\":1}},{\"content\":\"חשבונית\",\"polygon\":[6.1546,1.5919,6.7478,1.597,6.7427,1.7795,6.1495,1.7795],\"confidence\":0.977,\"span\":{\"offset\":286,\"length\":7}},{\"content\":\"מס\",\"polygon\":[5.8859,1.5919,6.0988,1.5919,6.0938,1.7795,5.8808,1.7795],\"confidence\":0.982,\"span\":{\"offset\":294,\"length\":2}},{\"content\":\"מספר:\",\"polygon\":[5.3789,1.5869,5.8504,1.5919,5.8453,1.7795,5.3739,1.7745],\"confidence\":0.982,\"span\":{\"offset\":297,\"length\":5}},{\"content\":\"258001606\",\"polygon\":[4.4208,1.5869,5.308,1.5869,5.3029,1.7745,4.4157,1.7694],\"confidence\":0.93,\"span\":{\"offset\":303,\"length\":9}},{\"content\":\"מקור\",\"polygon\":[3.2142,1.7238,3.5589,1.7238,3.5589,1.9012,3.2142,1.9012],\"confidence\":0.982,\"span\":{\"offset\":313,\"length\":4}},{\"content\":\"מסמך\",\"polygon\":[1.6426,1.7238,2.0786,1.7187,2.0786,1.8911,1.6426,1.8911],\"confidence\":0.98,\"span\":{\"offset\":318,\"length\":4}},{\"content\":\"ממוחשב\",\"polygon\":[0.9734,1.7136,1.602,1.7238,1.602,1.8911,0.9835,1.8911],\"confidence\":0.966,\"span\":{\"offset\":323,\"length\":6}},{\"content\":\"לכבוד:\",\"polygon\":[9.4803,1.9519,9.9112,1.9418,9.9112,2.0989,9.4905,2.0989],\"confidence\":0.961,\"span\":{\"offset\":330,\"length\":6}},{\"content\":\"יעד\",\"polygon\":[6.9404,1.9367,7.1685,1.9418,7.1685,2.0989,6.9404,2.0989],\"confidence\":0.982,\"span\":{\"offset\":337,\"length\":3}},{\"content\":\"למשלוח:\",\"polygon\":[6.3574,1.9367,6.9049,1.9367,6.91,2.0989,6.3625,2.104],\"confidence\":0.966,\"span\":{\"offset\":341,\"length\":7}},{\"content\":\"תאריך:\",\"polygon\":[3.6705,1.9367,4.1369,1.9418,4.1318,2.1141,3.6654,2.1091],\"confidence\":0.964,\"span\":{\"offset\":349,\"length\":6}},{\"content\":\"26/10/2025\",\"polygon\":[2.8441,1.9316,3.6198,1.9367,3.6147,2.1091,2.839,2.1091],\"confidence\":0.916,\"span\":{\"offset\":356,\"length\":10}},{\"content\":\"ט.פ.י\",\"polygon\":[9.5158,2.1344,9.9112,2.1395,9.9112,2.322,9.5209,2.322],\"confidence\":0.98,\"span\":{\"offset\":367,\"length\":5}},{\"content\":\"פל-ים\",\"polygon\":[9.1254,2.1293,9.4803,2.1344,9.4803,2.322,9.1254,2.3271],\"confidence\":0.966,\"span\":{\"offset\":373,\"length\":5}},{\"content\":\"בע״מ\",\"polygon\":[8.6641,2.1243,9.0747,2.1293,9.0798,2.3271,8.6692,2.3321],\"confidence\":0.81,\"span\":{\"offset\":379,\"length\":4}},{\"content\":\"ט.פ.י\",\"polygon\":[6.8491,2.1344,7.1685,2.1344,7.1685,2.2967,6.8491,2.2916],\"confidence\":0.98,\"span\":{\"offset\":384,\"length\":5}},{\"content\":\"פל-ים\",\"polygon\":[6.5145,2.1344,6.8137,2.1344,6.8187,2.2916,6.5196,2.2967],\"confidence\":0.981,\"span\":{\"offset\":390,\"length\":5}},{\"content\":\"בע״מ\",\"polygon\":[6.1597,2.1293,6.4841,2.1344,6.4841,2.2967,6.1647,2.3017],\"confidence\":0.737,\"span\":{\"offset\":396,\"length\":4}},{\"content\":\"מס׳\",\"polygon\":[3.8884,2.1293,4.1318,2.1293,4.1318,2.2967,3.8884,2.3017],\"confidence\":0.867,\"span\":{\"offset\":401,\"length\":3}},{\"content\":\"לקוח:\",\"polygon\":[3.5386,2.1293,3.853,2.1293,3.853,2.3017,3.5386,2.3017],\"confidence\":0.931,\"span\":{\"offset\":405,\"length\":5}},{\"content\":\"1340\",\"polygon\":[3.1787,2.1293,3.5032,2.1293,3.5032,2.3017,3.1787,2.3068],\"confidence\":0.98,\"span\":{\"offset\":411,\"length\":4}},{\"content\":\"ע.מ.\",\"polygon\":[2.7021,2.1293,2.9962,2.1293,2.9962,2.3068,2.7021,2.3068],\"confidence\":0.982,\"span\":{\"offset\":416,\"length\":4}},{\"content\":\"לקוח:\",\"polygon\":[2.3523,2.1293,2.6667,2.1293,2.6667,2.3068,2.3523,2.3068],\"confidence\":0.965,\"span\":{\"offset\":421,\"length\":5}},{\"content\":\"513327064\",\"polygon\":[1.5868,2.1243,2.3168,2.1243,2.3168,2.3068,1.5817,2.3068],\"confidence\":0.933,\"span\":{\"offset\":427,\"length\":9}},{\"content\":\"הקטיף\",\"polygon\":[9.5158,2.3524,9.9163,2.3626,9.9163,2.5349,9.5209,2.5299],\"confidence\":0.976,\"span\":{\"offset\":437,\"length\":5}},{\"content\":\"11\",\"polygon\":[9.2978,2.3524,9.4752,2.3524,9.4752,2.5299,9.3029,2.5299],\"confidence\":0.982,\"span\":{\"offset\":443,\"length\":2}},{\"content\":\"הקטיף\",\"polygon\":[6.8086,2.3321,7.1736,2.3321,7.1787,2.4994,6.8137,2.4944],\"confidence\":0.982,\"span\":{\"offset\":446,\"length\":5}},{\"content\":\"11\",\"polygon\":[6.5906,2.3271,6.7579,2.3321,6.763,2.4944,6.5957,2.4893],\"confidence\":0.982,\"span\":{\"offset\":452,\"length\":2}},{\"content\":\"מס׳\",\"polygon\":[3.8935,2.322,4.1419,2.322,4.1419,2.4893,3.8986,2.4944],\"confidence\":0.829,\"span\":{\"offset\":455,\"length\":3}},{\"content\":\"הזמנת\",\"polygon\":[3.5538,2.322,3.858,2.322,3.8631,2.4944,3.5589,2.4944],\"confidence\":0.982,\"span\":{\"offset\":459,\"length\":5}},{\"content\":\"לקוח:\",\"polygon\":[3.1533,2.322,3.5234,2.322,3.5285,2.4944,3.1533,2.4944],\"confidence\":0.976,\"span\":{\"offset\":465,\"length\":5}},{\"content\":\"2501005924\",\"polygon\":[2.3067,2.322,3.1179,2.322,3.1229,2.4944,2.3118,2.4842],\"confidence\":0.919,\"span\":{\"offset\":471,\"length\":10}},{\"content\":\"פארק\",\"polygon\":[9.5716,2.5501,9.9011,2.5552,9.9011,2.7225,9.5716,2.7276],\"confidence\":0.982,\"span\":{\"offset\":482,\"length\":4}},{\"content\":\"תעשיות\",\"polygon\":[9.0747,2.5451,9.5361,2.5501,9.5361,2.7276,9.0798,2.7276],\"confidence\":0.961,\"span\":{\"offset\":487,\"length\":6}},{\"content\":\"עמק\",\"polygon\":[8.7604,2.5451,9.0342,2.5451,9.0342,2.7276,8.7604,2.7276],\"confidence\":0.982,\"span\":{\"offset\":494,\"length\":3}},{\"content\":\"חפר\",\"polygon\":[8.4867,2.54,8.7249,2.5451,8.7249,2.7276,8.4917,2.7276],\"confidence\":0.951,\"span\":{\"offset\":498,\"length\":3}},{\"content\":\"3877701\",\"polygon\":[7.8529,2.5299,8.4512,2.54,8.4562,2.7225,7.8529,2.7124],\"confidence\":0.961,\"span\":{\"offset\":502,\"length\":7}},{\"content\":\"פארק\",\"polygon\":[6.8339,2.5248,7.1685,2.5299,7.1685,2.687,6.839,2.6921],\"confidence\":0.982,\"span\":{\"offset\":510,\"length\":4}},{\"content\":\"תעשיות\",\"polygon\":[6.3777,2.5147,6.7984,2.5248,6.8035,2.6921,6.3777,2.6921],\"confidence\":0.961,\"span\":{\"offset\":515,\"length\":6}},{\"content\":\"עמק\",\"polygon\":[6.0786,2.5096,6.332,2.5147,6.3371,2.6921,6.0836,2.6921],\"confidence\":0.982,\"span\":{\"offset\":522,\"length\":3}},{\"content\":\"חפר\",\"polygon\":[5.8149,2.5096,6.0431,2.5096,6.0481,2.6921,5.82,2.6921],\"confidence\":0.979,\"span\":{\"offset\":526,\"length\":3}},{\"content\":\"3877701\",\"polygon\":[5.1863,2.5096,5.7794,2.5096,5.7845,2.6921,5.1914,2.687],\"confidence\":0.961,\"span\":{\"offset\":530,\"length\":7}},{\"content\":\"מס׳\",\"polygon\":[3.8884,2.5096,4.1419,2.5096,4.1419,2.687,3.8884,2.687],\"confidence\":0.872,\"span\":{\"offset\":538,\"length\":3}},{\"content\":\"הזמנת\",\"polygon\":[3.564,2.5096,3.853,2.5096,3.853,2.687,3.564,2.682],\"confidence\":0.982,\"span\":{\"offset\":542,\"length\":5}},{\"content\":\"פלסאון:\",\"polygon\":[3.0317,2.5147,3.5285,2.5096,3.5336,2.682,3.0317,2.682],\"confidence\":0.961,\"span\":{\"offset\":548,\"length\":7}},{\"content\":\"60000014\",\"polygon\":[2.3523,2.5147,2.9962,2.5147,3.0013,2.682,2.3574,2.6769],\"confidence\":0.965,\"span\":{\"offset\":556,\"length\":8}},{\"content\":\"מס׳\",\"polygon\":[3.8834,2.7022,4.1267,2.7022,4.1267,2.8746,3.8884,2.8746],\"confidence\":0.865,\"span\":{\"offset\":565,\"length\":3}},{\"content\":\"תעודת\",\"polygon\":[3.5437,2.7022,3.853,2.7022,3.853,2.8746,3.5488,2.8746],\"confidence\":0.982,\"span\":{\"offset\":569,\"length\":5}},{\"content\":\"משלוח:\",\"polygon\":[3.0317,2.7022,3.5133,2.7022,3.5133,2.8746,3.0317,2.8695],\"confidence\":0.961,\"span\":{\"offset\":575,\"length\":6}},{\"content\":\"108367753\",\"polygon\":[2.2864,2.7022,2.9962,2.7022,3.0013,2.8695,2.2864,2.8594],\"confidence\":0.961,\"span\":{\"offset\":582,\"length\":9}},{\"content\":\"הערות:\",\"polygon\":[9.46,3.0115,9.9163,3.0115,9.9163,3.1484,9.4651,3.1484],\"confidence\":0.976,\"span\":{\"offset\":592,\"length\":6}},{\"content\":\"מס׳\",\"polygon\":[9.6425,3.3106,9.8149,3.3106,9.8098,3.4171,9.6425,3.412],\"confidence\":0.878,\"span\":{\"offset\":599,\"length\":3}},{\"content\":\"מק״ט\",\"polygon\":[8.948,3.3157,9.2116,3.3157,9.2116,3.4374,8.948,3.4424],\"confidence\":0.964,\"span\":{\"offset\":603,\"length\":4}},{\"content\":\"לקוח\",\"polygon\":[8.6996,3.3208,8.9226,3.3157,8.9226,3.4424,8.7047,3.4424],\"confidence\":0.976,\"span\":{\"offset\":608,\"length\":4}},{\"content\":\"מק״ט\",\"polygon\":[7.7972,3.3106,8.0608,3.3106,8.0608,3.4374,7.7972,3.4374],\"confidence\":0.961,\"span\":{\"offset\":613,\"length\":4}},{\"content\":\"פלסאון\",\"polygon\":[7.4322,3.3157,7.7718,3.3106,7.7718,3.4374,7.4372,3.4424],\"confidence\":0.982,\"span\":{\"offset\":618,\"length\":6}},{\"content\":\"תיאור\",\"polygon\":[5.8149,3.3309,6.0684,3.3258,6.0684,3.4222,5.8149,3.4171],\"confidence\":0.98,\"span\":{\"offset\":625,\"length\":5}},{\"content\":\"יח׳\",\"polygon\":[4.4512,3.3157,4.5982,3.3157,4.5931,3.407,4.4512,3.4019],\"confidence\":0.776,\"span\":{\"offset\":631,\"length\":3}},{\"content\":\"כמות\",\"polygon\":[3.8834,3.3258,4.0912,3.3258,4.0912,3.4171,3.8834,3.4222],\"confidence\":0.982,\"span\":{\"offset\":635,\"length\":4}},{\"content\":\"מחיר\",\"polygon\":[3.2345,3.3309,3.4474,3.3309,3.4423,3.4222,3.2294,3.4171],\"confidence\":0.982,\"span\":{\"offset\":640,\"length\":4}},{\"content\":\"סכום\",\"polygon\":[2.5146,3.3309,2.7021,3.3309,2.7021,3.4171,2.5146,3.4171],\"confidence\":0.982,\"span\":{\"offset\":645,\"length\":4}},{\"content\":\"אחוז\",\"polygon\":[1.8048,3.3258,2.0177,3.3258,2.0127,3.4272,1.8048,3.4222],\"confidence\":0.982,\"span\":{\"offset\":650,\"length\":4}},{\"content\":\"סכום\",\"polygon\":[1.0646,3.3309,1.2573,3.3309,1.2573,3.4222,1.0646,3.4171],\"confidence\":0.982,\"span\":{\"offset\":655,\"length\":4}},{\"content\":\"מידה\",\"polygon\":[4.4258,3.4779,4.6388,3.4779,4.6388,3.5692,4.4258,3.5692],\"confidence\":0.982,\"span\":{\"offset\":660,\"length\":4}},{\"content\":\"יח׳\",\"polygon\":[3.2699,3.4577,3.4322,3.4627,3.4271,3.5641,3.2699,3.554],\"confidence\":0.835,\"span\":{\"offset\":665,\"length\":3}},{\"content\":\"ברוטו\",\"polygon\":[2.4689,3.4779,2.7376,3.483,2.7376,3.5692,2.474,3.5641],\"confidence\":0.976,\"span\":{\"offset\":669,\"length\":5}},{\"content\":\"הנחה\",\"polygon\":[1.8149,3.4729,2.038,3.4729,2.0431,3.5641,1.8149,3.5692],\"confidence\":0.982,\"span\":{\"offset\":675,\"length\":4}},{\"content\":\"נטו\",\"polygon\":[1.0748,3.4729,1.237,3.4729,1.237,3.5692,1.0748,3.5641],\"confidence\":0.926,\"span\":{\"offset\":680,\"length\":3}},{\"content\":\"ב-\",\"polygon\":[3.4068,3.6097,3.5285,3.6148,3.5336,3.7111,3.4068,3.7111],\"confidence\":0.982,\"span\":{\"offset\":684,\"length\":2}},{\"content\":\"ש״ח\",\"polygon\":[3.1838,3.5996,3.3815,3.6097,3.3815,3.7061,3.1838,3.7111],\"confidence\":0.978,\"span\":{\"offset\":687,\"length\":3}},{\"content\":\"ב-ש״ח\",\"polygon\":[2.4487,3.6097,2.7579,3.6097,2.763,3.701,2.4537,3.7061],\"confidence\":0.967,\"span\":{\"offset\":691,\"length\":5}},{\"content\":\"ב-ש״ח\",\"polygon\":[1.0038,3.6097,1.308,3.6148,1.313,3.7111,1.0038,3.7111],\"confidence\":0.966,\"span\":{\"offset\":697,\"length\":5}},{\"content\":\"1\",\"polygon\":[9.8352,3.8785,9.9011,3.8734,9.9112,3.9748,9.8403,3.9798],\"confidence\":0.978,\"span\":{\"offset\":703,\"length\":1}},{\"content\":\"33007400\",\"polygon\":[7.8529,3.8734,8.3701,3.8734,8.3701,4.0001,7.8529,3.99],\"confidence\":0.976,\"span\":{\"offset\":705,\"length\":8}},{\"content\":\"מיכל\",\"polygon\":[6.7782,3.8683,6.9911,3.8683,6.9911,4.0001,6.7782,4.0052],\"confidence\":0.982,\"span\":{\"offset\":714,\"length\":4}},{\"content\":\"קלסאון\",\"polygon\":[6.4284,3.8683,6.7528,3.8683,6.7528,4.0052,6.4284,4.0052],\"confidence\":0.982,\"span\":{\"offset\":719,\"length\":6}},{\"content\":\"לבן\",\"polygon\":[6.256,3.8734,6.403,3.8683,6.403,4.0052,6.256,4.0052],\"confidence\":0.982,\"span\":{\"offset\":726,\"length\":3}},{\"content\":\"מורכב\",\"polygon\":[5.9721,3.8734,6.2256,3.8734,6.2306,4.0052,5.9772,4.0052],\"confidence\":0.982,\"span\":{\"offset\":730,\"length\":5}},{\"content\":\"חי\",\"polygon\":[4.5931,3.8937,4.6996,3.8937,4.6945,3.9798,4.5931,3.9748],\"confidence\":0.779,\"span\":{\"offset\":736,\"length\":2}},{\"content\":\"112\",\"polygon\":[3.9898,3.8734,4.1774,3.8734,4.1774,3.9849,3.9898,3.9849],\"confidence\":0.982,\"span\":{\"offset\":739,\"length\":3}},{\"content\":\"105.00\",\"polygon\":[3.2801,3.8785,3.6248,3.8734,3.6299,3.9951,3.2801,3.99],\"confidence\":0.982,\"span\":{\"offset\":743,\"length\":6}},{\"content\":\"11,760.00\",\"polygon\":[2.3929,3.8734,2.8948,3.8683,2.8999,4.0001,2.398,3.9951],\"confidence\":0.975,\"span\":{\"offset\":750,\"length\":9}},{\"content\":\"0.00\",\"polygon\":[1.9366,3.8683,2.1698,3.8683,2.1698,3.99,1.9316,3.9849],\"confidence\":0.982,\"span\":{\"offset\":760,\"length\":4}},{\"content\":\"11,760.00\",\"polygon\":[1.0139,3.8683,1.526,3.8734,1.531,4.0001,1.019,4.0001],\"confidence\":0.951,\"span\":{\"offset\":765,\"length\":9}},{\"content\":\"לפירעון\",\"polygon\":[9.4955,4.4818,9.9062,4.4868,9.9062,4.6339,9.4955,4.6339],\"confidence\":0.979,\"span\":{\"offset\":775,\"length\":7}},{\"content\":\"עד:\",\"polygon\":[9.2725,4.4818,9.4651,4.4818,9.4651,4.6339,9.2725,4.6339],\"confidence\":0.966,\"span\":{\"offset\":783,\"length\":3}},{\"content\":\"28/02/2026\",\"polygon\":[8.6185,4.4818,9.242,4.4818,9.242,4.6339,8.6235,4.6288],\"confidence\":0.937,\"span\":{\"offset\":787,\"length\":10}},{\"content\":\"סה״כ\",\"polygon\":[2.839,4.502,3.1331,4.497,3.128,4.644,2.834,4.6389],\"confidence\":0.935,\"span\":{\"offset\":798,\"length\":4}},{\"content\":\"ברוטו\",\"polygon\":[2.5044,4.497,2.8086,4.502,2.8086,4.6389,2.5044,4.6389],\"confidence\":0.982,\"span\":{\"offset\":803,\"length\":5}},{\"content\":\"בש״ח:\",\"polygon\":[2.1343,4.4868,2.474,4.497,2.474,4.6389,2.1343,4.6491],\"confidence\":0.936,\"span\":{\"offset\":809,\"length\":5}},{\"content\":\"11,760.00\",\"polygon\":[1.161,4.502,1.6527,4.497,1.6527,4.6389,1.161,4.6339],\"confidence\":0.976,\"span\":{\"offset\":815,\"length\":9}},{\"content\":\"תנאי\",\"polygon\":[9.6578,4.644,9.9264,4.6491,9.9264,4.791,9.6578,4.791],\"confidence\":0.982,\"span\":{\"offset\":825,\"length\":4}},{\"content\":\"תשלום:\",\"polygon\":[9.2319,4.644,9.6324,4.644,9.6324,4.791,9.2319,4.791],\"confidence\":0.974,\"span\":{\"offset\":830,\"length\":6}},{\"content\":\"שוטף\",\"polygon\":[8.9632,4.644,9.2015,4.644,9.2015,4.791,8.9632,4.791],\"confidence\":0.982,\"span\":{\"offset\":837,\"length\":4}},{\"content\":\"+\",\"polygon\":[8.8365,4.644,8.9277,4.644,8.9277,4.791,8.8365,4.791],\"confidence\":0.982,\"span\":{\"offset\":842,\"length\":1}},{\"content\":\"120\",\"polygon\":[8.6185,4.644,8.8111,4.644,8.8111,4.791,8.6185,4.786],\"confidence\":0.982,\"span\":{\"offset\":844,\"length\":3}},{\"content\":\"הקמת\",\"polygon\":[9.6324,4.8113,9.9214,4.8113,9.9214,4.9583,9.6324,4.9583],\"confidence\":0.976,\"span\":{\"offset\":848,\"length\":4}},{\"content\":\"הזמנה:\",\"polygon\":[9.2167,4.8113,9.602,4.8113,9.602,4.9583,9.2167,4.9583],\"confidence\":0.961,\"span\":{\"offset\":853,\"length\":6}},{\"content\":\"Moshe,\",\"polygon\":[8.4207,4.8062,8.8263,4.8062,8.8263,4.9583,8.4207,4.9533],\"confidence\":0.961,\"span\":{\"offset\":860,\"length\":6}},{\"content\":\"Megi\",\"polygon\":[8.8567,4.8062,9.1863,4.8113,9.1863,4.9583,8.8567,4.9583],\"confidence\":0.982,\"span\":{\"offset\":867,\"length\":4}},{\"content\":\"סה״כ\",\"polygon\":[2.839,4.6896,3.1229,4.6846,3.1229,4.8214,2.839,4.8214],\"confidence\":0.958,\"span\":{\"offset\":872,\"length\":4}},{\"content\":\"נטו:\",\"polygon\":[2.5855,4.6896,2.8137,4.6896,2.8137,4.8214,2.5855,4.8214],\"confidence\":0.979,\"span\":{\"offset\":877,\"length\":4}},{\"content\":\"11,760.00\",\"polygon\":[1.1559,4.6896,1.6527,4.6795,1.6527,4.8214,1.1559,4.8113],\"confidence\":0.976,\"span\":{\"offset\":882,\"length\":9}},{\"content\":\"הפקת\",\"polygon\":[9.6375,4.9685,9.9214,4.9735,9.9214,5.1155,9.6375,5.1155],\"confidence\":0.982,\"span\":{\"offset\":892,\"length\":4}},{\"content\":\"חשבונית:\",\"polygon\":[9.095,4.9634,9.6121,4.9685,9.6121,5.1155,9.1001,5.1155],\"confidence\":0.966,\"span\":{\"offset\":897,\"length\":8}},{\"content\":\"Sharett,\",\"polygon\":[8.3599,4.9685,8.7959,4.9634,8.7959,5.1104,8.3599,5.1104],\"confidence\":0.888,\"span\":{\"offset\":906,\"length\":8}},{\"content\":\"Yael\",\"polygon\":[8.8263,4.9634,9.0646,4.9634,9.0697,5.1155,8.8263,5.1104],\"confidence\":0.958,\"span\":{\"offset\":915,\"length\":4}},{\"content\":\"מע״מ\",\"polygon\":[2.834,4.8721,3.1229,4.8721,3.1229,5.009,2.834,5.004],\"confidence\":0.936,\"span\":{\"offset\":920,\"length\":4}},{\"content\":\"18%:\",\"polygon\":[2.4132,4.8721,2.7326,4.8721,2.7326,5.004,2.4132,5.009],\"confidence\":0.979,\"span\":{\"offset\":925,\"length\":4}},{\"content\":\"2,116.80\",\"polygon\":[1.1964,4.8721,1.6527,4.862,1.6527,4.9989,1.1964,4.9989],\"confidence\":0.98,\"span\":{\"offset\":930,\"length\":8}},{\"content\":\"פלסאון\",\"polygon\":[9.531,5.1256,9.9112,5.1256,9.9112,5.2727,9.531,5.2727],\"confidence\":0.976,\"span\":{\"offset\":939,\"length\":6}},{\"content\":\"בע״מ\",\"polygon\":[9.237,5.1307,9.5006,5.1256,9.5057,5.2727,9.237,5.2727],\"confidence\":0.952,\"span\":{\"offset\":946,\"length\":4}},{\"content\":\"סה״כ\",\"polygon\":[2.839,5.0395,3.1331,5.0395,3.128,5.1915,2.839,5.1865],\"confidence\":0.946,\"span\":{\"offset\":951,\"length\":4}},{\"content\":\"לתשלום\",\"polygon\":[2.4081,5.0395,2.8086,5.0395,2.8086,5.1865,2.4081,5.1865],\"confidence\":0.981,\"span\":{\"offset\":956,\"length\":6}},{\"content\":\"בש״ח:\",\"polygon\":[2.0279,5.0395,2.3777,5.0395,2.3828,5.1865,2.0329,5.1966],\"confidence\":0.934,\"span\":{\"offset\":963,\"length\":5}},{\"content\":\"13,876.80\",\"polygon\":[1.1457,5.0496,1.6476,5.0395,1.6476,5.1814,1.1559,5.1763],\"confidence\":0.962,\"span\":{\"offset\":969,\"length\":9}}],\"lines\":[{\"content\":\"מסמך ממוחשב\",\"polygon\":[0.1115,0.1521,0.5779,0.1521,0.5779,0.2332,0.1115,0.2332],\"spans\":[{\"offset\":0,\"length\":11}]},{\"content\":\"חתום דיגיטלית ומאושר\",\"polygon\":[0.1115,0.2383,0.5779,0.2434,0.5779,0.2991,0.1115,0.2941],\"spans\":[{\"offset\":12,\"length\":20}]},{\"content\":\"על ידי גורם מאשר\",\"polygon\":[0.1572,0.2991,0.5222,0.2991,0.5222,0.3549,0.1572,0.3498],\"spans\":[{\"offset\":33,\"length\":16}]},{\"content\":\"personal\",\"polygon\":[0.076,0.3752,0.6084,0.3549,0.6134,0.4968,0.076,0.5019],\"spans\":[{\"offset\":50,\"length\":8}]},{\"content\":\"פלסאון בע״מ | מס׳ עוסק מורשה 512865254 | פטור מניכוי מס הכנסה במקור לפי אישור פקיד שומה חיפה\",\"polygon\":[5.5969,0.5678,9.9163,0.5628,9.9163,0.6895,5.5969,0.6946],\"spans\":[{\"offset\":59,\"length\":92}]},{\"content\":\"-\",\"polygon\":[3.3308,0.6388,3.5538,0.6337,3.5589,0.9379,3.3359,0.943],\"spans\":[{\"offset\":152,\"length\":1}]},{\"content\":\"PLASSON®\",\"polygon\":[1.1508,0.5628,2.1495,0.5628,2.1495,0.7351,1.1559,0.7503],\"spans\":[{\"offset\":154,\"length\":8}]},{\"content\":\"מעגן מיכאל, ד.נ. מנשה 3780500 | טלפון: 04-6394721, פקס: 04-6394816 | www.plasson.co.il | Yaels@plasson.co.il\",\"polygon\":[5.313,0.7098,9.9214,0.7098,9.9214,0.8315,5.313,0.8365],\"spans\":[{\"offset\":163,\"length\":108}]},{\"content\":\"עמוד 1 מתוך 1\",\"polygon\":[1.09,1.3435,1.9569,1.3435,1.9569,1.521,1.09,1.5159],\"spans\":[{\"offset\":272,\"length\":13}]},{\"content\":\"חשבונית מס מספר: 258001606\",\"polygon\":[4.4157,1.5818,6.7427,1.5919,6.7427,1.7795,4.4106,1.7643],\"spans\":[{\"offset\":286,\"length\":26}]},{\"content\":\"מקור\",\"polygon\":[3.2091,1.7238,3.5691,1.7238,3.5691,1.9012,3.204,1.9012],\"spans\":[{\"offset\":313,\"length\":4}]},{\"content\":\"מסמך ממוחשב\",\"polygon\":[0.9379,1.7136,2.0887,1.7187,2.0887,1.8911,0.9379,1.886],\"spans\":[{\"offset\":318,\"length\":11}]},{\"content\":\"לכבוד:\",\"polygon\":[9.4803,1.9418,9.9163,1.9418,9.9163,2.0939,9.4803,2.0989],\"spans\":[{\"offset\":330,\"length\":6}]},{\"content\":\"יעד למשלוח:\",\"polygon\":[6.3523,1.9316,7.1685,1.9316,7.1685,2.0989,6.3523,2.0989],\"spans\":[{\"offset\":337,\"length\":11}]},{\"content\":\"תאריך: 26/10/2025\",\"polygon\":[2.839,1.9266,4.1318,1.9367,4.1318,2.1091,2.839,2.0989],\"spans\":[{\"offset\":349,\"length\":17}]},{\"content\":\"ט.פ.י פל-ים בע״מ\",\"polygon\":[8.6387,2.1192,9.9112,2.1243,9.9112,2.3321,8.6387,2.3271],\"spans\":[{\"offset\":367,\"length\":16}]},{\"content\":\"ט.פ.י פל-ים בע״מ\",\"polygon\":[6.1495,2.1293,7.1685,2.1293,7.1685,2.2967,6.1495,2.2967],\"spans\":[{\"offset\":384,\"length\":16}]},{\"content\":\"מס׳ לקוח: 1340 ע.מ. לקוח: 513327064\",\"polygon\":[1.5767,2.1192,4.1318,2.1192,4.1318,2.3017,1.5767,2.3017],\"spans\":[{\"offset\":401,\"length\":35}]},{\"content\":\"הקטיף 11\",\"polygon\":[9.2978,2.3524,9.9214,2.3524,9.9163,2.5299,9.2978,2.5248],\"spans\":[{\"offset\":437,\"length\":8}]},{\"content\":\"הקטיף 11\",\"polygon\":[6.5906,2.3271,7.1787,2.3271,7.1736,2.4944,6.5906,2.4842],\"spans\":[{\"offset\":446,\"length\":8}]},{\"content\":\"מס׳ הזמנת לקוח: 2501005924\",\"polygon\":[2.3067,2.3169,4.1419,2.3169,4.1419,2.4944,2.3067,2.4893],\"spans\":[{\"offset\":455,\"length\":26}]},{\"content\":\"פארק תעשיות עמק חפר 3877701\",\"polygon\":[7.8479,2.5299,9.9112,2.5451,9.9062,2.7276,7.8479,2.7175],\"spans\":[{\"offset\":482,\"length\":27}]},{\"content\":\"פארק תעשיות עמק חפר 3877701\",\"polygon\":[5.1863,2.5045,7.1736,2.5147,7.1685,2.6921,5.1863,2.682],\"spans\":[{\"offset\":510,\"length\":27}]},{\"content\":\"מס׳ הזמנת פלסאון: 60000014\",\"polygon\":[2.3523,2.5096,4.1419,2.5096,4.1419,2.682,2.3523,2.6769],\"spans\":[{\"offset\":538,\"length\":26}]},{\"content\":\"מס׳ תעודת משלוח: 108367753\",\"polygon\":[2.2864,2.6972,4.1318,2.7022,4.1318,2.8695,2.2864,2.8645],\"spans\":[{\"offset\":565,\"length\":26}]},{\"content\":\"הערות:\",\"polygon\":[9.46,3.0064,9.9163,3.0064,9.9163,3.1433,9.46,3.1433],\"spans\":[{\"offset\":592,\"length\":6}]},{\"content\":\"מס׳\",\"polygon\":[9.6425,3.3106,9.8149,3.3106,9.8149,3.4171,9.6425,3.407],\"spans\":[{\"offset\":599,\"length\":3}]},{\"content\":\"מק״ט לקוח\",\"polygon\":[8.6793,3.3106,9.2116,3.3106,9.2167,3.4374,8.6793,3.4374],\"spans\":[{\"offset\":603,\"length\":9}]},{\"content\":\"מק״ט פלסאון\",\"polygon\":[7.4271,3.3157,8.0557,3.3106,8.0557,3.4323,7.4322,3.4374],\"spans\":[{\"offset\":613,\"length\":11}]},{\"content\":\"תיאור\",\"polygon\":[5.7997,3.3258,6.0684,3.3258,6.0684,3.4222,5.7997,3.4171],\"spans\":[{\"offset\":625,\"length\":5}]},{\"content\":\"יח׳\",\"polygon\":[4.4512,3.3157,4.5982,3.3157,4.5982,3.407,4.4563,3.3968],\"spans\":[{\"offset\":631,\"length\":3}]},{\"content\":\"כמות\",\"polygon\":[3.853,3.3309,4.0912,3.3258,4.0912,3.4222,3.853,3.4222],\"spans\":[{\"offset\":635,\"length\":4}]},{\"content\":\"מחיר\",\"polygon\":[3.2091,3.3309,3.4474,3.3309,3.4474,3.4222,3.2091,3.412],\"spans\":[{\"offset\":640,\"length\":4}]},{\"content\":\"סכום\",\"polygon\":[2.4791,3.336,2.7072,3.3309,2.7072,3.4171,2.4791,3.412],\"spans\":[{\"offset\":645,\"length\":4}]},{\"content\":\"אחוז\",\"polygon\":[1.8048,3.3309,2.0228,3.3258,2.0228,3.4272,1.8048,3.4171],\"spans\":[{\"offset\":650,\"length\":4}]},{\"content\":\"סכום\",\"polygon\":[1.0342,3.3309,1.2674,3.3309,1.2624,3.4222,1.0342,3.412],\"spans\":[{\"offset\":655,\"length\":4}]},{\"content\":\"מידה\",\"polygon\":[4.3954,3.4779,4.6438,3.4779,4.6438,3.5692,4.3954,3.5692],\"spans\":[{\"offset\":660,\"length\":4}]},{\"content\":\"יח׳\",\"polygon\":[3.2699,3.4577,3.4322,3.4627,3.4322,3.5641,3.2699,3.554],\"spans\":[{\"offset\":665,\"length\":3}]},{\"content\":\"ברוטו\",\"polygon\":[2.4689,3.4729,2.7376,3.4779,2.7326,3.5692,2.4639,3.559],\"spans\":[{\"offset\":669,\"length\":5}]},{\"content\":\"הנחה\",\"polygon\":[1.7845,3.4779,2.038,3.4729,2.0431,3.5692,1.7845,3.5692],\"spans\":[{\"offset\":675,\"length\":4}]},{\"content\":\"נטו\",\"polygon\":[1.0697,3.4729,1.2319,3.4729,1.237,3.5692,1.0697,3.5641],\"spans\":[{\"offset\":680,\"length\":3}]},{\"content\":\"ב- ש״ח\",\"polygon\":[3.1686,3.5996,3.5386,3.6097,3.5386,3.7111,3.1686,3.7061],\"spans\":[{\"offset\":684,\"length\":6}]},{\"content\":\"ב-ש״ח\",\"polygon\":[2.4284,3.6047,2.763,3.6047,2.763,3.701,2.4284,3.701],\"spans\":[{\"offset\":691,\"length\":5}]},{\"content\":\"ב-ש״ח\",\"polygon\":[0.9734,3.6097,1.313,3.6097,1.313,3.7111,0.9734,3.7111],\"spans\":[{\"offset\":697,\"length\":5}]},{\"content\":\"1\",\"polygon\":[9.8352,3.8835,9.9062,3.8734,9.9062,3.9798,9.8352,3.9798],\"spans\":[{\"offset\":703,\"length\":1}]},{\"content\":\"33007400\",\"polygon\":[7.8479,3.8683,8.3701,3.8734,8.3701,3.9951,7.8479,3.99],\"spans\":[{\"offset\":705,\"length\":8}]},{\"content\":\"מיכל קלסאון לבן מורכב\",\"polygon\":[5.962,3.8683,6.9911,3.8683,6.9911,4.0001,5.962,4.0001],\"spans\":[{\"offset\":714,\"length\":21}]},{\"content\":\"חי\",\"polygon\":[4.5931,3.8937,4.7047,3.8937,4.7047,3.9798,4.5982,3.9748],\"spans\":[{\"offset\":736,\"length\":2}]},{\"content\":\"112\",\"polygon\":[3.9898,3.8734,4.1876,3.8734,4.1876,3.9849,3.9898,3.9849],\"spans\":[{\"offset\":739,\"length\":3}]},{\"content\":\"105.00\",\"polygon\":[3.2801,3.8683,3.6299,3.8683,3.6299,3.99,3.2801,3.99],\"spans\":[{\"offset\":743,\"length\":6}]},{\"content\":\"11,760.00\",\"polygon\":[2.3929,3.8683,2.8999,3.8683,2.8999,3.9951,2.3929,3.9951],\"spans\":[{\"offset\":750,\"length\":9}]},{\"content\":\"0.00\",\"polygon\":[1.9265,3.8683,2.1749,3.8683,2.1749,3.99,1.9316,3.9849],\"spans\":[{\"offset\":760,\"length\":4}]},{\"content\":\"11,760.00\",\"polygon\":[1.0139,3.8683,1.526,3.8683,1.526,3.9951,1.0139,3.9951],\"spans\":[{\"offset\":765,\"length\":9}]},{\"content\":\"לפירעון עד: 28/02/2026\",\"polygon\":[8.6185,4.4818,9.9062,4.4818,9.9062,4.6288,8.6185,4.6288],\"spans\":[{\"offset\":775,\"length\":22}]},{\"content\":\"סה״כ ברוטו בש״ח:\",\"polygon\":[2.1293,4.4818,3.128,4.4919,3.128,4.6491,2.1293,4.644],\"spans\":[{\"offset\":798,\"length\":16}]},{\"content\":\"11,760.00\",\"polygon\":[1.1559,4.497,1.6578,4.497,1.6578,4.6339,1.1559,4.6339],\"spans\":[{\"offset\":815,\"length\":9}]},{\"content\":\"תנאי תשלום: שוטף + 120\",\"polygon\":[8.6185,4.6389,9.9214,4.644,9.9214,4.786,8.6185,4.786],\"spans\":[{\"offset\":825,\"length\":22}]},{\"content\":\"הקמת הזמנה: Moshe, Megi\",\"polygon\":[8.4157,4.8012,9.9214,4.8113,9.9214,4.9583,8.4157,4.9482],\"spans\":[{\"offset\":848,\"length\":23}]},{\"content\":\"סה״כ נטו:\",\"polygon\":[2.5805,4.6846,3.1229,4.6846,3.1229,4.8214,2.5805,4.8214],\"spans\":[{\"offset\":872,\"length\":9}]},{\"content\":\"11,760.00\",\"polygon\":[1.1508,4.6744,1.6527,4.6744,1.6527,4.8164,1.1508,4.8164],\"spans\":[{\"offset\":882,\"length\":9}]},{\"content\":\"הפקת חשבונית: Sharett, Yael\",\"polygon\":[8.3548,4.9583,9.9163,4.9634,9.9163,5.1104,8.3548,5.1054],\"spans\":[{\"offset\":892,\"length\":27}]},{\"content\":\"מע״מ 18%:\",\"polygon\":[2.4081,4.8671,3.128,4.8671,3.128,5.004,2.4081,5.004],\"spans\":[{\"offset\":920,\"length\":9}]},{\"content\":\"2,116.80\",\"polygon\":[1.1914,4.8671,1.6578,4.862,1.6578,4.9938,1.1914,4.9989],\"spans\":[{\"offset\":930,\"length\":8}]},{\"content\":\"פלסאון בע״מ\",\"polygon\":[9.2218,5.1256,9.9163,5.1206,9.9163,5.2676,9.2218,5.2727],\"spans\":[{\"offset\":939,\"length\":11}]},{\"content\":\"סה״כ לתשלום בש״ח:\",\"polygon\":[2.0228,5.0395,3.128,5.0395,3.128,5.1915,2.0228,5.1915],\"spans\":[{\"offset\":951,\"length\":17}]},{\"content\":\"13,876.80\",\"polygon\":[1.1457,5.0395,1.6527,5.0395,1.6527,5.1763,1.1457,5.1713],\"spans\":[{\"offset\":969,\"length\":9}]}],\"spans\":[{\"offset\":0,\"length\":978}]}],\"tables\":[{\"rowCount\":3,\"columnCount\":3,\"cells\":[{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":0,\"content\":\"תאריך: 26/10/2025\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7201,1.9073,4.2018,1.9168,4.2018,2.0982,0.7201,2.0982]}],\"spans\":[{\"offset\":349,\"length\":17}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":1,\"content\":\"יעד למשלוח:\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2018,1.9168,7.2339,1.9264,7.2339,2.1078,4.2018,2.0982]}],\"spans\":[{\"offset\":337,\"length\":11}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":2,\"content\":\"לכבוד:\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.2339,1.9264,9.9791,1.9264,9.9791,2.1078,7.2339,2.1078]}],\"spans\":[{\"offset\":330,\"length\":6}]},{\"rowIndex\":1,\"columnIndex\":0,\"content\":\"מס׳ לקוח: 1340 ע.מ. לקוח: 513327064\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7201,2.0982,4.2018,2.0982,4.2018,2.3083,0.7201,2.2892]}],\"spans\":[{\"offset\":401,\"length\":35}]},{\"rowIndex\":1,\"columnIndex\":1,\"content\":\"ט.פ.י פל-ים בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2018,2.0982,7.2339,2.1078,7.2339,2.3083,4.2018,2.3083]}],\"spans\":[{\"offset\":384,\"length\":16}]},{\"rowIndex\":1,\"columnIndex\":2,\"content\":\"ט.פ.י פל-ים בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.2339,2.1078,9.9791,2.1078,9.9791,2.3178,7.2339,2.3083]}],\"spans\":[{\"offset\":367,\"length\":16}]},{\"rowIndex\":2,\"columnIndex\":0,\"content\":\"מס׳ הזמנת לקוח: 2501005924\\nמס׳ הזמנת פלסאון: 60000014\\nמס׳ תעודת משלוח: 108367753\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7201,2.2892,4.2018,2.3083,4.2018,2.8716,0.7105,2.8716]}],\"spans\":[{\"offset\":455,\"length\":26},{\"offset\":538,\"length\":53}]},{\"rowIndex\":2,\"columnIndex\":1,\"content\":\"הקטיף 11\\nפארק תעשיות עמק חפר 3877701\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2018,2.3083,7.2339,2.3083,7.2339,2.8811,4.2018,2.8716]}],\"spans\":[{\"offset\":446,\"length\":8},{\"offset\":510,\"length\":27}]},{\"rowIndex\":2,\"columnIndex\":2,\"content\":\"הקטיף 11\\nפארק תעשיות עמק חפר 3877701\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.2339,2.3083,9.9791,2.3178,9.9886,2.8907,7.2339,2.8811]}],\"spans\":[{\"offset\":437,\"length\":8},{\"offset\":482,\"length\":27}]}],\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.6961,1.9165,10.0253,1.9175,10.0255,2.9025,0.6959,2.902]}],\"spans\":[{\"offset\":349,\"length\":17},{\"offset\":337,\"length\":11},{\"offset\":330,\"length\":6},{\"offset\":401,\"length\":35},{\"offset\":384,\"length\":16},{\"offset\":367,\"length\":16},{\"offset\":455,\"length\":26},{\"offset\":538,\"length\":53},{\"offset\":446,\"length\":8},{\"offset\":510,\"length\":27},{\"offset\":437,\"length\":8},{\"offset\":482,\"length\":27}]},{\"rowCount\":2,\"columnCount\":10,\"cells\":[{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":0,\"content\":\"סכום\\nנטו\\nב-ש״ח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7006,3.3049,1.5874,3.3049,1.5874,3.8493,0.7006,3.8493]}],\"spans\":[{\"offset\":655,\"length\":4},{\"offset\":680,\"length\":3},{\"offset\":697,\"length\":5}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":1,\"content\":\"אחוז\\nהנחה\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5874,3.3049,2.2739,3.3049,2.2739,3.8493,1.5874,3.8493]}],\"spans\":[{\"offset\":650,\"length\":4},{\"offset\":675,\"length\":4}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":2,\"content\":\"סכום\\nברוטו\\nב-ש״ח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.2739,3.3049,2.9509,3.3049,2.9604,3.8493,2.2739,3.8493]}],\"spans\":[{\"offset\":645,\"length\":4},{\"offset\":669,\"length\":5},{\"offset\":691,\"length\":5}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":3,\"content\":\"מחיר\\nיח׳\\nב- ש״ח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.9509,3.3049,3.6947,3.3049,3.6947,3.8493,2.9604,3.8493]}],\"spans\":[{\"offset\":640,\"length\":4},{\"offset\":665,\"length\":3},{\"offset\":684,\"length\":6}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":4,\"content\":\"כמות\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.6947,3.3049,4.2763,3.3049,4.2859,3.8493,3.6947,3.8493]}],\"spans\":[{\"offset\":635,\"length\":4}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":5,\"content\":\"יח׳\\nמידה\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2763,3.3049,4.7912,3.3049,4.7912,3.8493,4.2859,3.8493]}],\"spans\":[{\"offset\":631,\"length\":3},{\"offset\":660,\"length\":4}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":6,\"content\":\"תיאור\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.7912,3.3049,7.0416,3.3049,7.0511,3.8493,4.7912,3.8493]}],\"spans\":[{\"offset\":625,\"length\":5}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":7,\"content\":\"מק״ט פלסאון\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.0416,3.3049,8.51,3.3049,8.51,3.8493,7.0511,3.8493]}],\"spans\":[{\"offset\":613,\"length\":11}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":8,\"content\":\"מק״ט לקוח\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.51,3.3049,9.4636,3.3049,9.454,3.8493,8.51,3.8493]}],\"spans\":[{\"offset\":603,\"length\":9}]},{\"kind\":\"columnHeader\",\"rowIndex\":0,\"columnIndex\":9,\"content\":\"מס׳\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.4636,3.3049,9.9594,3.3049,9.9689,3.8493,9.454,3.8493]}],\"spans\":[{\"offset\":599,\"length\":3}]},{\"rowIndex\":1,\"columnIndex\":0,\"content\":\"11,760.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7006,3.8493,1.5874,3.8493,1.5874,4.0021,0.7006,4.0021]}],\"spans\":[{\"offset\":765,\"length\":9}]},{\"rowIndex\":1,\"columnIndex\":1,\"content\":\"0.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5874,3.8493,2.2739,3.8493,2.2739,4.0021,1.5874,4.0021]}],\"spans\":[{\"offset\":760,\"length\":4}]},{\"rowIndex\":1,\"columnIndex\":2,\"content\":\"11,760.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.2739,3.8493,2.9604,3.8493,2.9604,4.0021,2.2739,4.0021]}],\"spans\":[{\"offset\":750,\"length\":9}]},{\"rowIndex\":1,\"columnIndex\":3,\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.9604,3.8493,3.6947,3.8493,3.6947,4.0021,2.9604,4.0021]}],\"spans\":[{\"offset\":743,\"length\":6}]},{\"rowIndex\":1,\"columnIndex\":4,\"content\":\"112\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.6947,3.8493,4.2859,3.8493,4.2859,4.0021,3.6947,4.0021]}],\"spans\":[{\"offset\":739,\"length\":3}]},{\"rowIndex\":1,\"columnIndex\":5,\"content\":\"חי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.2859,3.8493,4.7912,3.8493,4.7912,4.0021,4.2859,4.0021]}],\"spans\":[{\"offset\":736,\"length\":2}]},{\"rowIndex\":1,\"columnIndex\":6,\"content\":\"מיכל קלסאון לבן מורכב\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.7912,3.8493,7.0511,3.8493,7.0607,4.0021,4.7912,4.0021]}],\"spans\":[{\"offset\":714,\"length\":21}]},{\"rowIndex\":1,\"columnIndex\":7,\"content\":\"33007400\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.0511,3.8493,8.51,3.8493,8.51,4.0021,7.0607,4.0021]}],\"spans\":[{\"offset\":705,\"length\":8}]},{\"rowIndex\":1,\"columnIndex\":8,\"content\":\"\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.51,3.8493,9.454,3.8493,9.454,4.0021,8.51,4.0021]}],\"spans\":[]},{\"rowIndex\":1,\"columnIndex\":9,\"content\":\"1\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.454,3.8493,9.9689,3.8493,9.9689,4.0021,9.454,4.0021]}],\"spans\":[{\"offset\":703,\"length\":1}]}],\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7078,3.2904,10.0047,3.2888,10.0059,4.0316,0.708,4.0339]}],\"spans\":[{\"offset\":655,\"length\":4},{\"offset\":680,\"length\":3},{\"offset\":697,\"length\":5},{\"offset\":650,\"length\":4},{\"offset\":675,\"length\":4},{\"offset\":645,\"length\":4},{\"offset\":669,\"length\":5},{\"offset\":691,\"length\":5},{\"offset\":640,\"length\":4},{\"offset\":665,\"length\":3},{\"offset\":684,\"length\":6},{\"offset\":635,\"length\":4},{\"offset\":631,\"length\":3},{\"offset\":660,\"length\":4},{\"offset\":625,\"length\":5},{\"offset\":613,\"length\":11},{\"offset\":603,\"length\":9},{\"offset\":599,\"length\":3},{\"offset\":765,\"length\":9},{\"offset\":760,\"length\":4},{\"offset\":750,\"length\":9},{\"offset\":743,\"length\":6},{\"offset\":739,\"length\":3},{\"offset\":736,\"length\":2},{\"offset\":714,\"length\":21},{\"offset\":705,\"length\":8},{\"offset\":703,\"length\":1}]},{\"rowCount\":4,\"columnCount\":2,\"cells\":[{\"rowIndex\":0,\"columnIndex\":0,\"content\":\"11,760.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.9176,4.4311,1.8454,4.4361,1.8454,4.6541,0.9125,4.6541]}],\"spans\":[{\"offset\":815,\"length\":9}]},{\"rowIndex\":0,\"columnIndex\":1,\"content\":\"סה״כ ברוטו בש״ח:\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.8454,4.4361,3.1838,4.4311,3.1838,4.6541,1.8454,4.6541]}],\"spans\":[{\"offset\":798,\"length\":16}]},{\"rowIndex\":1,\"columnIndex\":0,\"content\":\"11,760.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.9125,4.6541,1.8454,4.6541,1.8454,4.8367,0.9125,4.8367]}],\"spans\":[{\"offset\":882,\"length\":9}]},{\"rowIndex\":1,\"columnIndex\":1,\"content\":\"סה״כ נטו:\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.8454,4.6541,3.1838,4.6541,3.1838,4.8417,1.8454,4.8367]}],\"spans\":[{\"offset\":872,\"length\":9}]},{\"rowIndex\":2,\"columnIndex\":0,\"content\":\"2,116.80\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.9125,4.8367,1.8454,4.8367,1.8454,5.0242,0.9125,5.0242]}],\"spans\":[{\"offset\":930,\"length\":8}]},{\"rowIndex\":2,\"columnIndex\":1,\"content\":\"מע״מ 18%:\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.8454,4.8367,3.1838,4.8417,3.1838,5.0293,1.8454,5.0242]}],\"spans\":[{\"offset\":920,\"length\":9}]},{\"rowIndex\":3,\"columnIndex\":0,\"content\":\"13,876.80\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.9125,5.0242,1.8454,5.0242,1.8454,5.2068,0.9125,5.2068]}],\"spans\":[{\"offset\":969,\"length\":9}]},{\"rowIndex\":3,\"columnIndex\":1,\"content\":\"סה״כ לתשלום בש״ח:\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.8454,5.0242,3.1838,5.0293,3.1838,5.2118,1.8454,5.2068]}],\"spans\":[{\"offset\":951,\"length\":17}]}],\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0.7557,4.4149,3.1954,4.4149,3.1967,5.2399,0.7562,5.24]}],\"spans\":[{\"offset\":815,\"length\":9},{\"offset\":798,\"length\":16},{\"offset\":882,\"length\":9},{\"offset\":872,\"length\":9},{\"offset\":930,\"length\":8},{\"offset\":920,\"length\":9},{\"offset\":969,\"length\":9},{\"offset\":951,\"length\":17}]}],\"styles\":[{\"confidence\":0.2,\"spans\":[{\"offset\":152,\"length\":1}],\"isHandwritten\":true}],\"documents\":[{\"docType\":\"invoice\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[0,0,11.6806,0,11.6806,8.2639,0,8.2639]}],\"fields\":{\"BillingAddress\":{\"type\":\"address\",\"content\":\"הקטיף 11\\nפארק תעשיות עמק חפר 3877701\\nפארק תעשיות עמק חפר 3877701\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[5.1876,2.3175,9.9037,2.3498,9.901,2.7373,5.185,2.705]}],\"confidence\":0.355,\"spans\":[{\"offset\":446,\"length\":8},{\"offset\":482,\"length\":55}],\"valueAddress\":{\"houseNumber\":\"11\",\"road\":\"הקטיף\",\"streetAddress\":\"11 הקטיף\",\"house\":\"פארק תעשיות עמק חפר 3877701\\nפארק תעשיות עמק חפר 3877701\"}},\"BillingAddressRecipient\":{\"type\":\"string\",\"valueString\":\"ט.פ.י פל-ים בע״מ\",\"content\":\"ט.פ.י פל-ים בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[6.1597,2.1293,7.1685,2.1295,7.1685,2.3019,6.1597,2.3017]}],\"confidence\":0.544,\"spans\":[{\"offset\":384,\"length\":16}]},\"CustomerAddress\":{\"type\":\"address\",\"content\":\"הקטיף 11\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.2979,2.3482,9.9196,2.3601,9.9162,2.5416,9.2944,2.5297]}],\"confidence\":0.414,\"spans\":[{\"offset\":437,\"length\":8}],\"valueAddress\":{\"houseNumber\":\"11\",\"road\":\"הקטיף\",\"streetAddress\":\"11 הקטיף\"}},\"CustomerAddressRecipient\":{\"type\":\"string\",\"valueString\":\"ט.פ.י פל-ים בע״מ\",\"content\":\"ט.פ.י פל-ים בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.6641,2.1243,9.9112,2.1243,9.9112,2.3321,8.6641,2.3321]}],\"confidence\":0.539,\"spans\":[{\"offset\":367,\"length\":16}]},\"CustomerName\":{\"type\":\"string\",\"valueString\":\"ט.פ.י פל-ים בע״מ\",\"content\":\"ט.פ.י פל-ים בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.6641,2.1243,9.9112,2.1243,9.9112,2.3321,8.6641,2.3321]}],\"confidence\":0.539,\"spans\":[{\"offset\":367,\"length\":16}]},\"CustomerTaxId\":{\"type\":\"string\",\"valueString\":\"513327064\",\"content\":\"513327064\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.5868,2.1243,2.3168,2.1243,2.3168,2.3068,1.5817,2.3068]}],\"confidence\":0.821,\"spans\":[{\"offset\":427,\"length\":9}]},\"DueDate\":{\"type\":\"date\",\"valueDate\":\"2026-02-28\",\"content\":\"28/02/2026\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.6185,4.4818,9.242,4.4818,9.242,4.6339,8.6235,4.6288]}],\"confidence\":0.685,\"spans\":[{\"offset\":787,\"length\":10}]},\"InvoiceDate\":{\"type\":\"date\",\"valueDate\":\"2025-10-26\",\"content\":\"26/10/2025\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[2.8441,1.9316,3.6198,1.9367,3.6147,2.1091,2.839,2.1091]}],\"confidence\":0.96,\"spans\":[{\"offset\":356,\"length\":10}]},\"InvoiceId\":{\"type\":\"string\",\"valueString\":\"258001606\",\"content\":\"258001606\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.4208,1.5869,5.308,1.5869,5.3029,1.7745,4.4157,1.7694]}],\"confidence\":0.959,\"spans\":[{\"offset\":303,\"length\":9}]},\"InvoiceTotal\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":13876.8,\"currencyCode\":\"ILS\"},\"content\":\"13,876.80\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.1457,5.0496,1.6476,5.0395,1.6476,5.1814,1.1559,5.1763]}],\"confidence\":0.961,\"spans\":[{\"offset\":969,\"length\":9}]},\"Items\":{\"type\":\"array\",\"valueArray\":[{\"type\":\"object\",\"valueObject\":{\"Amount\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":11760,\"currencyCode\":\"ILS\"},\"content\":\"11,760.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.0139,3.8683,1.526,3.8734,1.531,4.0001,1.019,4.0001]}],\"confidence\":0.958,\"spans\":[{\"offset\":765,\"length\":9}]},\"Description\":{\"type\":\"string\",\"valueString\":\"מיכל קלסאון לבן מורכב\",\"content\":\"מיכל קלסאון לבן מורכב\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[5.9721,3.8683,6.9911,3.8683,6.9911,4.0052,5.9721,4.0052]}],\"confidence\":0.96,\"spans\":[{\"offset\":714,\"length\":21}]},\"ProductCode\":{\"type\":\"string\",\"valueString\":\"33007400\",\"content\":\"33007400\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[7.8529,3.8734,8.3701,3.8734,8.3701,4.0001,7.8529,3.99]}],\"confidence\":0.954,\"spans\":[{\"offset\":705,\"length\":8}]},\"Quantity\":{\"type\":\"number\",\"valueNumber\":112,\"content\":\"112\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.9898,3.8734,4.1774,3.8734,4.1774,3.9849,3.9898,3.9849]}],\"confidence\":0.957,\"spans\":[{\"offset\":739,\"length\":3}]},\"Unit\":{\"type\":\"string\",\"valueString\":\"חי\",\"content\":\"חי\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[4.5931,3.8937,4.6996,3.8937,4.6945,3.9798,4.5931,3.9748]}],\"confidence\":0.508,\"spans\":[{\"offset\":736,\"length\":2}]},\"UnitPrice\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":105,\"currencyCode\":\"ILS\"},\"content\":\"105.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[3.2801,3.8785,3.6248,3.8734,3.6299,3.9951,3.2801,3.99]}],\"confidence\":0.953,\"spans\":[{\"offset\":743,\"length\":6}]}},\"content\":\"1\\n33007400\\nמיכל קלסאון לבן מורכב\\nחי\\n112\\n105.00\\n11,760.00\\n0.00\\n11,760.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.0139,3.8683,9.9112,3.8683,9.9112,4.0052,1.0139,4.0052]}],\"confidence\":0.877,\"spans\":[{\"offset\":703,\"length\":71}]}]},\"PaymentTerm\":{\"type\":\"string\",\"valueString\":\"שוטף + 120\",\"content\":\"שוטף + 120\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.6185,4.644,9.2015,4.644,9.2015,4.791,8.6185,4.791]}],\"confidence\":0.82,\"spans\":[{\"offset\":837,\"length\":10}]},\"SubTotal\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":11760,\"currencyCode\":\"ILS\"},\"content\":\"11,760.00\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.161,4.502,1.6527,4.497,1.6527,4.6389,1.161,4.6339]}],\"confidence\":0.934,\"spans\":[{\"offset\":815,\"length\":9}]},\"TotalTax\":{\"type\":\"currency\",\"valueCurrency\":{\"amount\":2116.8,\"currencyCode\":\"ILS\"},\"content\":\"2,116.80\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.1964,4.8721,1.6527,4.862,1.6527,4.9989,1.1964,4.9989]}],\"confidence\":0.964,\"spans\":[{\"offset\":930,\"length\":8}]},\"VendorAddress\":{\"type\":\"address\",\"content\":\"מעגן מיכאל, ד.נ.\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.2218,0.7098,9.9214,0.7098,9.9214,0.8365,9.2218,0.8365]}],\"confidence\":0.414,\"spans\":[{\"offset\":163,\"length\":16}],\"valueAddress\":{\"streetAddress\":\"\",\"house\":\"מעגן מיכאל, ד.נ.\"}},\"VendorAddressRecipient\":{\"type\":\"string\",\"valueString\":\"פלסאון בע״מ\",\"content\":\"פלסאון בע״מ\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[9.3586,0.5678,9.9163,0.5678,9.9163,0.6946,9.3586,0.6946]}],\"confidence\":0.538,\"spans\":[{\"offset\":59,\"length\":11}]},\"VendorName\":{\"type\":\"string\",\"valueString\":\"PLASSON®\",\"content\":\"PLASSON®\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[1.1559,0.5678,2.1495,0.5628,2.1546,0.7149,1.1559,0.7453]}],\"confidence\":0.938,\"spans\":[{\"offset\":154,\"length\":8}]},\"VendorTaxId\":{\"type\":\"string\",\"valueString\":\"512865254\",\"content\":\"512865254\",\"boundingRegions\":[{\"pageNumber\":1,\"polygon\":[8.0456,0.5678,8.5069,0.5678,8.5069,0.6946,8.0456,0.6946]}],\"confidence\":0.462,\"spans\":[{\"offset\":88,\"length\":9}]}},\"confidence\":1,\"spans\":[{\"offset\":0,\"length\":978}]}]}}"
            }
        ],
        "language": "javascript",
        "inputFormat": "editor",
        "dependencies": [],
        "codeEditorJavascript": "// ============================================================================\n// קוד 2 - עיבוד חשבוניות (גרסה 4.2 - תיקון מחיר)\n// מקבל: OCR + הגדרות + תעודות + יבוא\n// מחזיר: JSON לפריוריטי + דוח ביצוע\n//\n// ✨ חדש בגרסה 4.2:\n// - תיקון חישוב מחיר: InvoiceTotal - TotalTax = סה\"כ לפני מע\"מ (עבודות + חלקים)\n//\n// ✨ חדש בגרסה 4.1:\n// - פונקציית cleanInvoiceForPriority() - מנקה שדות למידה לפני שליחה\n// - זיהוי רכבים משופר - מונע זיהוי כרטיס כרכב\n//\n// ✨ חדש בגרסה 4.0:\n// - חילוץ רכבים מתקדם לפי vehicle_processing_rules.search_locations\n// - תמיכה ב-VehicleNumbers (שדה חדש מ-Azure v3.0)\n// - תמיכה ב-Items[].VehicleNumber (קישור ישיר)\n// - יצירת פריטי רכבים אוטומטית\n// - מיפוי לחשבונות לפי vehicle_account_mapping\n//\n// ✨ מגרסה 3.0:\n// - תמיכה במבנה החדש של UnidentifiedNumbers (מערך אובייקטים)\n// - ניצול התוויות (label) וההקשר (context) לזיהוי חכם יותר\n// ============================================================================\n\n// ============================================================================\n// פונקציית עזר - ניקוי invoice לפני שליחה ל-Priority\n// ============================================================================\n\nfunction cleanInvoiceForPriority(invoice) {\n    // יצירת עותק עמוק כדי לא לשנות את המקור\n    const cleaned = JSON.parse(JSON.stringify(invoice));\n\n    // ניקוי שדות שלא צריכים מהפריטים\n    if (cleaned.PINVOICEITEMS_SUBFORM) {\n        cleaned.PINVOICEITEMS_SUBFORM = cleaned.PINVOICEITEMS_SUBFORM.map(item => {\n            // מחיקת שדות למידה\n            delete item.isNewVehicle;\n            delete item._learningNote;\n\n            // מחיקת SPECIALVATFLAG אם זה לא \"Y\"\n            if (item.SPECIALVATFLAG && item.SPECIALVATFLAG !== \"Y\") {\n                delete item.SPECIALVATFLAG;\n            }\n\n            return item;\n        });\n    }\n\n    return cleaned;\n}\n\n// ============================================================================\n// פונקציה ראשית\n// ============================================================================\n\nfunction processInvoiceComplete(input) {\n    const executionReport = {\n        stage: \"\",\n        found: [],\n        not_found: [],\n        warnings: [],\n        errors: []\n    };\n\n    try {\n        // ============================================================================\n        // שלב 1: זיהוי סוג חשבונית ותבנית\n        // ============================================================================\n\n        executionReport.stage = \"שלב 1: זיהוי סוג ותבנית\";\n\n        // א. בדיקת יבוא\n        const hasImport = checkImportExists(input.import_files);\n\n        // ב. בדיקת תעודות - ב-OCR!\n        const hasDocs = checkDocsInOCR(\n            input.AZURE_RESULT.data.fields,\n            input.AZURE_TEXT\n        );\n\n        // ג. זיהוי חיוב/זיכוי\n        const debitType = identifyDebitType(input.AZURE_RESULT.data.fields);\n\n        executionReport.found.push(`סוג: יבוא=${hasImport}, תעודות=${hasDocs}, חיוב/זיכוי=${debitType}`);\n\n        // ד. חיפוש תבנית מתאימה\n        const config = input.learned_config.config;\n        const templateIndex = findMatchingTemplate(config.structure, hasImport, hasDocs, debitType);\n\n        if (templateIndex === -1) {\n            executionReport.errors.push(\"לא נמצאה תבנית מתאימה!\");\n            throw new Error(\"לא נמצאה תבנית מתאימה\");\n        }\n\n        const structure = config.structure[templateIndex];\n        const template = input.learned_config.template.PINVOICES[templateIndex];\n\n        executionReport.found.push(`תבנית: index=${templateIndex}`);\n\n        // ============================================================================\n        // שלב 2: הכנה - הבנת דפוסים\n        // ============================================================================\n\n        executionReport.stage = \"שלב 2: הבנת דפוסים\";\n\n        const patterns = extractPatterns(\n            input.learned_config.recommended_samples,\n            input.docs_list\n        );\n\n        executionReport.found.push(`דפוסים: BOOKNUM=${JSON.stringify(patterns.booknum_pattern)}, תעודות=${JSON.stringify(patterns.docs_pattern)}`);\n\n        // ✨ חדש! קריאת חוקי רכבים\n        const vehicleRules = config.rules?.critical_patterns?.vehicle_rules || null;\n        if (vehicleRules && vehicleRules.enabled) {\n            executionReport.found.push(`חוקי רכבים: פעילים (${Object.keys(vehicleRules.vehicle_account_mapping || {}).length} רכבים ממופים)`);\n        }\n\n        // ============================================================================\n        // שלב 3: חיפוש וזיהוי נתונים\n        // ============================================================================\n\n        executionReport.stage = \"שלב 3: חיפוש נתונים\";\n\n        const ocrFields = input.AZURE_RESULT.data.fields;\n        const searchResults = searchAllData(\n            ocrFields,\n            input.AZURE_TEXT,\n            patterns,\n            structure,\n            input.import_files,\n            input.docs_list,\n            vehicleRules  // ✨ חדש!\n        );\n\n        // תיעוד מה נמצא\n        Object.keys(searchResults).forEach(key => {\n            if (key === 'documents' && searchResults.documents) {\n                if (searchResults.documents.length > 0) {\n                    const docsInfo = searchResults.documents.map(d =>\n                        `${d.BOOKNUM} (DOCNO: ${d.DOCNO || 'ריק'})`\n                    ).join(', ');\n                    executionReport.found.push(`תעודות: ${searchResults.documents.length} - ${docsInfo}`);\n                } else {\n                    executionReport.not_found.push('תעודות');\n                }\n            } else if (key === 'vehicles' && searchResults.vehicles) {\n                if (searchResults.vehicles.length > 0) {\n                    executionReport.found.push(`רכבים: ${searchResults.vehicles.length} - ${searchResults.vehicles.join(', ')}`);\n                } else {\n                    executionReport.not_found.push('רכבים');\n                }\n            } else if (searchResults[key]) {\n                executionReport.found.push(`${key}: ${JSON.stringify(searchResults[key]).substring(0, 50)}`);\n            } else {\n                executionReport.not_found.push(key);\n            }\n        });\n\n        // ✨ חדש! טיפול בשגיאות לתעודות חסרות\n        if (structure.has_doc) {\n            const foundDocsCount = searchResults.documents ? searchResults.documents.length : 0;\n            const ocrUnidentified = ocrFields.UnidentifiedNumbers || [];\n\n            // ספור כמה BOOKNUM נמצאו ב-OCR\n            const booknumPattern = /^108\\d{6}$/;\n            let expectedDocsCount = 0;\n\n            if (typeof ocrUnidentified[0] === 'object' && ocrUnidentified[0].value) {\n                expectedDocsCount = ocrUnidentified.filter(item =>\n                    booknumPattern.test(item.value)\n                ).length;\n            } else {\n                expectedDocsCount = ocrUnidentified.filter(num =>\n                    booknumPattern.test(num)\n                ).length;\n            }\n\n            // טיפול בשגיאות\n            if (foundDocsCount === 0) {\n                // אף תעודה לא נמצאה\n                if (expectedDocsCount > 0) {\n                    executionReport.errors.push(\n                        `תבנית דורשת תעודות. נמצאו ${expectedDocsCount} BOOKNUM ב-OCR אך לא נמצאה התאמה ב-docs_list`\n                    );\n                } else {\n                    executionReport.errors.push(\n                        'תבנית דורשת תעודות אך לא נמצאו BOOKNUM ב-OCR'\n                    );\n                }\n            } else if (expectedDocsCount > 0 && foundDocsCount < expectedDocsCount) {\n                // נמצאו תעודות חלקיות\n                executionReport.warnings.push(\n                    `נמצאו רק ${foundDocsCount} מתוך ${expectedDocsCount} תעודות מה-OCR. חסרות ${expectedDocsCount - foundDocsCount} תעודות`\n                );\n            }\n        }\n\n        // ============================================================================\n        // שלב 4: בניית JSON\n        // ============================================================================\n\n        executionReport.stage = \"שלב 4: בניית חשבונית\";\n\n        const invoice = buildInvoiceFromTemplate(\n            template,\n            structure,\n            config,\n            searchResults,\n            input.learned_config,\n            ocrFields  // ✨ חדש! מעביר גם את ocrFields\n        );\n\n        // ============================================================================\n        // שלב 5: בקרות\n        // ============================================================================\n\n        executionReport.stage = \"שלב 5: בקרות\";\n\n        const validation = performValidation(\n            invoice,\n            ocrFields,\n            config,\n            input.docs_list,\n            patterns\n        );\n\n        // ============================================================================\n        // שלב 6: ניתוח למידה\n        // ============================================================================\n\n        executionReport.stage = \"שלב 6: ניתוח למידה\";\n\n        const learningAnalysis = analyzeLearning(invoice, config);\n\n        // ============================================================================\n        // שלב 7: ניקוי והחזרת תוצאה\n        // ============================================================================\n\n        // ניקוי שדות שלא צריכים (למידה בלבד, לא ל-Priority)\n        const cleanedInvoice = cleanInvoiceForPriority(invoice);\n\n        // ============================================================================\n        // שלב 8: יצירת 2 פלטים נוספים\n        // ============================================================================\n\n        // פלט 1: הנחיות ל-LLM (פרומפט בשפה טבעית)\n        const llmPrompt = generateLLMPrompt(config, ocrFields, searchResults, executionReport);\n\n        // פלט 2: קונפיג טכני למערכת\n        const technicalConfig = generateTechnicalConfig(config, ocrFields, searchResults, executionReport);\n\n        // פלט 3: סצנריו עיבוד - מה MAKE צריך לשלוף מהמערכת\n        const hasVehicles = vehicleRules &&\n                           vehicleRules.vehicle_account_mapping &&\n                           Object.keys(vehicleRules.vehicle_account_mapping).length > 0;\n\n        const processingScenario = {\n            check_docs: structure.has_doc || false,\n            check_import: structure.has_import || false,\n            check_vehicles: hasVehicles || false\n        };\n\n        return {\n            status: \"success\",\n\n            // 1. JSON לפריוריטי (הפלט העיקרי)\n            invoice_data: {\n                PINVOICES: [cleanedInvoice]\n            },\n\n            // 2. הנחיות ל-LLM (פרומפט בשפה טבעית)\n            llm_prompt: llmPrompt,\n\n            // 3. קונפיג טכני למערכת\n            technical_config: technicalConfig,\n\n            // 4. סצנריו עיבוד - מה צריך לשלוף מהמערכת\n            processing_scenario: processingScenario\n        };\n\n    } catch (error) {\n        return {\n            status: \"error\",\n            error_type: error.name || \"ProcessingError\",\n            message: error.message\n        };\n    }\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 1\n// ============================================================================\n\nfunction checkImportExists(importFiles) {\n    if (!importFiles || !importFiles.IMPFILES) return false;\n    if (importFiles.IMPFILES.length === 0) return false;\n\n    try {\n        const parsed = JSON.parse('[' + importFiles.IMPFILES[0] + ']');\n        return parsed.length > 0 && parsed[0].IMPFNUM;\n    } catch (e) {\n        return false;\n    }\n}\n\nfunction checkDocsExist(docsList) {\n    if (!docsList || docsList.DOC_YES_NO !== \"Y\") return false;\n    return docsList.list_of_docs && docsList.list_of_docs.length > 0;\n}\n\nfunction checkDocsInOCR(ocrFields, azureText) {\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n    const docPattern = /^25\\d{6}$/;\n\n    let foundInUnidentified = false;\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            foundInUnidentified = unidentified.some(item =>\n                docPattern.test(item.value)\n            );\n        } else {\n            foundInUnidentified = unidentified.some(num =>\n                docPattern.test(num)\n            );\n        }\n    }\n\n    if (foundInUnidentified) return true;\n\n    if (azureText) {\n        const matches = azureText.match(/25\\d{6}/g);\n        if (matches && matches.length > 0) return true;\n    }\n\n    return false;\n}\n\nfunction identifyDebitType(ocrFields) {\n    const total = ocrFields.InvoiceTotal || ocrFields.InvoiceTotal_amount || 0;\n    return total >= 0 ? \"D\" : \"C\";\n}\n\nfunction findMatchingTemplate(structures, hasImport, hasDocs, debitType) {\n    return structures.findIndex(s =>\n        s.has_import === hasImport &&\n        s.has_doc === hasDocs &&\n        s.debit_type === debitType\n    );\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 2\n// ============================================================================\n\nfunction extractPatterns(recommendedSamples, docsList) {\n    const patterns = {\n        booknum_pattern: null,\n        ivnum_pattern: null,\n        docs_pattern: null,\n        docs_totquant: {}\n    };\n\n    if (recommendedSamples && recommendedSamples.samples && recommendedSamples.samples.length > 0) {\n        const sample = recommendedSamples.samples[0];\n\n        if (sample.sample_booknum) {\n            patterns.booknum_pattern = {\n                length: sample.sample_booknum.length,\n                example: sample.sample_booknum\n            };\n        }\n\n        if (sample.sample_ivnum) {\n            patterns.ivnum_pattern = {\n                length: sample.sample_ivnum.length,\n                example: sample.sample_ivnum\n            };\n        }\n    }\n\n    if (docsList && docsList.list_of_docs && docsList.list_of_docs.length > 0) {\n        try {\n            const docs = docsList.list_of_docs.map(d => JSON.parse(d));\n\n            if (docs.length > 0) {\n                const firstDoc = docs[0];\n                patterns.docs_pattern = {\n                    booknum_example: firstDoc.BOOKNUM,\n                    docno_example: firstDoc.DOCNO\n                };\n\n                docs.forEach(doc => {\n                    if (doc.TOTQUANT) {\n                        patterns.docs_totquant[doc.BOOKNUM] = doc.TOTQUANT;\n                    }\n                });\n            }\n        } catch (e) {\n            // שגיאה בפרסור\n        }\n    }\n\n    return patterns;\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 3\n// ============================================================================\n\nfunction searchAllData(ocrFields, azureText, patterns, structure, importFiles, docsList, vehicleRules) {\n    return {\n        booknum: searchBooknum(ocrFields, patterns),\n        ivdate: searchIvdate(ocrFields),\n        details: searchDetails(ocrFields, azureText),\n        ordname: structure.has_purchase_orders || structure.has_import ? searchOrdname(ocrFields) : null,\n        impfnum: structure.has_import ? searchImpfnum(ocrFields, importFiles) : null,\n        documents: structure.has_doc ? searchDocuments(ocrFields, azureText, patterns, docsList) : null,\n        vehicles: vehicleRules ? extractVehiclesAdvanced(ocrFields, vehicleRules) : [],  // ✨ חדש!\n        items: ocrFields.Items || []\n    };\n}\n\nfunction searchBooknum(ocrFields, patterns) {\n    let booknum = ocrFields.InvoiceId || \"\";\n\n    booknum = String(booknum).replace(/^SI/i, '');\n\n    if (patterns.booknum_pattern) {\n        const expectedLength = patterns.booknum_pattern.length;\n        if (booknum.length > expectedLength) {\n            booknum = booknum.slice(-expectedLength);\n        }\n    }\n\n    return booknum;\n}\n\nfunction searchIvdate(ocrFields) {\n    const isoDate = ocrFields.InvoiceDate;\n    if (!isoDate) return \"\";\n\n    const date = new Date(isoDate);\n    const day = String(date.getDate()).padStart(2, '0');\n    const month = String(date.getMonth() + 1).padStart(2, '0');\n    const year = String(date.getFullYear()).slice(-2);\n\n    return `${day}/${month}/${year}`;\n}\n\nfunction searchDetails(ocrFields, azureText) {\n    if (ocrFields.InvoiceDescription) {\n        return ocrFields.InvoiceDescription;\n    }\n\n    if (azureText) {\n        const lines = azureText.split('\\n').filter(l => l.trim());\n        if (lines.length > 2) {\n            return lines[2].substring(0, 100);\n        }\n    }\n\n    return \"\";\n}\n\nfunction searchOrdname(ocrFields) {\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n    const ordPattern = /^\\d{10}$/;\n    let found = \"\";\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            const orderItem = unidentified.find(item =>\n                item.label && (\n                    item.label.includes('הזמנה') ||\n                    item.label.toLowerCase().includes('order') ||\n                    item.label.toLowerCase().includes('po')\n                ) && ordPattern.test(item.value)\n            );\n\n            if (orderItem) {\n                found = orderItem.value;\n            } else {\n                const anyOrder = unidentified.find(item =>\n                    ordPattern.test(item.value)\n                );\n                found = anyOrder ? anyOrder.value : \"\";\n            }\n        } else {\n            const match = unidentified.find(num => ordPattern.test(num));\n            found = match || \"\";\n        }\n    }\n\n    return found;\n}\n\nfunction searchImpfnum(ocrFields, importFiles) {\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n    const impPattern = /^\\d{2}c\\d{5}$/;\n    let foundInOCR = \"\";\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            const importItem = unidentified.find(item =>\n                item.label && (\n                    item.label.includes('יבוא') ||\n                    item.label.toLowerCase().includes('import') ||\n                    item.label.includes('IMPFNUM')\n                ) && impPattern.test(item.value)\n            );\n\n            if (importItem) {\n                foundInOCR = importItem.value;\n            } else {\n                const anyImport = unidentified.find(item =>\n                    impPattern.test(item.value)\n                );\n                foundInOCR = anyImport ? anyImport.value : \"\";\n            }\n        } else {\n            const match = unidentified.find(num => impPattern.test(num));\n            foundInOCR = match || \"\";\n        }\n    }\n\n    if (foundInOCR) return foundInOCR;\n\n    if (importFiles && importFiles.IMPFILES && importFiles.IMPFILES.length > 0) {\n        try {\n            const parsed = JSON.parse('[' + importFiles.IMPFILES[0] + ']');\n            if (parsed.length > 0 && parsed[0].IMPFNUM) {\n                return parsed[0].IMPFNUM;\n            }\n        } catch (e) {\n            // ממשיכים בלי\n        }\n    }\n\n    return \"\";\n}\n\nfunction searchDocuments(ocrFields, azureText, patterns, docsList) {\n    const foundDocs = [];\n\n    if (!docsList || !docsList.list_of_docs || docsList.list_of_docs.length === 0) {\n        return foundDocs;\n    }\n\n    let availableDocs = [];\n    try {\n        // תיקון: flatMap כדי לשטח מערכים מקוננים\n        availableDocs = docsList.list_of_docs.flatMap(d => JSON.parse(d));\n    } catch (e) {\n        return foundDocs;\n    }\n\n    const unidentified = ocrFields.UnidentifiedNumbers || [];\n\n    if (unidentified.length > 0) {\n        if (typeof unidentified[0] === 'object' && unidentified[0].value) {\n            for (const item of unidentified) {\n                const match = availableDocs.find(doc => doc.BOOKNUM === item.value);\n\n                if (match) {\n                    foundDocs.push({\n                        DOCNO: match.DOCNO,\n                        BOOKNUM: match.BOOKNUM,\n                        TOTQUANT: match.TOTQUANT || null\n                    });\n                }\n            }\n        } else {\n            for (const num of unidentified) {\n                const match = availableDocs.find(doc => doc.BOOKNUM === num);\n\n                if (match) {\n                    foundDocs.push({\n                        DOCNO: match.DOCNO,\n                        BOOKNUM: match.BOOKNUM,\n                        TOTQUANT: match.TOTQUANT || null\n                    });\n                }\n            }\n        }\n    }\n\n    // Fallback: אם לא נמצא ב-UnidentifiedNumbers, חפש ב-AZURE_TEXT\n    if (foundDocs.length === 0 && azureText) {\n        for (const doc of availableDocs) {\n            // שיפור: חיפוש עם regex במקום includes (מדויק יותר)\n            // תבנית: גבול מילה + BOOKNUM + גבול מילה (כדי למנוע התאמה חלקית)\n            const pattern = new RegExp('\\\\b' + doc.BOOKNUM + '\\\\b');\n            if (pattern.test(azureText)) {\n                foundDocs.push({\n                    DOCNO: doc.DOCNO,\n                    BOOKNUM: doc.BOOKNUM,\n                    TOTQUANT: doc.TOTQUANT || null\n                });\n            }\n        }\n    }\n\n    return foundDocs;\n}\n\n// ============================================================================\n// ✨ חדש! פונקציות חילוץ רכבים מתקדם\n// ============================================================================\n\nfunction extractVehiclesAdvanced(ocrFields, vehicleRules) {\n    // תיקון: בדוק אם יש vehicle_account_mapping במקום enabled\n    if (!vehicleRules || !vehicleRules.vehicle_account_mapping) return [];\n\n    const foundVehicles = [];\n    // תיקון: אם אין search_locations, השתמש בברירת מחדל\n    const searchLocations = vehicleRules.search_locations || [\n        {\n            location: \"fields.UnidentifiedNumbers\",\n            priority: 1,\n            filter_by_label: \"רכב\",\n            description: \"חיפוש רכבים ב-UnidentifiedNumbers עם תווית רכב\"\n        }\n    ];\n\n    // סדר לפי עדיפות\n    const sortedLocations = [...searchLocations].sort((a, b) => a.priority - b.priority);\n\n    for (const location of sortedLocations) {\n        if (location.location === \"fields.VehicleNumbers\") {\n            // 1. רשימה מוכנה מאז'ור\n            if (ocrFields.VehicleNumbers && Array.isArray(ocrFields.VehicleNumbers)) {\n                ocrFields.VehicleNumbers.forEach(vNum => {\n                    if (!foundVehicles.includes(vNum)) {\n                        foundVehicles.push(vNum);\n                    }\n                });\n            }\n        }\n        else if (location.location === \"fields.Items[].VehicleNumber\") {\n            // 2. קישור ישיר בפריט\n            if (ocrFields.Items && Array.isArray(ocrFields.Items)) {\n                ocrFields.Items.forEach(item => {\n                    if (item.VehicleNumber && !foundVehicles.includes(item.VehicleNumber)) {\n                        foundVehicles.push(item.VehicleNumber);\n                    }\n                });\n            }\n        }\n        else if (location.location === \"fields.Items[].Description\" && location.pattern) {\n            // 3. חיפוש בתיאור לפי דפוס\n            if (ocrFields.Items && Array.isArray(ocrFields.Items)) {\n                const pattern = new RegExp(location.pattern);\n                ocrFields.Items.forEach(item => {\n                    if (item.Description) {\n                        const match = item.Description.match(pattern);\n                        if (match && match[0] && !foundVehicles.includes(match[0])) {\n                            foundVehicles.push(match[0]);\n                        }\n                    }\n                });\n            }\n        }\n        else if (location.location === \"fields.UnidentifiedNumbers\") {\n            // 4. מספרים לא מזוהים\n            const unidentified = ocrFields.UnidentifiedNumbers || [];\n            const vehiclePattern = /\\d{3}-\\d{2}-\\d{3}/;\n\n            unidentified.forEach(item => {\n                const value = typeof item === 'object' ? item.value : item;\n                const label = typeof item === 'object' ? (item.label || '') : '';\n                const context = typeof item === 'object' ? (item.context || '') : '';\n\n                // תיקון: גם אם יש תווית \"רכב\", חייב להתאים לדפוס מספר רכב!\n                // זה מונע טעויות של Azure OCR שמסמן מספר כרטיס בתור \"מספר רכב\"\n                const isValidVehicleNumber = vehiclePattern.test(value);\n\n                // בדיקה נוספת: אם בהקשר כתוב \"כרטיס\", זה לא רכב\n                const looksLikeCardNumber = context.includes('כרטיס') || label.includes('כרטיס');\n\n                // אם יש filter_by_label - רק עם התווית הזו וגם דפוס תקין\n                if (location.filter_by_label) {\n                    if (label && label.includes(location.filter_by_label)) {\n                        // תיקון: גם עם תווית רכב, חייב דפוס תקין ולא להיות מסומן ככרטיס\n                        if (isValidVehicleNumber && !looksLikeCardNumber && !foundVehicles.includes(value)) {\n                            foundVehicles.push(value);\n                        }\n                    }\n                } else {\n                    // אחרת - לפי דפוס רכב בלבד\n                    if (isValidVehicleNumber && !looksLikeCardNumber && !foundVehicles.includes(value)) {\n                        foundVehicles.push(value);\n                    }\n                }\n            });\n        }\n    }\n\n    return [...new Set(foundVehicles)]; // ייחודיים בלבד\n}\n\nfunction createVehicleItems(vehicles, ocrItems, vehicleRules, ocrFields) {\n    if (!vehicles || vehicles.length === 0) return [];\n\n    const vehicleItems = [];\n\n    // תיקון: מחיר = סכום כל החשבונית (לפני מע\"מ)\n    // חישוב: InvoiceTotal - TotalTax = סה\"כ לפני מע\"מ (עבודות + חלקים)\n    const totalPrice = ocrFields.TotalTax_amount\n        ? (ocrFields.InvoiceTotal_amount || 0) - ocrFields.TotalTax_amount\n        : (ocrFields.SubTotal_amount || ocrFields.InvoiceTotal_amount || 0);\n    const pricePerVehicle = vehicles.length > 0 ? totalPrice / vehicles.length : totalPrice;\n\n    vehicles.forEach(vehicleNum => {\n        // חיפוש מיפוי בחוקים\n        const mapping = vehicleRules.vehicle_account_mapping?.[vehicleNum];\n\n        // חיפוש תיאור מהפריטים של OCR\n        const relatedItem = ocrItems.find(item =>\n            (item.VehicleNumber && item.VehicleNumber === vehicleNum) ||\n            (item.Description && item.Description.includes(vehicleNum))\n        );\n\n        // תיקון: תיאור קצר בלבד\n        const shortDesc = extractShortDescription(ocrFields, vehicleNum);\n\n        // בניית פריט - רק שדות שPriority מכיר!\n        const item = {\n            PARTNAME: vehicleRules.output_format?.partname || \"car\",\n            PDES: shortDesc,\n            TQUANT: relatedItem?.Quantity || 1,\n            TUNITNAME: relatedItem?.Unit || \"יח'\",\n            PRICE: pricePerVehicle,\n            VATFLAG: mapping?.vat_pattern?.VATFLAG || \"Y\",\n            ACCNAME: mapping?.accname || vehicleRules.default_values?.accname || \"\"\n        };\n\n        // BUDCODE - חובה לפי התבנית!\n        if (mapping?.budcode) {\n            item.BUDCODE = mapping.budcode;\n        } else if (vehicleRules.default_values?.budcode) {\n            item.BUDCODE = vehicleRules.default_values.budcode;\n        }\n\n        // SPECIALVATFLAG - רק אם זה Y (לא שדות אחרים!)\n        if (mapping?.vat_pattern?.SPECIALVATFLAG === \"Y\") {\n            item.SPECIALVATFLAG = \"Y\";\n        }\n\n        // שמור מידע למידה בנפרד (לא נשלח ל-Priority!)\n        if (!mapping) {\n            // רק לצרכי דיווח ולמידה - לא ישלח ב-JSON הסופי\n            item._learningNote = \"רכב חדש - נדרש מיפוי\";\n        }\n\n        vehicleItems.push(item);\n    });\n\n    return vehicleItems;\n}\n\n// ============================================================================\n// פונקציית עזר - חילוץ תיאור קצר\n// ============================================================================\n\nfunction extractShortDescription(ocrFields, vehicleNum) {\n    // חיפוש תיאור קצר מהפריטים\n    if (ocrFields.Items && ocrFields.Items.length > 0) {\n        // חפש פריט שמכיל תיאור רלוונטי\n        const item = ocrFields.Items.find(i =>\n            i.Description && (\n                i.Description.includes(vehicleNum) ||\n                i.Description.includes('טיפול') ||\n                i.Description.includes('עבודה')\n            )\n        );\n\n        if (item && item.Description) {\n            const desc = item.Description.trim();\n\n            // תיקון חדש: חפש דפוס \"טיפול XXX ק\\\"מ\" או \"טיפול XXX,XXX ק\\\"מ\"\n            // דפוס: \"טיפול\" + מספר (עם או בלי פסיק) + \"ק\\\"מ\" או \"קמ\"\n            const servicePattern = /טיפול\\s+[\\d,]+\\s*ק[״\"]?מ/i;\n            const match = desc.match(servicePattern);\n\n            if (match) {\n                // נמצא דפוס טיפול - נקה אותו ונחזיר\n                let serviceDesc = match[0];\n                // המר \"קמ\" ל-\"ק\"מ\" והסר פסיקים מהמספר\n                serviceDesc = serviceDesc\n                    .replace(/,/g, '')          // הסר פסיקים\n                    .replace(/קמ/g, 'ק\"מ')      // תקנן את \"קמ\" ל-\"ק\"מ\"\n                    .replace(/ק״מ/g, 'ק\"מ');   // תקנן את ״ ל-\"\n\n                return serviceDesc;\n            }\n\n            // אם לא נמצא דפוס טיפול - חפש תיאורים אחרים (החלפה, תיקון, בדיקה)\n            const generalPattern = /(החלפת|תיקון|בדיקת|הח[''׳])\\s+[\\u0590-\\u05FF\\s]+/;\n            const generalMatch = desc.match(generalPattern);\n\n            if (generalMatch) {\n                // קח עד 50 תווים מהתיאור\n                let shortDesc = generalMatch[0].trim();\n                if (shortDesc.length > 50) {\n                    shortDesc = shortDesc.substring(0, 47) + '...';\n                }\n                return shortDesc;\n            }\n\n            // אם אין דפוס מיוחד - קח את 3-4 המילים הראשונות\n            const words = desc.split(/\\s+/);\n            let shortDesc = words.slice(0, 4).join(' ');\n\n            if (shortDesc.length > 50) {\n                shortDesc = shortDesc.substring(0, 47) + '...';\n            }\n\n            return shortDesc;\n        }\n    }\n\n    // אם לא מצאנו תיאור - החזר ברירת מחדל\n    return 'טיפול';\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 4\n// ============================================================================\n\nfunction buildInvoiceFromTemplate(template, structure, config, searchResults, learnedConfig, ocrFields) {\n    const invoice = {\n        SUPNAME: config.supplier_config.supplier_code,\n        CODE: template.CODE,\n        DEBIT: structure.debit_type,\n        IVDATE: searchResults.ivdate,\n        BOOKNUM: searchResults.booknum\n    };\n\n    if (searchResults.ordname) {\n        invoice.ORDNAME = searchResults.ordname;\n    }\n\n    if (searchResults.impfnum) {\n        invoice.IMPFNUM = searchResults.impfnum;\n    }\n\n    // תיקון: DETAILS - יצירה חכמה לפי רכבים\n    if (searchResults.vehicles && searchResults.vehicles.length > 0) {\n        // אם יש רכבים - בנה DETAILS עם תיאור טיפול + ק\"מ נוכחי\n        const vehicleNum = searchResults.vehicles[0];\n        const shortDesc = extractShortDescription(ocrFields, vehicleNum);\n\n        // חיפוש ק\"מ נוכחי מה-UnidentifiedNumbers או CustomerId\n        let currentMileage = '';\n\n        // נסה למצוא ק\"מ ב-UnidentifiedNumbers\n        const unidentified = ocrFields.UnidentifiedNumbers || [];\n        if (unidentified.length > 0) {\n            const mileageItem = unidentified.find(item => {\n                if (typeof item === 'object') {\n                    const label = item.label || '';\n                    const value = item.value || '';\n                    // חפש תווית \"ק\\\"מ\" או מספר בין 50000-300000 (טווח סביר לק\"מ)\n                    if (label.includes('ק') || label.includes('קמ') || label.includes('מ')) {\n                        return /^\\d{5,6}$/.test(value);\n                    }\n                }\n                return false;\n            });\n\n            if (mileageItem && typeof mileageItem === 'object') {\n                currentMileage = mileageItem.value;\n            }\n        }\n\n        // אם לא נמצא, נסה CustomerId (לפעמים Azure מזהה את ק\"מ כ-CustomerId)\n        if (!currentMileage && ocrFields.CustomerId && /^\\d{5,6}$/.test(ocrFields.CustomerId)) {\n            currentMileage = ocrFields.CustomerId;\n        }\n\n        // בנה DETAILS לפי הפורמט: \"תיאור טיפול-XXXXXק\\\"מ\"\n        invoice.DETAILS = currentMileage ? `${shortDesc}-${currentMileage}` : shortDesc;\n    } else if (searchResults.details) {\n        // אחרת - השתמש ב-DETAILS הרגיל\n        invoice.DETAILS = searchResults.details;\n    }\n\n    // תעודות\n    if (searchResults.documents && searchResults.documents.length > 0) {\n        if (searchResults.documents.length === 1) {\n            invoice.DOCNO = searchResults.documents[0].DOCNO;\n        } else {\n            invoice.PIVDOC_SUBFORM = searchResults.documents.map(d => ({\n                DOCNO: d.DOCNO,\n                BOOKNUM: d.BOOKNUM\n            }));\n        }\n    }\n\n    // פריטים\n    const needItems = shouldAddItems(structure, searchResults.documents);\n\n    if (needItems) {\n        const vehicleRules = config.rules?.critical_patterns?.vehicle_rules;\n\n        // ✨ חדש! אם יש רכבים - יוצרים פריטי רכבים\n        if (searchResults.vehicles && searchResults.vehicles.length > 0 && vehicleRules) {\n            invoice.PINVOICEITEMS_SUBFORM = createVehicleItems(\n                searchResults.vehicles,\n                searchResults.items,\n                vehicleRules,\n                ocrFields  // תיקון: העברת ocrFields\n            );\n        }\n        // אחרת - פריטים רגילים מ-OCR\n        else if (searchResults.items && searchResults.items.length > 0) {\n            invoice.PINVOICEITEMS_SUBFORM = buildItems(\n                searchResults.items,\n                config,\n                structure,\n                template,\n                learnedConfig\n            );\n        }\n    }\n\n    if (template.PINVOICESCONT_SUBFORM) {\n        invoice.PINVOICESCONT_SUBFORM = template.PINVOICESCONT_SUBFORM;\n    }\n\n    return invoice;\n}\n\nfunction shouldAddItems(structure, documents) {\n    if (!structure.has_doc) return true;\n    if (structure.has_doc && (!documents || documents.length === 0)) return true;\n    if (structure.has_doc && structure.inventory_management === \"not_managed_inventory\") return true;\n    return false;\n}\n\nfunction buildItems(ocrItems, config, structure, template, learnedConfig) {\n    let defaultAccname = \"\";\n\n    if (template.PINVOICEITEMS_SUBFORM && template.PINVOICEITEMS_SUBFORM.length > 0) {\n        defaultAccname = template.PINVOICEITEMS_SUBFORM[0].ACCNAME || \"\";\n    }\n\n    if (!defaultAccname && config.document_types && config.document_types.length > 0) {\n        const docType = config.document_types[0];\n        if (docType.accnames && docType.accnames.length > 0) {\n            defaultAccname = docType.accnames[0];\n        }\n    }\n\n    let defaultBudcode = \"\";\n    if (template.PINVOICEITEMS_SUBFORM && template.PINVOICEITEMS_SUBFORM.length > 0) {\n        defaultBudcode = template.PINVOICEITEMS_SUBFORM[0].BUDCODE || \"\";\n    }\n\n    return ocrItems.map(ocrItem => {\n        const item = {\n            PARTNAME: extractPartname(ocrItem.ProductCode),\n            PDES: ocrItem.Description || \"\",\n            TQUANT: ocrItem.Quantity || 1,\n            TUNITNAME: ocrItem.Unit || \"יח'\",\n            PRICE: ocrItem.UnitPrice || ocrItem.UnitPrice_amount || 0,\n            VATFLAG: \"Y\",\n            ACCNAME: defaultAccname\n        };\n\n        if (item.PARTNAME === \"car\" && config.rules.critical_patterns.vehicle_rules) {\n            applyVehicleRules(item, ocrItem.Description, config.rules.critical_patterns.vehicle_rules);\n        }\n\n        if (config.rules.critical_patterns.partname_rules) {\n            applyPartnameRules(item, config.rules.critical_patterns.partname_rules);\n        }\n\n        if (structure.has_budcode && defaultBudcode) {\n            item.BUDCODE = defaultBudcode;\n        }\n\n        return item;\n    });\n}\n\nfunction extractPartname(productCode) {\n    if (!productCode) return \"\";\n\n    const codes = String(productCode).split('\\n');\n    const priorityCode = codes.find(c => /^[A-Z]/.test(c) || /^\\d+$/.test(c));\n\n    return priorityCode || codes[0] || \"\";\n}\n\nfunction applyVehicleRules(item, description, vehicleRules) {\n    if (!vehicleRules.vehicle_account_mapping) return;\n\n    const vehicleMatch = description.match(/\\d{3}-\\d{2}-\\d{3}/);\n    if (!vehicleMatch) return;\n\n    const vehicleNum = vehicleMatch[0];\n    const mapping = vehicleRules.vehicle_account_mapping[vehicleNum];\n\n    if (mapping) {\n        item.ACCNAME = mapping.accname;\n        item.VATFLAG = mapping.vat_pattern?.VATFLAG || mapping.vatflag || item.VATFLAG;\n\n        if (mapping.vat_pattern?.SPECIALVATFLAG && mapping.vat_pattern.SPECIALVATFLAG !== \"varies\") {\n            item.SPECIALVATFLAG = mapping.vat_pattern.SPECIALVATFLAG;\n        }\n\n        if (mapping.budcode) {\n            item.BUDCODE = mapping.budcode;\n        }\n    }\n}\n\nfunction applyPartnameRules(item, partnameRules) {\n    const rule = partnameRules[item.PARTNAME];\n\n    if (rule) {\n        if (rule.accname) item.ACCNAME = rule.accname;\n        if (rule.vatflag) item.VATFLAG = rule.vatflag;\n        if (rule.specialvatflag) item.SPECIALVATFLAG = rule.specialvatflag;\n    }\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 5 (בקרות)\n// ============================================================================\n\nfunction performValidation(invoice, ocrFields, config, docsList, patterns) {\n    const warnings = [];\n    const checks = {};\n\n    let invoiceTotquant = 0;\n    if (invoice.PINVOICEITEMS_SUBFORM) {\n        invoiceTotquant = invoice.PINVOICEITEMS_SUBFORM.reduce(\n            (sum, item) => sum + (item.TQUANT || 0),\n            0\n        );\n    }\n\n    let docsTotquant = 0;\n    if (docsList && docsList.list_of_docs) {\n        try {\n            const docs = docsList.list_of_docs.map(d => JSON.parse(d));\n            docsTotquant = docs.reduce((sum, d) => sum + (d.TOTQUANT || 0), 0);\n        } catch (e) {\n            // ממשיכים בלי\n        }\n    }\n\n    const learnedTotquant = config.rules.validation_data.TOTQUANT || 0;\n\n    checks.totquant = {\n        invoice_items_sum: invoiceTotquant,\n        docs_sum: docsTotquant,\n        learned_reference: learnedTotquant,\n        items_vs_docs_match: invoiceTotquant === docsTotquant || docsTotquant === 0,\n        notes: []\n    };\n\n    if (invoiceTotquant !== docsTotquant && docsTotquant > 0) {\n        warnings.push(`אי התאמת כמויות: פריטים=${invoiceTotquant}, תעודות=${docsTotquant}`);\n        checks.totquant.notes.push(\"אי התאמה בין פריטים לתעודות\");\n    }\n\n    if (patterns.booknum_pattern) {\n        const expected = patterns.booknum_pattern.length;\n        const actual = invoice.BOOKNUM.length;\n\n        checks.booknum_pattern = {\n            expected_length: expected,\n            actual_length: actual,\n            match: expected === actual,\n            pattern_example: patterns.booknum_pattern.example\n        };\n\n        if (expected !== actual) {\n            warnings.push(`דפוס BOOKNUM: צפוי ${expected} ספרות, קיבלנו ${actual}`);\n        }\n    }\n\n    const requiredFields = [\"SUPNAME\", \"CODE\", \"DEBIT\", \"IVDATE\", \"BOOKNUM\"];\n    const missingFields = requiredFields.filter(f => !invoice[f]);\n\n    if (missingFields.length > 0) {\n        warnings.push(`שדות חובה חסרים: ${missingFields.join(', ')}`);\n    }\n\n    if (invoice.PINVOICEITEMS_SUBFORM) {\n        const emptyAccounts = invoice.PINVOICEITEMS_SUBFORM.filter(\n            item => !item.ACCNAME || item.ACCNAME === \"\"\n        );\n\n        if (emptyAccounts.length > 0) {\n            warnings.push(`${emptyAccounts.length} פריטים ללא ACCNAME`);\n        }\n    }\n\n    return {\n        all_valid: warnings.length === 0,\n        checks: checks,\n        warnings: warnings\n    };\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 6 (למידה)\n// ============================================================================\n\nfunction analyzeLearning(invoice, config) {\n    const newPatterns = {\n        new_partnames: [],\n        new_vehicles: [],\n        unknown_accounts: []\n    };\n\n    const instructions = [];\n\n    if (invoice.PINVOICEITEMS_SUBFORM) {\n        invoice.PINVOICEITEMS_SUBFORM.forEach(item => {\n            const partnameKnown = config.rules.critical_patterns.partname_rules &&\n                                config.rules.critical_patterns.partname_rules[item.PARTNAME];\n\n            if (!partnameKnown && item.PARTNAME !== \"car\") {\n                newPatterns.new_partnames.push({\n                    partname: item.PARTNAME,\n                    pdes: item.PDES,\n                    suggested_accname: item.ACCNAME\n                });\n\n                instructions.push({\n                    type: \"add_partname_rule\",\n                    partname: item.PARTNAME,\n                    suggested_accname: item.ACCNAME,\n                    priority: \"medium\"\n                });\n            }\n\n            // ✨ חדש! זיהוי רכב חדש\n            if (item.PARTNAME === \"car\" || item.isNewVehicle) {\n                const vehicleMatch = item.PDES.match(/\\d{3}-\\d{2}-\\d{3}/);\n                if (vehicleMatch) {\n                    const vNum = vehicleMatch[0];\n                    const vehicleKnown = config.rules?.critical_patterns?.vehicle_rules?.vehicle_account_mapping?.[vNum];\n\n                    if (!vehicleKnown || item.isNewVehicle) {\n                        newPatterns.new_vehicles.push({\n                            vehicle_number: vNum,\n                            suggested_accname: item.ACCNAME,\n                            suggested_budcode: item.BUDCODE,\n                            suggested_vatflag: item.VATFLAG\n                        });\n\n                        instructions.push({\n                            type: \"add_vehicle_rule\",\n                            vehicle_number: vNum,\n                            suggested_accname: item.ACCNAME,\n                            suggested_budcode: item.BUDCODE,\n                            priority: \"high\"\n                        });\n                    }\n                }\n            }\n\n            if (!item.ACCNAME || item.ACCNAME === \"\") {\n                newPatterns.unknown_accounts.push({\n                    partname: item.PARTNAME,\n                    pdes: item.PDES\n                });\n\n                instructions.push({\n                    type: \"missing_account\",\n                    partname: item.PARTNAME,\n                    priority: \"critical\"\n                });\n            }\n        });\n    }\n\n    const learningRequired =\n        newPatterns.new_partnames.length > 0 ||\n        newPatterns.new_vehicles.length > 0 ||\n        newPatterns.unknown_accounts.length > 0;\n\n    return {\n        learning_required: learningRequired,\n        new_patterns: newPatterns,\n        learning_instructions: instructions,\n        recommendation: learningRequired ? \"שלח לקוד 3 ללמידה\" : \"אין צורך בלמידה\"\n    };\n}\n\n// ============================================================================\n// פונקציות עזר - שלב 7 (יצירת פלטים נוספים)\n// ============================================================================\n\nfunction generateLLMPrompt(config, ocrFields, searchResults, executionReport) {\n    const supplierCode = config.supplier_config.supplier_code;\n    const supplierName = config.supplier_config.supplier_name;\n\n    // בניית הסבר על כל שדה\n    const fieldInstructions = {};\n\n    // BOOKNUM\n    fieldInstructions.booknum = {\n        field_name: \"BOOKNUM\",\n        description: \"מספר חשבונית\",\n        how_to_find: \"חפש בשדה InvoiceId ב-OCR. הסר קידומת SI אם קיימת. קח את מספר התווים האחרונים לפי הדפוס הנלמד.\",\n        example: searchResults.booknum || \"1015938\",\n        ocr_source: \"ocrFields.InvoiceId\"\n    };\n\n    // IVDATE\n    fieldInstructions.ivdate = {\n        field_name: \"IVDATE\",\n        description: \"תאריך חשבונית\",\n        how_to_find: \"קח את InvoiceDate מה-OCR והמר לפורמט DD/MM/YY\",\n        example: searchResults.ivdate || \"10/09/25\",\n        ocr_source: \"ocrFields.InvoiceDate\"\n    };\n\n    // PRICE - חשוב!\n    fieldInstructions.price = {\n        field_name: \"PRICE\",\n        description: \"מחיר לפני מע\\\"מ (עבודות + חלקים)\",\n        how_to_calculate: \"חשב: InvoiceTotal_amount - TotalTax_amount. זה נותן את סה\\\"כ החשבונית לפני מע\\\"מ.\",\n        formula: \"InvoiceTotal_amount - TotalTax_amount\",\n        example: ocrFields.InvoiceTotal_amount && ocrFields.TotalTax_amount\n            ? `${ocrFields.InvoiceTotal_amount} - ${ocrFields.TotalTax_amount} = ${ocrFields.InvoiceTotal_amount - ocrFields.TotalTax_amount}`\n            : \"2524 - 385.02 = 2138.98\",\n        fallback: \"אם אין TotalTax_amount, קח SubTotal_amount. אם גם זה לא קיים, קח InvoiceTotal_amount.\",\n        ocr_source: \"ocrFields.InvoiceTotal_amount, ocrFields.TotalTax_amount\"\n    };\n\n    // VEHICLES\n    const vehicleRules = config.rules?.critical_patterns?.vehicle_rules;\n    if (vehicleRules) {\n        fieldInstructions.vehicles = {\n            field_name: \"VEHICLES\",\n            description: \"מספרי רכבים\",\n            how_to_find: \"חפש פורמט XXX-XX-XXX ב-UnidentifiedNumbers עם label='רכב'. בדוק שזה לא מספר כרטיס (context לא מכיל 'כרטיס').\",\n            pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\",\n            example: searchResults.vehicles && searchResults.vehicles.length > 0\n                ? searchResults.vehicles.join(', ')\n                : \"459-06-303\",\n            ocr_source: \"ocrFields.UnidentifiedNumbers (with label filter)\"\n        };\n    }\n\n    // DETAILS\n    fieldInstructions.details = {\n        field_name: \"DETAILS\",\n        description: \"תיאור החשבונית\",\n        how_to_find: \"אם יש רכבים: חלץ תיאור קצר של השירות (3-4 מילים, מקסימום 50 תווים) מהפריט הראשון ב-Items. אם יש גם ק\\\"מ נוכחי (CustomerId), הוסף אותו בפורמט: 'תיאור-XXXXXק\\\"מ'\",\n        example: \"טיפול 75000 ק\\\"מ-76256\",\n        ocr_source: \"ocrFields.Items[0].Description, ocrFields.CustomerId\"\n    };\n\n    // מיפוי רכבים\n    const vehicleMapping = {};\n    if (vehicleRules && vehicleRules.vehicle_account_mapping) {\n        Object.keys(vehicleRules.vehicle_account_mapping).forEach(vNum => {\n            const mapping = vehicleRules.vehicle_account_mapping[vNum];\n            vehicleMapping[vNum] = {\n                account: mapping.accname,\n                budget_code: mapping.budcode,\n                vat_flag: mapping.vat_pattern?.VATFLAG || \"Y\",\n                description: mapping.accdes || `רכב ${vNum}`\n            };\n        });\n    }\n\n    return {\n        supplier_code: supplierCode,\n        supplier_name: supplierName,\n        document_type: \"חשבונית שירותי רכב\",\n        instructions: {\n            overview: `חשבונית מספק ${supplierName}. הספק מספק שירותי רכב ומוסך.`,\n            processing_steps: [\n                \"1. זהה את מספר החשבונית (BOOKNUM) מתוך InvoiceId\",\n                \"2. חשב את המחיר הכולל לפני מע\\\"מ: InvoiceTotal - TotalTax\",\n                \"3. חלץ מספרי רכבים מ-UnidentifiedNumbers (פורמט XXX-XX-XXX)\",\n                \"4. מפה כל רכב לחשבון הנכון לפי vehicle_mapping\",\n                \"5. צור תיאור קצר של השירות מהפריט הראשון\"\n            ],\n            fields: fieldInstructions,\n            vehicle_mapping: vehicleMapping\n        }\n    };\n}\n\nfunction generateTechnicalConfig(config, ocrFields, searchResults, executionReport) {\n    const supplierCode = config.supplier_config.supplier_code;\n    const supplierName = config.supplier_config.supplier_name;\n\n    // extraction rules מפורטים\n    const extractionRules = {};\n\n    // BOOKNUM\n    extractionRules.booknum = {\n        source: \"ocrFields.InvoiceId\",\n        transformations: [\n            {\n                action: \"remove_prefix\",\n                pattern: \"^SI\",\n                case_insensitive: true,\n                description: \"הסר קידומת SI אם קיימת\"\n            },\n            {\n                action: \"take_last_n_chars\",\n                count: 7,\n                description: \"קח 7 תווים אחרונים\"\n            }\n        ],\n        validation: {\n            length: 7,\n            pattern: \"^\\\\d{7}$\",\n            required: true\n        },\n        example: searchResults.booknum || \"1015938\"\n    };\n\n    // IVDATE\n    extractionRules.ivdate = {\n        source: \"ocrFields.InvoiceDate\",\n        format: \"DD/MM/YY\",\n        transformation: {\n            from: \"ISO8601\",\n            to: \"DD/MM/YY\",\n            description: \"המר מפורמט ISO (YYYY-MM-DD) לפורמט DD/MM/YY\"\n        },\n        validation: {\n            pattern: \"^\\\\d{2}/\\\\d{2}/\\\\d{2}$\",\n            required: true\n        },\n        example: searchResults.ivdate || \"10/09/25\"\n    };\n\n    // PRICE - החישוב החשוב!\n    extractionRules.price = {\n        calculation: {\n            method: \"subtract\",\n            primary: {\n                formula: \"ocrFields.InvoiceTotal_amount - ocrFields.TotalTax_amount\",\n                fields_required: [\"InvoiceTotal_amount\", \"TotalTax_amount\"],\n                description: \"סה\\\"כ לפני מע\\\"מ = סה\\\"כ כולל מע\\\"מ - מע\\\"מ\"\n            },\n            fallback: {\n                formula: \"ocrFields.SubTotal_amount || ocrFields.InvoiceTotal_amount\",\n                fields_required: [\"SubTotal_amount\"],\n                description: \"אם אין TotalTax_amount, קח SubTotal_amount\"\n            },\n            division_by_vehicles: {\n                enabled: true,\n                formula: \"totalPrice / vehicles.length\",\n                description: \"אם יש מספר רכבים, חלק את המחיר הכולל באופן שווה\"\n            }\n        },\n        description: \"מחיר לפני מע\\\"מ (עבודות + חלקים)\",\n        example_calculation: ocrFields.InvoiceTotal_amount && ocrFields.TotalTax_amount\n            ? {\n                invoice_total: ocrFields.InvoiceTotal_amount,\n                total_tax: ocrFields.TotalTax_amount,\n                calculated_price: ocrFields.InvoiceTotal_amount - ocrFields.TotalTax_amount,\n                formula_used: \"InvoiceTotal_amount - TotalTax_amount\"\n            }\n            : {\n                invoice_total: 2524,\n                total_tax: 385.02,\n                calculated_price: 2138.98,\n                formula_used: \"2524 - 385.02\"\n            }\n    };\n\n    // VEHICLES\n    const vehicleRules = config.rules?.critical_patterns?.vehicle_rules;\n    if (vehicleRules) {\n        extractionRules.vehicles = {\n            search_locations: [\n                {\n                    field: \"ocrFields.UnidentifiedNumbers\",\n                    priority: 1,\n                    filter: {\n                        label: \"רכב\",\n                        description: \"רק פריטים עם תווית 'רכב'\"\n                    },\n                    pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\",\n                    validation: {\n                        must_match_pattern: true,\n                        exclude_if_context_contains: [\"כרטיס\"],\n                        description: \"בדוק שזה לא מספר כרטיס\"\n                    }\n                },\n                {\n                    field: \"ocrFields.VehicleNumbers\",\n                    priority: 2,\n                    pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\"\n                },\n                {\n                    field: \"ocrFields.Items[].Description\",\n                    priority: 3,\n                    pattern: \"\\\\d{3}-\\\\d{2}-\\\\d{3}\",\n                    description: \"חפש בתיאור הפריטים\"\n                }\n            ],\n            example: searchResults.vehicles || [\"459-06-303\"]\n        };\n    }\n\n    // DOCUMENTS (DOCNO + BOOKNUM)\n    if (config.structure && config.structure.some(s => s.has_doc)) {\n        extractionRules.documents = {\n            search_in: [\n                {\n                    location: \"ocrFields.UnidentifiedNumbers\",\n                    priority: 1,\n                    filter: {\n                        label: \"מס׳ הקצאה (BOOKNUM)\",\n                        description: \"חפש במערך UnidentifiedNumbers עם תווית BOOKNUM\"\n                    },\n                    pattern: \"\\\\b(108\\\\d{6})\\\\b\",\n                    description: \"BOOKNUM - 9 ספרות מתחיל ב-108\"\n                },\n                {\n                    location: \"AZURE_TEXT\",\n                    priority: 2,\n                    fallback: true,\n                    pattern: \"\\\\b(108\\\\d{6})\\\\b\",\n                    description: \"חיפוש fallback ב-AZURE_TEXT אם לא נמצא ב-UnidentifiedNumbers\"\n                }\n            ],\n            matching: {\n                match_field: \"BOOKNUM\",\n                lookup_source: \"docs_list.list_of_docs\",\n                output_fields: [\"DOCNO\", \"BOOKNUM\"],\n                description: \"התאם את BOOKNUM שנמצא ב-OCR עם docs_list כדי לקבל DOCNO\"\n            },\n            output_format: {\n                field_name: \"PIVDOC_SUBFORM\",\n                structure: [\n                    {\n                        DOCNO: \"string - מספר תעודה פנימי ב-Priority (25XXXXXX)\",\n                        BOOKNUM: \"string - מספר הקצאה חיצוני (108XXXXXX)\"\n                    }\n                ]\n            },\n            error_handling: {\n                if_none_found: {\n                    action: \"return_partial_json\",\n                    include_empty_array: true,\n                    add_to_report: \"errors\",\n                    message: \"תבנית דורשת תעודות אך לא נמצאו ב-OCR\"\n                },\n                if_partial_found: {\n                    action: \"return_partial_json\",\n                    include_found_items: true,\n                    add_to_report: \"warnings\",\n                    message: \"נמצאו רק {found_count} מתוך {expected_count} תעודות\"\n                }\n            },\n            example: searchResults.documents || [\n                { DOCNO: \"25026849\", BOOKNUM: \"108379736\" },\n                { DOCNO: \"25026850\", BOOKNUM: \"108379734\" }\n            ]\n        };\n    }\n\n    // DESCRIPTION\n    extractionRules.description = {\n        source: \"ocrFields.Items[0].Description\",\n        extraction: {\n            method: \"pattern_match\",\n            patterns: [\n                {\n                    name: \"service_with_km\",\n                    pattern: \"טיפול\\\\s+[\\\\d,]+\\\\s*ק[״\\\"]?מ\",\n                    priority: 1,\n                    description: \"טיפול XXX ק\\\"מ\"\n                },\n                {\n                    name: \"general_service\",\n                    pattern: \"(החלפת|תיקון|בדיקת)\\\\s+[\\\\u0590-\\\\u05FF\\\\s]+\",\n                    priority: 2,\n                    description: \"תיאור כללי של שירות\"\n                }\n            ],\n            max_words: 4,\n            max_length: 50,\n            append_mileage: {\n                enabled: true,\n                source: \"ocrFields.CustomerId\",\n                format: \"{description}-{mileage}\",\n                description: \"אם יש ק\\\"מ נוכחי, הוסף בפורמט: 'תיאור-XXXXXק\\\"מ'\"\n            }\n        },\n        fallback: \"טיפול\",\n        example: \"טיפול 75000 ק\\\"מ\"\n    };\n\n    // Vehicle mapping\n    const vehicleMapping = {};\n    if (vehicleRules && vehicleRules.vehicle_account_mapping) {\n        Object.keys(vehicleRules.vehicle_account_mapping).forEach(vNum => {\n            const mapping = vehicleRules.vehicle_account_mapping[vNum];\n            vehicleMapping[vNum] = {\n                accname: mapping.accname,\n                accdes: mapping.accdes,\n                budcode: mapping.budcode,\n                vat_pattern: {\n                    VATFLAG: mapping.vat_pattern?.VATFLAG || \"Y\",\n                    SPECIALVATFLAG: mapping.vat_pattern?.SPECIALVATFLAG\n                },\n                date_range_pattern: mapping.date_range_pattern || \"never\",\n                pdaccname_pattern: mapping.pdaccname_pattern || \"never\"\n            };\n        });\n    }\n\n    // Template structure\n    const template = {\n        SUPNAME: supplierCode,\n        CODE: \"ש\\\"ח\",\n        DEBIT: \"D\",\n        TUNITNAME: \"יח'\",\n        TQUANT: 1,\n        PINVOICESCONT_SUBFORM: [\n            { FNCPATNAME: \"2323\" }\n        ]\n    };\n\n    return {\n        supplier_code: supplierCode,\n        supplier_name: supplierName,\n        version: \"4.2\",\n        document_type: \"vehicle_service_invoice\",\n        extraction_rules: extractionRules,\n        vehicle_mapping: vehicleMapping,\n        template: template,\n        validation_rules: {\n            required_fields: [\"SUPNAME\", \"CODE\", \"DEBIT\", \"IVDATE\", \"BOOKNUM\"],\n            booknum_length: 7,\n            totquant_check: {\n                enabled: true,\n                compare_with_docs: true,\n                learned_reference: config.rules.validation_data.TOTQUANT || 1\n            }\n        }\n    };\n}\n\n// ============================================================================\n// נקודת כניסה - רק אם input מוגדר (סביבת Azure Functions)\n// ============================================================================\n\nif (typeof input !== 'undefined') {\n    const processInput = {\n        learned_config: input.learned_config,\n        docs_list: input.docs_list,\n        import_files: input.import_files,\n        AZURE_RESULT: input.AZURE_RESULT,\n        AZURE_TEXT: input.AZURE_TEXT\n    };\n\n    const result = processInvoiceComplete(processInput);\n\n    console.log(JSON.stringify(result));\n    return result;\n}\n\n// ============================================================================\n// ייצוא פונקציות למודול\n// ============================================================================\nmodule.exports = {\n    processInvoiceComplete\n};"
    }
]

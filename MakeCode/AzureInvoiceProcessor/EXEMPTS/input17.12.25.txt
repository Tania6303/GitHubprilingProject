[
    {
        "input": [
            {
                "name": "contentLong",
                "value": "דרין, טרגל ושות' - רואי חשבון\nרח' המלאכה 8 ת.ד. 8642 א.ת. פולג נתניה\nטלפון: 073-2400700 פקס: 09-8628554\nעוסק מורשה 557149143\nמסמך ממוחשב\nחשבונית מס / קבלה מספר 052569\nלכבוד:\nמקור\nט.פ.י פל ים בע\"מ\nהקטיף 11 פארק תעשיות\nתאריך מסמך: 25/08/2025\nעמק חפר 3877701\nמספר לקוח: 260\naccount@t-p-y.co.il\nמ. עוסק לקוח: 513327064\nפרטי החשבונית\nתאור\nכמות\nמחיר ב $\nמחיר בש\"ח אחוז הנחה\nסה\"כ בש\"ח\n2025 ריטיינר יולי\n1\n0.00\n7,500.00\n7,500.00\nהנחה/תוספת עיגול\n0.00\nסה\"כ לפני מע\"מ\n7,500.00\n% 18 מע\"מ\n1,350.00\nסה\"כ כולל מע\"מ\n8,850.00\nפרטי התקבולים\nאופן תשלום\nמספר\nבנק\nסניף חשבון\nתאריך פרעון\nסכום\nהעברה\n10744\n2230018\n24/08/2025\n8,850.00\nניכוי מס במקור\nסה\"כ ששולם\n8,850.00\nהופק ע\"י אשפית של ט.מ.ל בתאריך 25/08/2025 בשעה 10:41:23 עפ\"י תעודת רישום (מ\"ה) מספר 97509\nמסמך זה נחתם בחתימה דיגיטלית מאובטחת"
            },
            {
                "name": "pages",
                "value": [
                    {
                        "pageNumber": 1,
                        "angle": 0,
                        "width": 10.625,
                        "height": 13.75,
                        "unit": "inch",
                        "words": [
                            {
                                "content": "דרין,",
                                "polygon": [
                                    5.4379,
                                    0.4536,
                                    6.1959,
                                    0.4774,
                                    6.19,
                                    0.7937,
                                    5.4319,
                                    0.7878
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 0,
                                    "length": 5
                                }
                            },
                            {
                                "content": "טרגל",
                                "polygon": [
                                    4.7395,
                                    0.4416,
                                    5.3722,
                                    0.4536,
                                    5.3662,
                                    0.7878,
                                    4.7335,
                                    0.7818
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 6,
                                    "length": 4
                                }
                            },
                            {
                                "content": "ושות'",
                                "polygon": [
                                    3.8262,
                                    0.4416,
                                    4.6738,
                                    0.4416,
                                    4.6678,
                                    0.7818,
                                    3.8202,
                                    0.7818
                                ],
                                "confidence": 0.796,
                                "span": {
                                    "offset": 11,
                                    "length": 5
                                }
                            },
                            {
                                "content": "-",
                                "polygon": [
                                    3.6292,
                                    0.4416,
                                    3.7605,
                                    0.4416,
                                    3.7546,
                                    0.7818,
                                    3.6232,
                                    0.7818
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 17,
                                    "length": 1
                                }
                            },
                            {
                                "content": "רואי",
                                "polygon": [
                                    2.9308,
                                    0.4536,
                                    3.5636,
                                    0.4416,
                                    3.5576,
                                    0.7878,
                                    2.9249,
                                    0.7878
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 19,
                                    "length": 4
                                }
                            },
                            {
                                "content": "חשבון",
                                "polygon": [
                                    2.0414,
                                    0.4834,
                                    2.8652,
                                    0.4595,
                                    2.8592,
                                    0.7878,
                                    2.0355,
                                    0.7937
                                ],
                                "confidence": 0.976,
                                "span": {
                                    "offset": 24,
                                    "length": 5
                                }
                            },
                            {
                                "content": "רח׳",
                                "polygon": [
                                    7.5509,
                                    0.8116,
                                    7.8971,
                                    0.8116,
                                    7.8971,
                                    1.0265,
                                    7.5509,
                                    1.0265
                                ],
                                "confidence": 0.879,
                                "span": {
                                    "offset": 30,
                                    "length": 3
                                }
                            },
                            {
                                "content": "המלאכה",
                                "polygon": [
                                    6.8764,
                                    0.8116,
                                    7.5091,
                                    0.8116,
                                    7.5091,
                                    1.0265,
                                    6.8764,
                                    1.0265
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 34,
                                    "length": 6
                                }
                            },
                            {
                                "content": "8",
                                "polygon": [
                                    6.6675,
                                    0.8116,
                                    6.7988,
                                    0.8116,
                                    6.7988,
                                    1.0265,
                                    6.6675,
                                    1.0265
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 41,
                                    "length": 1
                                }
                            },
                            {
                                "content": "ת.ד.",
                                "polygon": [
                                    6.2437,
                                    0.8116,
                                    6.6257,
                                    0.8116,
                                    6.6257,
                                    1.0265,
                                    6.2437,
                                    1.0205
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 43,
                                    "length": 4
                                }
                            },
                            {
                                "content": "8642",
                                "polygon": [
                                    5.8438,
                                    0.8116,
                                    6.2019,
                                    0.8116,
                                    6.2019,
                                    1.0205,
                                    5.8438,
                                    1.0265
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 48,
                                    "length": 4
                                }
                            },
                            {
                                "content": "א.ת.",
                                "polygon": [
                                    5.3722,
                                    0.8176,
                                    5.79,
                                    0.8116,
                                    5.79,
                                    1.0265,
                                    5.3722,
                                    1.0265
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 53,
                                    "length": 4
                                }
                            },
                            {
                                "content": "פולג",
                                "polygon": [
                                    5.0021,
                                    0.8176,
                                    5.3304,
                                    0.8176,
                                    5.3304,
                                    1.0265,
                                    5.0021,
                                    1.0265
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 58,
                                    "length": 4
                                }
                            },
                            {
                                "content": "נתניה",
                                "polygon": [
                                    4.5305,
                                    0.8176,
                                    4.9603,
                                    0.8176,
                                    4.9603,
                                    1.0265,
                                    4.5365,
                                    1.0265
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 63,
                                    "length": 5
                                }
                            },
                            {
                                "content": "טלפון:",
                                "polygon": [
                                    7.2465,
                                    1.0503,
                                    7.8732,
                                    1.0503,
                                    7.8732,
                                    1.2652,
                                    7.2465,
                                    1.2652
                                ],
                                "confidence": 0.97,
                                "span": {
                                    "offset": 69,
                                    "length": 6
                                }
                            },
                            {
                                "content": "073-2400700",
                                "polygon": [
                                    6.2317,
                                    1.0503,
                                    7.2047,
                                    1.0503,
                                    7.2047,
                                    1.2652,
                                    6.2317,
                                    1.2652
                                ],
                                "confidence": 0.954,
                                "span": {
                                    "offset": 76,
                                    "length": 11
                                }
                            },
                            {
                                "content": "פקס:",
                                "polygon": [
                                    5.4379,
                                    1.0563,
                                    5.9989,
                                    1.0503,
                                    5.9989,
                                    1.2652,
                                    5.4379,
                                    1.2652
                                ],
                                "confidence": 0.92,
                                "span": {
                                    "offset": 88,
                                    "length": 4
                                }
                            },
                            {
                                "content": "09-8628554",
                                "polygon": [
                                    4.5007,
                                    1.0563,
                                    5.3961,
                                    1.0563,
                                    5.3961,
                                    1.2652,
                                    4.5007,
                                    1.2592
                                ],
                                "confidence": 0.954,
                                "span": {
                                    "offset": 93,
                                    "length": 10
                                }
                            },
                            {
                                "content": "עוסק",
                                "polygon": [
                                    1.9161,
                                    1.307,
                                    2.3399,
                                    1.3129,
                                    2.3399,
                                    1.5278,
                                    1.9161,
                                    1.5278
                                ],
                                "confidence": 0.975,
                                "span": {
                                    "offset": 104,
                                    "length": 4
                                }
                            },
                            {
                                "content": "מורשה",
                                "polygon": [
                                    1.3132,
                                    1.301,
                                    1.8743,
                                    1.307,
                                    1.8743,
                                    1.5278,
                                    1.3132,
                                    1.5218
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 109,
                                    "length": 5
                                }
                            },
                            {
                                "content": "557149143",
                                "polygon": [
                                    0.3999,
                                    1.2891,
                                    1.1759,
                                    1.301,
                                    1.1759,
                                    1.5158,
                                    0.3999,
                                    1.4979
                                ],
                                "confidence": 0.928,
                                "span": {
                                    "offset": 115,
                                    "length": 9
                                }
                            },
                            {
                                "content": "מסמך",
                                "polygon": [
                                    1.8385,
                                    1.6054,
                                    2.2444,
                                    1.5994,
                                    2.2444,
                                    1.7844,
                                    1.8385,
                                    1.7844
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 125,
                                    "length": 4
                                }
                            },
                            {
                                "content": "ממוחשב",
                                "polygon": [
                                    1.2177,
                                    1.5994,
                                    1.8027,
                                    1.6054,
                                    1.8027,
                                    1.7844,
                                    1.2237,
                                    1.7844
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 130,
                                    "length": 6
                                }
                            },
                            {
                                "content": "חשבונית",
                                "polygon": [
                                    5.1155,
                                    1.7904,
                                    5.9393,
                                    1.7963,
                                    5.9452,
                                    2.0291,
                                    5.1215,
                                    2.047
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 137,
                                    "length": 7
                                }
                            },
                            {
                                "content": "מס",
                                "polygon": [
                                    4.7395,
                                    1.7904,
                                    5.0379,
                                    1.7904,
                                    5.0439,
                                    2.047,
                                    4.7395,
                                    2.053
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 145,
                                    "length": 2
                                }
                            },
                            {
                                "content": "/",
                                "polygon": [
                                    4.5365,
                                    1.7904,
                                    4.6857,
                                    1.7904,
                                    4.6917,
                                    2.053,
                                    4.5425,
                                    2.053
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 148,
                                    "length": 1
                                }
                            },
                            {
                                "content": "קבלה",
                                "polygon": [
                                    4.0291,
                                    1.7844,
                                    4.4888,
                                    1.7904,
                                    4.4947,
                                    2.053,
                                    4.0291,
                                    2.053
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 150,
                                    "length": 4
                                }
                            },
                            {
                                "content": "מספר",
                                "polygon": [
                                    3.3666,
                                    1.7844,
                                    3.9515,
                                    1.7844,
                                    3.9515,
                                    2.053,
                                    3.3725,
                                    2.041
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 155,
                                    "length": 4
                                }
                            },
                            {
                                "content": "052569",
                                "polygon": [
                                    2.4414,
                                    1.7844,
                                    3.2711,
                                    1.7844,
                                    3.277,
                                    2.041,
                                    2.4473,
                                    2.0171
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 160,
                                    "length": 6
                                }
                            },
                            {
                                "content": "לכבוד:",
                                "polygon": [
                                    7.2942,
                                    2.0888,
                                    7.7121,
                                    2.0888,
                                    7.7121,
                                    2.2439,
                                    7.2942,
                                    2.2499
                                ],
                                "confidence": 0.979,
                                "span": {
                                    "offset": 167,
                                    "length": 6
                                }
                            },
                            {
                                "content": "מקור",
                                "polygon": [
                                    1.8624,
                                    2.1663,
                                    2.3339,
                                    2.1663,
                                    2.3339,
                                    2.3872,
                                    1.8624,
                                    2.3872
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 174,
                                    "length": 4
                                }
                            },
                            {
                                "content": "ט.פ.י",
                                "polygon": [
                                    7.342,
                                    2.3692,
                                    7.7419,
                                    2.3692,
                                    7.7419,
                                    2.5662,
                                    7.336,
                                    2.5662
                                ],
                                "confidence": 0.976,
                                "span": {
                                    "offset": 179,
                                    "length": 5
                                }
                            },
                            {
                                "content": "פל",
                                "polygon": [
                                    7.157,
                                    2.3692,
                                    7.3002,
                                    2.3692,
                                    7.3002,
                                    2.5662,
                                    7.157,
                                    2.5722
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 185,
                                    "length": 2
                                }
                            },
                            {
                                "content": "ים",
                                "polygon": [
                                    6.9898,
                                    2.3692,
                                    7.1211,
                                    2.3692,
                                    7.1152,
                                    2.5722,
                                    6.9898,
                                    2.5722
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 188,
                                    "length": 2
                                }
                            },
                            {
                                "content": "בע״מ",
                                "polygon": [
                                    6.5779,
                                    2.3692,
                                    6.954,
                                    2.3692,
                                    6.948,
                                    2.5722,
                                    6.572,
                                    2.5662
                                ],
                                "confidence": 0.773,
                                "span": {
                                    "offset": 191,
                                    "length": 4
                                }
                            },
                            {
                                "content": "הקטיף",
                                "polygon": [
                                    7.3002,
                                    2.608,
                                    7.718,
                                    2.608,
                                    7.718,
                                    2.7989,
                                    7.3002,
                                    2.793
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 196,
                                    "length": 5
                                }
                            },
                            {
                                "content": "11",
                                "polygon": [
                                    7.0674,
                                    2.608,
                                    7.2644,
                                    2.608,
                                    7.2644,
                                    2.793,
                                    7.0674,
                                    2.793
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 202,
                                    "length": 2
                                }
                            },
                            {
                                "content": "פארק",
                                "polygon": [
                                    6.6735,
                                    2.602,
                                    7.0316,
                                    2.608,
                                    7.0316,
                                    2.793,
                                    6.6735,
                                    2.793
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 205,
                                    "length": 4
                                }
                            },
                            {
                                "content": "תעשיות",
                                "polygon": [
                                    6.178,
                                    2.602,
                                    6.6317,
                                    2.602,
                                    6.6376,
                                    2.793,
                                    6.184,
                                    2.793
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 210,
                                    "length": 6
                                }
                            },
                            {
                                "content": "תאריך",
                                "polygon": [
                                    1.9161,
                                    2.4826,
                                    2.3399,
                                    2.4826,
                                    2.3399,
                                    2.6915,
                                    1.9161,
                                    2.6915
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 217,
                                    "length": 5
                                }
                            },
                            {
                                "content": "מסמך:",
                                "polygon": [
                                    1.4027,
                                    2.4826,
                                    1.8803,
                                    2.4826,
                                    1.8803,
                                    2.6915,
                                    1.4027,
                                    2.6915
                                ],
                                "confidence": 0.981,
                                "span": {
                                    "offset": 223,
                                    "length": 5
                                }
                            },
                            {
                                "content": "25/08/2025",
                                "polygon": [
                                    0.5074,
                                    2.4707,
                                    1.361,
                                    2.4826,
                                    1.361,
                                    2.6915,
                                    0.5074,
                                    2.6736
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 229,
                                    "length": 10
                                }
                            },
                            {
                                "content": "עמק",
                                "polygon": [
                                    7.4315,
                                    2.8228,
                                    7.718,
                                    2.8288,
                                    7.718,
                                    3.0078,
                                    7.4315,
                                    3.0018
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 240,
                                    "length": 3
                                }
                            },
                            {
                                "content": "חפר",
                                "polygon": [
                                    7.1092,
                                    2.8228,
                                    7.3957,
                                    2.8228,
                                    7.3957,
                                    3.0018,
                                    7.1092,
                                    3.0018
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 244,
                                    "length": 3
                                }
                            },
                            {
                                "content": "3877701",
                                "polygon": [
                                    6.3631,
                                    2.8168,
                                    7.0316,
                                    2.8228,
                                    7.0316,
                                    3.0018,
                                    6.3631,
                                    3.0018
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 248,
                                    "length": 7
                                }
                            },
                            {
                                "content": "מספר",
                                "polygon": [
                                    1.94,
                                    2.7393,
                                    2.3279,
                                    2.7333,
                                    2.3279,
                                    2.9302,
                                    1.94,
                                    2.9243
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 256,
                                    "length": 4
                                }
                            },
                            {
                                "content": "לקוח:",
                                "polygon": [
                                    1.3968,
                                    2.7393,
                                    1.9041,
                                    2.7393,
                                    1.9041,
                                    2.9243,
                                    1.4027,
                                    2.9183
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 261,
                                    "length": 5
                                }
                            },
                            {
                                "content": "260",
                                "polygon": [
                                    1.0744,
                                    2.7393,
                                    1.361,
                                    2.7393,
                                    1.3669,
                                    2.9183,
                                    1.0744,
                                    2.9183
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 267,
                                    "length": 3
                                }
                            },
                            {
                                "content": "account@t-p-y.co.il",
                                "polygon": [
                                    6.3392,
                                    3.0257,
                                    7.7479,
                                    3.0257,
                                    7.7419,
                                    3.2406,
                                    6.3392,
                                    3.2406
                                ],
                                "confidence": 0.945,
                                "span": {
                                    "offset": 271,
                                    "length": 19
                                }
                            },
                            {
                                "content": "מ.",
                                "polygon": [
                                    2.119,
                                    2.9541,
                                    2.322,
                                    2.9541,
                                    2.316,
                                    3.163,
                                    2.1131,
                                    3.157
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 291,
                                    "length": 2
                                }
                            },
                            {
                                "content": "עוסק",
                                "polygon": [
                                    1.8624,
                                    2.9541,
                                    2.0772,
                                    2.9541,
                                    2.0713,
                                    3.157,
                                    1.8564,
                                    3.157
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 294,
                                    "length": 4
                                }
                            },
                            {
                                "content": "לקוח:",
                                "polygon": [
                                    1.4266,
                                    2.9481,
                                    1.8206,
                                    2.9481,
                                    1.8146,
                                    3.151,
                                    1.4206,
                                    3.151
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 299,
                                    "length": 5
                                }
                            },
                            {
                                "content": "513327064",
                                "polygon": [
                                    0.5133,
                                    2.9362,
                                    1.3729,
                                    2.9481,
                                    1.3669,
                                    3.151,
                                    0.5074,
                                    3.151
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 305,
                                    "length": 9
                                }
                            },
                            {
                                "content": "פרטי",
                                "polygon": [
                                    6.9898,
                                    3.6046,
                                    7.3539,
                                    3.6046,
                                    7.3539,
                                    3.7777,
                                    6.9898,
                                    3.7717
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 315,
                                    "length": 4
                                }
                            },
                            {
                                "content": "החשבונית",
                                "polygon": [
                                    6.3213,
                                    3.6106,
                                    6.96,
                                    3.6046,
                                    6.96,
                                    3.7717,
                                    6.3213,
                                    3.7777
                                ],
                                "confidence": 0.972,
                                "span": {
                                    "offset": 320,
                                    "length": 8
                                }
                            },
                            {
                                "content": "תאור",
                                "polygon": [
                                    6.9779,
                                    3.8672,
                                    7.3062,
                                    3.8672,
                                    7.3062,
                                    4.0044,
                                    6.9779,
                                    4.0104
                                ],
                                "confidence": 0.981,
                                "span": {
                                    "offset": 329,
                                    "length": 4
                                }
                            },
                            {
                                "content": "כמות",
                                "polygon": [
                                    4.5544,
                                    3.8732,
                                    4.835,
                                    3.8732,
                                    4.829,
                                    4.0044,
                                    4.5544,
                                    4.0044
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 334,
                                    "length": 4
                                }
                            },
                            {
                                "content": "מחיר",
                                "polygon": [
                                    3.8322,
                                    3.8493,
                                    4.1664,
                                    3.8553,
                                    4.1664,
                                    4.0224,
                                    3.8322,
                                    4.0224
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 339,
                                    "length": 4
                                }
                            },
                            {
                                "content": "ב",
                                "polygon": [
                                    3.6949,
                                    3.8493,
                                    3.7963,
                                    3.8493,
                                    3.8023,
                                    4.0224,
                                    3.6949,
                                    4.0224
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 344,
                                    "length": 1
                                }
                            },
                            {
                                "content": "$",
                                "polygon": [
                                    3.5456,
                                    3.8493,
                                    3.6531,
                                    3.8493,
                                    3.6531,
                                    4.0224,
                                    3.5516,
                                    4.0224
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 346,
                                    "length": 1
                                }
                            },
                            {
                                "content": "מחיר",
                                "polygon": [
                                    2.9368,
                                    3.8553,
                                    3.2591,
                                    3.8553,
                                    3.2591,
                                    4.0164,
                                    2.9368,
                                    4.0164
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 348,
                                    "length": 4
                                }
                            },
                            {
                                "content": "בש״ח",
                                "polygon": [
                                    2.507,
                                    3.8553,
                                    2.901,
                                    3.8553,
                                    2.901,
                                    4.0164,
                                    2.513,
                                    4.0224
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 353,
                                    "length": 4
                                }
                            },
                            {
                                "content": "אחוז",
                                "polygon": [
                                    2.1011,
                                    3.8612,
                                    2.4235,
                                    3.8553,
                                    2.4294,
                                    4.0224,
                                    2.1011,
                                    4.0224
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 358,
                                    "length": 4
                                }
                            },
                            {
                                "content": "הנחה",
                                "polygon": [
                                    1.7251,
                                    3.8672,
                                    2.0653,
                                    3.8612,
                                    2.0713,
                                    4.0224,
                                    1.7251,
                                    4.0283
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 363,
                                    "length": 4
                                }
                            },
                            {
                                "content": "סה״כ",
                                "polygon": [
                                    1.0327,
                                    3.8553,
                                    1.3968,
                                    3.8612,
                                    1.3968,
                                    4.0164,
                                    1.0327,
                                    4.0164
                                ],
                                "confidence": 0.94,
                                "span": {
                                    "offset": 368,
                                    "length": 4
                                }
                            },
                            {
                                "content": "בש״ח",
                                "polygon": [
                                    0.6029,
                                    3.8553,
                                    0.9909,
                                    3.8553,
                                    0.9909,
                                    4.0164,
                                    0.6088,
                                    4.0104
                                ],
                                "confidence": 0.966,
                                "span": {
                                    "offset": 373,
                                    "length": 4
                                }
                            },
                            {
                                "content": "2025",
                                "polygon": [
                                    6.96,
                                    4.082,
                                    7.2763,
                                    4.082,
                                    7.2763,
                                    4.2312,
                                    6.96,
                                    4.2312
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 378,
                                    "length": 4
                                }
                            },
                            {
                                "content": "ריטיינר",
                                "polygon": [
                                    6.5541,
                                    4.082,
                                    6.9301,
                                    4.082,
                                    6.9361,
                                    4.2312,
                                    6.5541,
                                    4.2312
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 383,
                                    "length": 7
                                }
                            },
                            {
                                "content": "יולי",
                                "polygon": [
                                    6.3511,
                                    4.082,
                                    6.5242,
                                    4.082,
                                    6.5302,
                                    4.2312,
                                    6.3511,
                                    4.2253
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 391,
                                    "length": 4
                                }
                            },
                            {
                                "content": "1",
                                "polygon": [
                                    4.7872,
                                    4.088,
                                    4.835,
                                    4.088,
                                    4.8409,
                                    4.1895,
                                    4.7932,
                                    4.1954
                                ],
                                "confidence": 0.995,
                                "span": {
                                    "offset": 396,
                                    "length": 1
                                }
                            },
                            {
                                "content": "0.00",
                                "polygon": [
                                    3.868,
                                    4.082,
                                    4.1426,
                                    4.082,
                                    4.1426,
                                    4.2193,
                                    3.868,
                                    4.2193
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 398,
                                    "length": 4
                                }
                            },
                            {
                                "content": "7,500.00",
                                "polygon": [
                                    2.71,
                                    4.082,
                                    3.2591,
                                    4.0761,
                                    3.2532,
                                    4.2312,
                                    2.71,
                                    4.2253
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 403,
                                    "length": 8
                                }
                            },
                            {
                                "content": "7,500.00",
                                "polygon": [
                                    0.8536,
                                    4.082,
                                    1.4027,
                                    4.082,
                                    1.4027,
                                    4.2312,
                                    0.8596,
                                    4.2312
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 412,
                                    "length": 8
                                }
                            },
                            {
                                "content": "הנחה/תוספת",
                                "polygon": [
                                    2.2862,
                                    4.3446,
                                    3.1577,
                                    4.3446,
                                    3.1517,
                                    4.5296,
                                    2.2862,
                                    4.5296
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 421,
                                    "length": 10
                                }
                            },
                            {
                                "content": "עיגול",
                                "polygon": [
                                    1.8683,
                                    4.3446,
                                    2.2026,
                                    4.3446,
                                    2.2026,
                                    4.5296,
                                    1.8683,
                                    4.5296
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 432,
                                    "length": 5
                                }
                            },
                            {
                                "content": "0.00",
                                "polygon": [
                                    1.1103,
                                    4.3446,
                                    1.4147,
                                    4.3446,
                                    1.4147,
                                    4.4998,
                                    1.1103,
                                    4.4998
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 438,
                                    "length": 4
                                }
                            },
                            {
                                "content": "סה״כ",
                                "polygon": [
                                    2.7518,
                                    4.5714,
                                    3.1338,
                                    4.5714,
                                    3.1278,
                                    4.7504,
                                    2.7518,
                                    4.7445
                                ],
                                "confidence": 0.952,
                                "span": {
                                    "offset": 443,
                                    "length": 4
                                }
                            },
                            {
                                "content": "לפני",
                                "polygon": [
                                    2.4055,
                                    4.5714,
                                    2.7159,
                                    4.5714,
                                    2.7159,
                                    4.7445,
                                    2.4055,
                                    4.7504
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 448,
                                    "length": 4
                                }
                            },
                            {
                                "content": "מע״מ",
                                "polygon": [
                                    2.0235,
                                    4.5774,
                                    2.3697,
                                    4.5714,
                                    2.3697,
                                    4.7504,
                                    2.0235,
                                    4.7504
                                ],
                                "confidence": 0.976,
                                "span": {
                                    "offset": 453,
                                    "length": 4
                                }
                            },
                            {
                                "content": "7,500.00",
                                "polygon": [
                                    0.8237,
                                    4.5774,
                                    1.4147,
                                    4.5654,
                                    1.4147,
                                    4.7325,
                                    0.8237,
                                    4.7325
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 458,
                                    "length": 8
                                }
                            },
                            {
                                "content": "%",
                                "polygon": [
                                    3.0323,
                                    4.7922,
                                    3.1397,
                                    4.7922,
                                    3.1397,
                                    4.9712,
                                    3.0383,
                                    4.9712
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 467,
                                    "length": 1
                                }
                            },
                            {
                                "content": "18",
                                "polygon": [
                                    2.7338,
                                    4.7922,
                                    2.9428,
                                    4.7922,
                                    2.9487,
                                    4.9712,
                                    2.7338,
                                    4.9712
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 469,
                                    "length": 2
                                }
                            },
                            {
                                "content": "מע״מ",
                                "polygon": [
                                    2.3279,
                                    4.8041,
                                    2.698,
                                    4.7922,
                                    2.704,
                                    4.9712,
                                    2.3339,
                                    4.9772
                                ],
                                "confidence": 0.922,
                                "span": {
                                    "offset": 472,
                                    "length": 4
                                }
                            },
                            {
                                "content": "1,350.00",
                                "polygon": [
                                    0.8237,
                                    4.7982,
                                    1.4087,
                                    4.7922,
                                    1.4147,
                                    4.9533,
                                    0.8297,
                                    4.9474
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 477,
                                    "length": 8
                                }
                            },
                            {
                                "content": "סה״כ",
                                "polygon": [
                                    2.7577,
                                    5.019,
                                    3.1397,
                                    5.013,
                                    3.1397,
                                    5.198,
                                    2.7577,
                                    5.198
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 486,
                                    "length": 4
                                }
                            },
                            {
                                "content": "כולל",
                                "polygon": [
                                    2.4175,
                                    5.019,
                                    2.7219,
                                    5.019,
                                    2.7219,
                                    5.1921,
                                    2.4235,
                                    5.1921
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 491,
                                    "length": 4
                                }
                            },
                            {
                                "content": "מע״מ",
                                "polygon": [
                                    2.0116,
                                    5.019,
                                    2.3876,
                                    5.019,
                                    2.3876,
                                    5.1921,
                                    2.0176,
                                    5.1921
                                ],
                                "confidence": 0.926,
                                "span": {
                                    "offset": 496,
                                    "length": 4
                                }
                            },
                            {
                                "content": "8,850.00",
                                "polygon": [
                                    0.8058,
                                    5.019,
                                    1.4147,
                                    5.013,
                                    1.4147,
                                    5.1861,
                                    0.8118,
                                    5.1861
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 501,
                                    "length": 8
                                }
                            },
                            {
                                "content": "פרטי",
                                "polygon": [
                                    6.8525,
                                    5.6993,
                                    7.2286,
                                    5.6934,
                                    7.2346,
                                    5.9022,
                                    6.8525,
                                    5.9022
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 510,
                                    "length": 4
                                }
                            },
                            {
                                "content": "התקבולים",
                                "polygon": [
                                    6.184,
                                    5.6993,
                                    6.8107,
                                    5.6993,
                                    6.8167,
                                    5.9022,
                                    6.178,
                                    5.8963
                                ],
                                "confidence": 0.976,
                                "span": {
                                    "offset": 515,
                                    "length": 8
                                }
                            },
                            {
                                "content": "אופן",
                                "polygon": [
                                    6.8346,
                                    5.9679,
                                    7.145,
                                    5.9679,
                                    7.151,
                                    6.141,
                                    6.8346,
                                    6.141
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 524,
                                    "length": 4
                                }
                            },
                            {
                                "content": "תשלום",
                                "polygon": [
                                    6.369,
                                    5.9619,
                                    6.7988,
                                    5.9679,
                                    6.8048,
                                    6.141,
                                    6.369,
                                    6.141
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 529,
                                    "length": 5
                                }
                            },
                            {
                                "content": "מספר",
                                "polygon": [
                                    5.5393,
                                    5.9858,
                                    5.9154,
                                    5.9858,
                                    5.9154,
                                    6.123,
                                    5.5393,
                                    6.1171
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 535,
                                    "length": 4
                                }
                            },
                            {
                                "content": "בנק",
                                "polygon": [
                                    4.6977,
                                    5.9738,
                                    4.9424,
                                    5.9738,
                                    4.9484,
                                    6.129,
                                    4.6977,
                                    6.135
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 540,
                                    "length": 3
                                }
                            },
                            {
                                "content": "סניף",
                                "polygon": [
                                    4.2858,
                                    5.9738,
                                    4.5783,
                                    5.9738,
                                    4.5783,
                                    6.141,
                                    4.2858,
                                    6.141
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 544,
                                    "length": 4
                                }
                            },
                            {
                                "content": "חשבון",
                                "polygon": [
                                    3.8202,
                                    5.9738,
                                    4.244,
                                    5.9738,
                                    4.244,
                                    6.141,
                                    3.8322,
                                    6.1469
                                ],
                                "confidence": 0.948,
                                "span": {
                                    "offset": 549,
                                    "length": 5
                                }
                            },
                            {
                                "content": "תאריך",
                                "polygon": [
                                    2.9129,
                                    5.9679,
                                    3.3188,
                                    5.9619,
                                    3.3248,
                                    6.141,
                                    2.9129,
                                    6.141
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 555,
                                    "length": 5
                                }
                            },
                            {
                                "content": "פרעון",
                                "polygon": [
                                    2.4831,
                                    5.9738,
                                    2.8771,
                                    5.9679,
                                    2.8831,
                                    6.141,
                                    2.4831,
                                    6.1469
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 561,
                                    "length": 5
                                }
                            },
                            {
                                "content": "סכום",
                                "polygon": [
                                    2.1011,
                                    5.9798,
                                    2.4115,
                                    5.9798,
                                    2.4115,
                                    6.129,
                                    2.1011,
                                    6.129
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 567,
                                    "length": 4
                                }
                            },
                            {
                                "content": "העברה",
                                "polygon": [
                                    6.7451,
                                    6.2066,
                                    7.1271,
                                    6.2006,
                                    7.1271,
                                    6.3498,
                                    6.7511,
                                    6.3439
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 572,
                                    "length": 5
                                }
                            },
                            {
                                "content": "10",
                                "polygon": [
                                    4.7872,
                                    6.1947,
                                    4.9245,
                                    6.1947,
                                    4.9305,
                                    6.32,
                                    4.7872,
                                    6.32
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 578,
                                    "length": 2
                                }
                            },
                            {
                                "content": "744",
                                "polygon": [
                                    4.3634,
                                    6.1947,
                                    4.5843,
                                    6.1947,
                                    4.5843,
                                    6.326,
                                    4.3634,
                                    6.326
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 581,
                                    "length": 3
                                }
                            },
                            {
                                "content": "2230018",
                                "polygon": [
                                    3.7068,
                                    6.1887,
                                    4.2321,
                                    6.1947,
                                    4.2261,
                                    6.3319,
                                    3.7128,
                                    6.3319
                                ],
                                "confidence": 0.981,
                                "span": {
                                    "offset": 585,
                                    "length": 7
                                }
                            },
                            {
                                "content": "24/08/2025",
                                "polygon": [
                                    2.6264,
                                    6.1947,
                                    3.3188,
                                    6.1887,
                                    3.3188,
                                    6.3319,
                                    2.6324,
                                    6.3319
                                ],
                                "confidence": 0.894,
                                "span": {
                                    "offset": 593,
                                    "length": 10
                                }
                            },
                            {
                                "content": "8,850.00",
                                "polygon": [
                                    1.8982,
                                    6.1947,
                                    2.4354,
                                    6.1947,
                                    2.4354,
                                    6.3379,
                                    1.8982,
                                    6.3379
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 604,
                                    "length": 8
                                }
                            },
                            {
                                "content": "ניכוי",
                                "polygon": [
                                    3.6591,
                                    6.499,
                                    3.9814,
                                    6.4931,
                                    3.9814,
                                    6.69,
                                    3.665,
                                    6.696
                                ],
                                "confidence": 0.976,
                                "span": {
                                    "offset": 613,
                                    "length": 5
                                }
                            },
                            {
                                "content": "מס",
                                "polygon": [
                                    3.468,
                                    6.499,
                                    3.6232,
                                    6.499,
                                    3.6232,
                                    6.696,
                                    3.468,
                                    6.696
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 619,
                                    "length": 2
                                }
                            },
                            {
                                "content": "במקור",
                                "polygon": [
                                    2.9905,
                                    6.505,
                                    3.4263,
                                    6.499,
                                    3.4322,
                                    6.696,
                                    2.9905,
                                    6.696
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 622,
                                    "length": 5
                                }
                            },
                            {
                                "content": "סה״כ",
                                "polygon": [
                                    3.6053,
                                    6.7258,
                                    3.9874,
                                    6.7258,
                                    3.9874,
                                    6.9108,
                                    3.6053,
                                    6.9048
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 628,
                                    "length": 4
                                }
                            },
                            {
                                "content": "ששולם",
                                "polygon": [
                                    3.1039,
                                    6.7318,
                                    3.5516,
                                    6.7258,
                                    3.5516,
                                    6.9048,
                                    3.1039,
                                    6.8989
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 633,
                                    "length": 5
                                }
                            },
                            {
                                "content": "8,850.00",
                                "polygon": [
                                    1.7907,
                                    6.7258,
                                    2.4593,
                                    6.7198,
                                    2.4533,
                                    6.9048,
                                    1.7907,
                                    6.9108
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 639,
                                    "length": 8
                                }
                            },
                            {
                                "content": "הופק",
                                "polygon": [
                                    6.0765,
                                    10.2707,
                                    6.2974,
                                    10.2707,
                                    6.3034,
                                    10.3901,
                                    6.0825,
                                    10.3901
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 648,
                                    "length": 4
                                }
                            },
                            {
                                "content": "ע״י",
                                "polygon": [
                                    5.8855,
                                    10.2648,
                                    6.0527,
                                    10.2707,
                                    6.0527,
                                    10.3901,
                                    5.8915,
                                    10.3901
                                ],
                                "confidence": 0.976,
                                "span": {
                                    "offset": 653,
                                    "length": 3
                                }
                            },
                            {
                                "content": "אשפית",
                                "polygon": [
                                    5.6289,
                                    10.2648,
                                    5.8617,
                                    10.2648,
                                    5.8676,
                                    10.3901,
                                    5.6348,
                                    10.3961
                                ],
                                "confidence": 0.977,
                                "span": {
                                    "offset": 657,
                                    "length": 5
                                }
                            },
                            {
                                "content": "של",
                                "polygon": [
                                    5.4617,
                                    10.2648,
                                    5.599,
                                    10.2648,
                                    5.605,
                                    10.3961,
                                    5.4617,
                                    10.3961
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 663,
                                    "length": 2
                                }
                            },
                            {
                                "content": "ט.מ.ל",
                                "polygon": [
                                    5.2051,
                                    10.2648,
                                    5.4319,
                                    10.2648,
                                    5.4379,
                                    10.3961,
                                    5.2051,
                                    10.3961
                                ],
                                "confidence": 0.954,
                                "span": {
                                    "offset": 666,
                                    "length": 5
                                }
                            },
                            {
                                "content": "בתאריך",
                                "polygon": [
                                    4.8768,
                                    10.2588,
                                    5.1752,
                                    10.2648,
                                    5.1812,
                                    10.3961,
                                    4.8827,
                                    10.3961
                                ],
                                "confidence": 0.978,
                                "span": {
                                    "offset": 672,
                                    "length": 6
                                }
                            },
                            {
                                "content": "25/08/2025",
                                "polygon": [
                                    4.3574,
                                    10.2588,
                                    4.8529,
                                    10.2588,
                                    4.8529,
                                    10.3961,
                                    4.3574,
                                    10.3961
                                ],
                                "confidence": 0.952,
                                "span": {
                                    "offset": 679,
                                    "length": 10
                                }
                            },
                            {
                                "content": "בשעה",
                                "polygon": [
                                    4.1067,
                                    10.2588,
                                    4.3276,
                                    10.2588,
                                    4.3336,
                                    10.3961,
                                    4.1067,
                                    10.3961
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 690,
                                    "length": 4
                                }
                            },
                            {
                                "content": "10:41:23",
                                "polygon": [
                                    3.671,
                                    10.2588,
                                    4.0829,
                                    10.2588,
                                    4.0829,
                                    10.3961,
                                    3.671,
                                    10.3961
                                ],
                                "confidence": 0.838,
                                "span": {
                                    "offset": 695,
                                    "length": 8
                                }
                            },
                            {
                                "content": "עפ״י",
                                "polygon": [
                                    3.4442,
                                    10.2588,
                                    3.6412,
                                    10.2588,
                                    3.6471,
                                    10.3961,
                                    3.4501,
                                    10.3961
                                ],
                                "confidence": 0.961,
                                "span": {
                                    "offset": 704,
                                    "length": 4
                                }
                            },
                            {
                                "content": "תעודת",
                                "polygon": [
                                    3.2054,
                                    10.2588,
                                    3.4203,
                                    10.2588,
                                    3.4263,
                                    10.3961,
                                    3.2114,
                                    10.3961
                                ],
                                "confidence": 0.977,
                                "span": {
                                    "offset": 709,
                                    "length": 5
                                }
                            },
                            {
                                "content": "רישום",
                                "polygon": [
                                    2.9308,
                                    10.2588,
                                    3.1815,
                                    10.2588,
                                    3.1815,
                                    10.3961,
                                    2.9368,
                                    10.3961
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 715,
                                    "length": 5
                                }
                            },
                            {
                                "content": "(מ״ה)",
                                "polygon": [
                                    2.6562,
                                    10.2648,
                                    2.907,
                                    10.2588,
                                    2.9129,
                                    10.3961,
                                    2.6622,
                                    10.3901
                                ],
                                "confidence": 0.887,
                                "span": {
                                    "offset": 721,
                                    "length": 5
                                }
                            },
                            {
                                "content": "מספר",
                                "polygon": [
                                    2.4294,
                                    10.2648,
                                    2.6324,
                                    10.2648,
                                    2.6383,
                                    10.3901,
                                    2.4294,
                                    10.3901
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 727,
                                    "length": 4
                                }
                            },
                            {
                                "content": "97509",
                                "polygon": [
                                    2.1548,
                                    10.2648,
                                    2.3996,
                                    10.2648,
                                    2.4055,
                                    10.3901,
                                    2.1548,
                                    10.3901
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 732,
                                    "length": 5
                                }
                            },
                            {
                                "content": "מסמך",
                                "polygon": [
                                    4.8768,
                                    10.3901,
                                    5.1334,
                                    10.3961,
                                    5.1334,
                                    10.5154,
                                    4.8708,
                                    10.5154
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 738,
                                    "length": 4
                                }
                            },
                            {
                                "content": "זה",
                                "polygon": [
                                    4.7633,
                                    10.3841,
                                    4.8529,
                                    10.3901,
                                    4.8469,
                                    10.5154,
                                    4.7574,
                                    10.5154
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 743,
                                    "length": 2
                                }
                            },
                            {
                                "content": "נחתם",
                                "polygon": [
                                    4.5186,
                                    10.3841,
                                    4.7395,
                                    10.3841,
                                    4.7335,
                                    10.5154,
                                    4.5186,
                                    10.5154
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 746,
                                    "length": 4
                                }
                            },
                            {
                                "content": "בחתימה",
                                "polygon": [
                                    4.1545,
                                    10.3841,
                                    4.4947,
                                    10.3841,
                                    4.4947,
                                    10.5154,
                                    4.1545,
                                    10.5154
                                ],
                                "confidence": 0.982,
                                "span": {
                                    "offset": 751,
                                    "length": 6
                                }
                            },
                            {
                                "content": "דיגיטלית",
                                "polygon": [
                                    3.7725,
                                    10.3901,
                                    4.1306,
                                    10.3841,
                                    4.1306,
                                    10.5154,
                                    3.7725,
                                    10.5094
                                ],
                                "confidence": 0.97,
                                "span": {
                                    "offset": 758,
                                    "length": 8
                                }
                            },
                            {
                                "content": "מאובטחת",
                                "polygon": [
                                    3.3546,
                                    10.3961,
                                    3.7486,
                                    10.3901,
                                    3.7486,
                                    10.5094,
                                    3.3546,
                                    10.5035
                                ],
                                "confidence": 0.98,
                                "span": {
                                    "offset": 767,
                                    "length": 7
                                }
                            }
                        ],
                        "lines": [
                            {
                                "content": "דרין, טרגל ושות' - רואי חשבון",
                                "polygon": [
                                    2.0295,
                                    0.4416,
                                    6.1959,
                                    0.4357,
                                    6.1959,
                                    0.7878,
                                    2.0295,
                                    0.7937
                                ],
                                "spans": [
                                    {
                                        "offset": 0,
                                        "length": 29
                                    }
                                ]
                            },
                            {
                                "content": "רח׳ המלאכה 8 ת.ד. 8642 א.ת. פולג נתניה",
                                "polygon": [
                                    4.4888,
                                    0.8116,
                                    7.8971,
                                    0.8116,
                                    7.8971,
                                    1.0205,
                                    4.4888,
                                    1.0265
                                ],
                                "spans": [
                                    {
                                        "offset": 30,
                                        "length": 38
                                    }
                                ]
                            },
                            {
                                "content": "טלפון: 073-2400700 פקס: 09-8628554",
                                "polygon": [
                                    4.5007,
                                    1.0444,
                                    7.8792,
                                    1.0444,
                                    7.8792,
                                    1.2652,
                                    4.5007,
                                    1.2592
                                ],
                                "spans": [
                                    {
                                        "offset": 69,
                                        "length": 34
                                    }
                                ]
                            },
                            {
                                "content": "עוסק מורשה 557149143",
                                "polygon": [
                                    0.394,
                                    1.2891,
                                    2.3399,
                                    1.3129,
                                    2.3399,
                                    1.5278,
                                    0.394,
                                    1.4979
                                ],
                                "spans": [
                                    {
                                        "offset": 104,
                                        "length": 20
                                    }
                                ]
                            },
                            {
                                "content": "מסמך ממוחשב",
                                "polygon": [
                                    1.2058,
                                    1.5994,
                                    2.2444,
                                    1.5994,
                                    2.2444,
                                    1.7784,
                                    1.2058,
                                    1.7784
                                ],
                                "spans": [
                                    {
                                        "offset": 125,
                                        "length": 11
                                    }
                                ]
                            },
                            {
                                "content": "חשבונית מס / קבלה מספר 052569",
                                "polygon": [
                                    2.4414,
                                    1.7784,
                                    5.9393,
                                    1.7904,
                                    5.9393,
                                    2.053,
                                    2.4414,
                                    2.035
                                ],
                                "spans": [
                                    {
                                        "offset": 137,
                                        "length": 29
                                    }
                                ]
                            },
                            {
                                "content": "לכבוד:",
                                "polygon": [
                                    7.2942,
                                    2.0947,
                                    7.7121,
                                    2.0888,
                                    7.718,
                                    2.2499,
                                    7.3002,
                                    2.2499
                                ],
                                "spans": [
                                    {
                                        "offset": 167,
                                        "length": 6
                                    }
                                ]
                            },
                            {
                                "content": "מקור",
                                "polygon": [
                                    1.8504,
                                    2.1663,
                                    2.3459,
                                    2.1723,
                                    2.3459,
                                    2.3872,
                                    1.8564,
                                    2.3872
                                ],
                                "spans": [
                                    {
                                        "offset": 174,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "content": "ט.פ.י פל ים בע״מ",
                                "polygon": [
                                    6.5302,
                                    2.3692,
                                    7.736,
                                    2.3692,
                                    7.736,
                                    2.5602,
                                    6.5302,
                                    2.5662
                                ],
                                "spans": [
                                    {
                                        "offset": 179,
                                        "length": 16
                                    }
                                ]
                            },
                            {
                                "content": "הקטיף 11 פארק תעשיות",
                                "polygon": [
                                    6.1362,
                                    2.596,
                                    7.724,
                                    2.602,
                                    7.724,
                                    2.793,
                                    6.1362,
                                    2.787
                                ],
                                "spans": [
                                    {
                                        "offset": 196,
                                        "length": 20
                                    }
                                ]
                            },
                            {
                                "content": "תאריך מסמך: 25/08/2025",
                                "polygon": [
                                    0.5014,
                                    2.4647,
                                    2.3399,
                                    2.4767,
                                    2.3339,
                                    2.6915,
                                    0.5014,
                                    2.6796
                                ],
                                "spans": [
                                    {
                                        "offset": 217,
                                        "length": 22
                                    }
                                ]
                            },
                            {
                                "content": "עמק חפר 3877701",
                                "polygon": [
                                    6.3571,
                                    2.8109,
                                    7.718,
                                    2.8228,
                                    7.718,
                                    3.0078,
                                    6.3571,
                                    2.9959
                                ],
                                "spans": [
                                    {
                                        "offset": 240,
                                        "length": 15
                                    }
                                ]
                            },
                            {
                                "content": "מספר לקוח: 260",
                                "polygon": [
                                    1.0685,
                                    2.7333,
                                    2.322,
                                    2.7333,
                                    2.322,
                                    2.9243,
                                    1.0685,
                                    2.9183
                                ],
                                "spans": [
                                    {
                                        "offset": 256,
                                        "length": 14
                                    }
                                ]
                            },
                            {
                                "content": "account@t-p-y.co.il",
                                "polygon": [
                                    6.3153,
                                    3.0257,
                                    7.7419,
                                    3.0257,
                                    7.7419,
                                    3.2346,
                                    6.3153,
                                    3.2346
                                ],
                                "spans": [
                                    {
                                        "offset": 271,
                                        "length": 19
                                    }
                                ]
                            },
                            {
                                "content": "מ. עוסק לקוח: 513327064",
                                "polygon": [
                                    0.5074,
                                    2.9302,
                                    2.3279,
                                    2.9481,
                                    2.3279,
                                    3.163,
                                    0.5074,
                                    3.1451
                                ],
                                "spans": [
                                    {
                                        "offset": 291,
                                        "length": 23
                                    }
                                ]
                            },
                            {
                                "content": "פרטי החשבונית",
                                "polygon": [
                                    6.2735,
                                    3.6046,
                                    7.348,
                                    3.6046,
                                    7.348,
                                    3.7717,
                                    6.2735,
                                    3.7717
                                ],
                                "spans": [
                                    {
                                        "offset": 315,
                                        "length": 13
                                    }
                                ]
                            },
                            {
                                "content": "תאור",
                                "polygon": [
                                    6.9421,
                                    3.8672,
                                    7.3062,
                                    3.8672,
                                    7.3062,
                                    4.0044,
                                    6.9421,
                                    4.0104
                                ],
                                "spans": [
                                    {
                                        "offset": 329,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "content": "כמות",
                                "polygon": [
                                    4.4828,
                                    3.8732,
                                    4.8409,
                                    3.8791,
                                    4.8409,
                                    4.0044,
                                    4.4828,
                                    4.0044
                                ],
                                "spans": [
                                    {
                                        "offset": 334,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "content": "מחיר ב $",
                                "polygon": [
                                    3.5337,
                                    3.8433,
                                    4.1784,
                                    3.8493,
                                    4.1784,
                                    4.0224,
                                    3.5337,
                                    4.0164
                                ],
                                "spans": [
                                    {
                                        "offset": 339,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "מחיר בש״ח אחוז הנחה",
                                "polygon": [
                                    1.6893,
                                    3.8553,
                                    3.2651,
                                    3.8493,
                                    3.2651,
                                    4.0164,
                                    1.6893,
                                    4.0224
                                ],
                                "spans": [
                                    {
                                        "offset": 348,
                                        "length": 19
                                    }
                                ]
                            },
                            {
                                "content": "סה״כ בש״ח",
                                "polygon": [
                                    0.573,
                                    3.8493,
                                    1.3968,
                                    3.8553,
                                    1.3968,
                                    4.0164,
                                    0.573,
                                    4.0044
                                ],
                                "spans": [
                                    {
                                        "offset": 368,
                                        "length": 9
                                    }
                                ]
                            },
                            {
                                "content": "2025 ריטיינר יולי",
                                "polygon": [
                                    6.3452,
                                    4.0761,
                                    7.2823,
                                    4.0761,
                                    7.2823,
                                    4.2253,
                                    6.3452,
                                    4.2253
                                ],
                                "spans": [
                                    {
                                        "offset": 378,
                                        "length": 17
                                    }
                                ]
                            },
                            {
                                "content": "1",
                                "polygon": [
                                    4.7812,
                                    4.094,
                                    4.835,
                                    4.088,
                                    4.835,
                                    4.1954,
                                    4.7812,
                                    4.1954
                                ],
                                "spans": [
                                    {
                                        "offset": 396,
                                        "length": 1
                                    }
                                ]
                            },
                            {
                                "content": "0.00",
                                "polygon": [
                                    3.8501,
                                    4.088,
                                    4.1485,
                                    4.082,
                                    4.1545,
                                    4.2193,
                                    3.856,
                                    4.2133
                                ],
                                "spans": [
                                    {
                                        "offset": 398,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "content": "7,500.00",
                                "polygon": [
                                    2.704,
                                    4.0761,
                                    3.2651,
                                    4.0761,
                                    3.2651,
                                    4.2253,
                                    2.704,
                                    4.2253
                                ],
                                "spans": [
                                    {
                                        "offset": 403,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "7,500.00",
                                "polygon": [
                                    0.8536,
                                    4.082,
                                    1.4027,
                                    4.082,
                                    1.4027,
                                    4.2312,
                                    0.8536,
                                    4.2312
                                ],
                                "spans": [
                                    {
                                        "offset": 412,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "הנחה/תוספת עיגול",
                                "polygon": [
                                    1.8624,
                                    4.3387,
                                    3.1517,
                                    4.3387,
                                    3.1517,
                                    4.5237,
                                    1.8624,
                                    4.5237
                                ],
                                "spans": [
                                    {
                                        "offset": 421,
                                        "length": 16
                                    }
                                ]
                            },
                            {
                                "content": "0.00",
                                "polygon": [
                                    1.0923,
                                    4.3446,
                                    1.4206,
                                    4.3446,
                                    1.4206,
                                    4.4998,
                                    1.0983,
                                    4.4998
                                ],
                                "spans": [
                                    {
                                        "offset": 438,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "content": "סה״כ לפני מע״מ",
                                "polygon": [
                                    1.9996,
                                    4.5714,
                                    3.1457,
                                    4.5654,
                                    3.1457,
                                    4.7445,
                                    1.9996,
                                    4.7504
                                ],
                                "spans": [
                                    {
                                        "offset": 443,
                                        "length": 14
                                    }
                                ]
                            },
                            {
                                "content": "7,500.00",
                                "polygon": [
                                    0.8178,
                                    4.5654,
                                    1.4147,
                                    4.5595,
                                    1.4147,
                                    4.7266,
                                    0.8178,
                                    4.7325
                                ],
                                "spans": [
                                    {
                                        "offset": 458,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "% 18 מע״מ",
                                "polygon": [
                                    2.3041,
                                    4.7982,
                                    3.1338,
                                    4.7862,
                                    3.1338,
                                    4.9653,
                                    2.3041,
                                    4.9772
                                ],
                                "spans": [
                                    {
                                        "offset": 467,
                                        "length": 9
                                    }
                                ]
                            },
                            {
                                "content": "1,350.00",
                                "polygon": [
                                    0.8178,
                                    4.7862,
                                    1.4087,
                                    4.7862,
                                    1.4087,
                                    4.9533,
                                    0.8178,
                                    4.9474
                                ],
                                "spans": [
                                    {
                                        "offset": 477,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "סה״כ כולל מע״מ",
                                "polygon": [
                                    1.9877,
                                    5.013,
                                    3.1397,
                                    5.013,
                                    3.1397,
                                    5.1921,
                                    1.9877,
                                    5.1921
                                ],
                                "spans": [
                                    {
                                        "offset": 486,
                                        "length": 14
                                    }
                                ]
                            },
                            {
                                "content": "8,850.00",
                                "polygon": [
                                    0.8058,
                                    5.013,
                                    1.4206,
                                    5.013,
                                    1.4206,
                                    5.1801,
                                    0.8058,
                                    5.1801
                                ],
                                "spans": [
                                    {
                                        "offset": 501,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "פרטי התקבולים",
                                "polygon": [
                                    6.1482,
                                    5.6934,
                                    7.2405,
                                    5.6934,
                                    7.2405,
                                    5.8963,
                                    6.1482,
                                    5.8963
                                ],
                                "spans": [
                                    {
                                        "offset": 510,
                                        "length": 13
                                    }
                                ]
                            },
                            {
                                "content": "אופן תשלום",
                                "polygon": [
                                    6.3392,
                                    5.9619,
                                    7.1629,
                                    5.9619,
                                    7.1629,
                                    6.141,
                                    6.3392,
                                    6.135
                                ],
                                "spans": [
                                    {
                                        "offset": 524,
                                        "length": 10
                                    }
                                ]
                            },
                            {
                                "content": "מספר",
                                "polygon": [
                                    5.4916,
                                    5.9798,
                                    5.9213,
                                    5.9798,
                                    5.9213,
                                    6.1171,
                                    5.4916,
                                    6.1171
                                ],
                                "spans": [
                                    {
                                        "offset": 535,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "content": "בנק",
                                "polygon": [
                                    4.6559,
                                    5.9798,
                                    4.9424,
                                    5.9738,
                                    4.9484,
                                    6.129,
                                    4.6559,
                                    6.135
                                ],
                                "spans": [
                                    {
                                        "offset": 540,
                                        "length": 3
                                    }
                                ]
                            },
                            {
                                "content": "סניף חשבון",
                                "polygon": [
                                    3.8202,
                                    5.9679,
                                    4.5843,
                                    5.9679,
                                    4.5843,
                                    6.141,
                                    3.8202,
                                    6.141
                                ],
                                "spans": [
                                    {
                                        "offset": 544,
                                        "length": 10
                                    }
                                ]
                            },
                            {
                                "content": "תאריך פרעון",
                                "polygon": [
                                    2.4772,
                                    5.9679,
                                    3.3248,
                                    5.9619,
                                    3.3248,
                                    6.135,
                                    2.4772,
                                    6.141
                                ],
                                "spans": [
                                    {
                                        "offset": 555,
                                        "length": 11
                                    }
                                ]
                            },
                            {
                                "content": "סכום",
                                "polygon": [
                                    2.0534,
                                    5.9798,
                                    2.4175,
                                    5.9798,
                                    2.4175,
                                    6.129,
                                    2.0593,
                                    6.123
                                ],
                                "spans": [
                                    {
                                        "offset": 567,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "content": "העברה",
                                "polygon": [
                                    6.7093,
                                    6.2006,
                                    7.1271,
                                    6.2006,
                                    7.1271,
                                    6.3439,
                                    6.7093,
                                    6.3439
                                ],
                                "spans": [
                                    {
                                        "offset": 572,
                                        "length": 5
                                    }
                                ]
                            },
                            {
                                "content": "10",
                                "polygon": [
                                    4.7872,
                                    6.2006,
                                    4.9364,
                                    6.1947,
                                    4.9364,
                                    6.32,
                                    4.7932,
                                    6.32
                                ],
                                "spans": [
                                    {
                                        "offset": 578,
                                        "length": 2
                                    }
                                ]
                            },
                            {
                                "content": "744",
                                "polygon": [
                                    4.3574,
                                    6.2006,
                                    4.5902,
                                    6.1947,
                                    4.5843,
                                    6.326,
                                    4.3574,
                                    6.326
                                ],
                                "spans": [
                                    {
                                        "offset": 581,
                                        "length": 3
                                    }
                                ]
                            },
                            {
                                "content": "2230018",
                                "polygon": [
                                    3.6949,
                                    6.1887,
                                    4.2321,
                                    6.1887,
                                    4.2321,
                                    6.3319,
                                    3.6949,
                                    6.326
                                ],
                                "spans": [
                                    {
                                        "offset": 585,
                                        "length": 7
                                    }
                                ]
                            },
                            {
                                "content": "24/08/2025",
                                "polygon": [
                                    2.6264,
                                    6.1887,
                                    3.3188,
                                    6.1827,
                                    3.3188,
                                    6.3319,
                                    2.6264,
                                    6.3319
                                ],
                                "spans": [
                                    {
                                        "offset": 593,
                                        "length": 10
                                    }
                                ]
                            },
                            {
                                "content": "8,850.00",
                                "polygon": [
                                    1.8862,
                                    6.1887,
                                    2.4354,
                                    6.1887,
                                    2.4354,
                                    6.3319,
                                    1.8862,
                                    6.3319
                                ],
                                "spans": [
                                    {
                                        "offset": 604,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "ניכוי מס במקור",
                                "polygon": [
                                    2.9905,
                                    6.499,
                                    3.9874,
                                    6.4931,
                                    3.9874,
                                    6.69,
                                    2.9905,
                                    6.69
                                ],
                                "spans": [
                                    {
                                        "offset": 613,
                                        "length": 14
                                    }
                                ]
                            },
                            {
                                "content": "סה״כ ששולם",
                                "polygon": [
                                    3.0801,
                                    6.7258,
                                    3.9814,
                                    6.7258,
                                    3.9814,
                                    6.9048,
                                    3.0801,
                                    6.8989
                                ],
                                "spans": [
                                    {
                                        "offset": 628,
                                        "length": 10
                                    }
                                ]
                            },
                            {
                                "content": "8,850.00",
                                "polygon": [
                                    1.7848,
                                    6.7198,
                                    2.4652,
                                    6.7198,
                                    2.4652,
                                    6.8989,
                                    1.7907,
                                    6.9048
                                ],
                                "spans": [
                                    {
                                        "offset": 639,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "content": "הופק ע״י אשפית של ט.מ.ל בתאריך 25/08/2025 בשעה 10:41:23 עפ״י תעודת רישום (מ״ה) מספר 97509",
                                "polygon": [
                                    2.1489,
                                    10.2588,
                                    6.3034,
                                    10.2588,
                                    6.3034,
                                    10.3901,
                                    2.1489,
                                    10.3901
                                ],
                                "spans": [
                                    {
                                        "offset": 648,
                                        "length": 89
                                    }
                                ]
                            },
                            {
                                "content": "מסמך זה נחתם בחתימה דיגיטלית מאובטחת",
                                "polygon": [
                                    3.3248,
                                    10.3781,
                                    5.1454,
                                    10.3841,
                                    5.1394,
                                    10.5094,
                                    3.3248,
                                    10.5094
                                ],
                                "spans": [
                                    {
                                        "offset": 738,
                                        "length": 36
                                    }
                                ]
                            }
                        ],
                        "spans": [
                            {
                                "offset": 0,
                                "length": 774
                            }
                        ]
                    }
                ]
            },
            {
                "name": "tables",
                "value": [
                    {
                        "rowCount": 2,
                        "columnCount": 6,
                        "cells": [
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 0,
                                "content": "סה״כ בש״ח",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.4439,
                                            3.8266,
                                            1.5508,
                                            3.8266,
                                            1.5508,
                                            4.0558,
                                            0.4439,
                                            4.0558
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 368,
                                        "length": 9
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 1,
                                "content": "אחוז הנחה",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            1.5508,
                                            3.8266,
                                            2.4564,
                                            3.8266,
                                            2.4564,
                                            4.0558,
                                            1.5508,
                                            4.0558
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 358,
                                        "length": 9
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 2,
                                "content": "מחיר בש״ח",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            2.4564,
                                            3.8266,
                                            3.4123,
                                            3.8266,
                                            3.4123,
                                            4.0558,
                                            2.4564,
                                            4.0558
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 348,
                                        "length": 9
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 3,
                                "content": "מחיר ב $",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            3.4123,
                                            3.8266,
                                            4.3323,
                                            3.8266,
                                            4.3323,
                                            4.0558,
                                            3.4123,
                                            4.0558
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 339,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 4,
                                "content": "כמות",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            4.3323,
                                            3.8266,
                                            5.5254,
                                            3.8266,
                                            5.5254,
                                            4.0558,
                                            4.3323,
                                            4.0558
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 334,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 5,
                                "content": "תאור",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            5.5254,
                                            3.8266,
                                            7.3726,
                                            3.8266,
                                            7.3726,
                                            4.0558,
                                            5.5254,
                                            4.0558
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 329,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 0,
                                "content": "7,500.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.4439,
                                            4.0558,
                                            1.5508,
                                            4.0558,
                                            1.5508,
                                            4.242,
                                            0.4439,
                                            4.242
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 412,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 1,
                                "content": "",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            1.5508,
                                            4.0558,
                                            2.4564,
                                            4.0558,
                                            2.4564,
                                            4.242,
                                            1.5508,
                                            4.242
                                        ]
                                    }
                                ],
                                "spans": []
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 2,
                                "content": "7,500.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            2.4564,
                                            4.0558,
                                            3.4123,
                                            4.0558,
                                            3.4123,
                                            4.242,
                                            2.4564,
                                            4.242
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 403,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 3,
                                "content": "0.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            3.4123,
                                            4.0558,
                                            4.3323,
                                            4.0558,
                                            4.3323,
                                            4.242,
                                            3.4123,
                                            4.242
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 398,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 4,
                                "content": "1",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            4.3323,
                                            4.0558,
                                            5.5254,
                                            4.0558,
                                            5.5326,
                                            4.242,
                                            4.3323,
                                            4.242
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 396,
                                        "length": 1
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 5,
                                "content": "2025 ריטיינר יולי",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            5.5254,
                                            4.0558,
                                            7.3726,
                                            4.0558,
                                            7.3726,
                                            4.242,
                                            5.5326,
                                            4.242
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 378,
                                        "length": 17
                                    }
                                ]
                            }
                        ],
                        "boundingRegions": [
                            {
                                "pageNumber": 1,
                                "polygon": [
                                    0.3969,
                                    3.8246,
                                    7.3737,
                                    3.8177,
                                    7.3726,
                                    4.2484,
                                    0.3955,
                                    4.2557
                                ]
                            }
                        ],
                        "spans": [
                            {
                                "offset": 368,
                                "length": 9
                            },
                            {
                                "offset": 358,
                                "length": 9
                            },
                            {
                                "offset": 348,
                                "length": 9
                            },
                            {
                                "offset": 339,
                                "length": 8
                            },
                            {
                                "offset": 334,
                                "length": 4
                            },
                            {
                                "offset": 329,
                                "length": 4
                            },
                            {
                                "offset": 412,
                                "length": 8
                            },
                            {
                                "offset": 403,
                                "length": 8
                            },
                            {
                                "offset": 398,
                                "length": 4
                            },
                            {
                                "offset": 396,
                                "length": 1
                            },
                            {
                                "offset": 378,
                                "length": 17
                            }
                        ]
                    },
                    {
                        "rowCount": 2,
                        "columnCount": 7,
                        "cells": [
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 0,
                                "content": "סכום",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            1.6073,
                                            5.9236,
                                            2.4637,
                                            5.9236,
                                            2.4637,
                                            6.1658,
                                            1.6073,
                                            6.1658
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 567,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 1,
                                "content": "תאריך פרעון",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            2.4637,
                                            5.9236,
                                            3.5145,
                                            5.9296,
                                            3.5145,
                                            6.1658,
                                            2.4637,
                                            6.1658
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 555,
                                        "length": 11
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 2,
                                "content": "חשבון",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            3.5145,
                                            5.9296,
                                            4.2373,
                                            5.9236,
                                            4.2373,
                                            6.1658,
                                            3.5145,
                                            6.1658
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 549,
                                        "length": 5
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 3,
                                "content": "סניף",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            4.2373,
                                            5.9236,
                                            4.6261,
                                            5.9236,
                                            4.6261,
                                            6.1658,
                                            4.2373,
                                            6.1658
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 544,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 4,
                                "content": "בנק",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            4.6261,
                                            5.9236,
                                            5.2335,
                                            5.9236,
                                            5.2335,
                                            6.1658,
                                            4.6261,
                                            6.1658
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 540,
                                        "length": 3
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 5,
                                "content": "מספר",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            5.2335,
                                            5.9236,
                                            6.1264,
                                            5.9236,
                                            6.1264,
                                            6.1658,
                                            5.2335,
                                            6.1658
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 535,
                                        "length": 4
                                    }
                                ]
                            },
                            {
                                "kind": "columnHeader",
                                "rowIndex": 0,
                                "columnIndex": 6,
                                "content": "אופן תשלום",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            6.1264,
                                            5.9236,
                                            7.2379,
                                            5.9236,
                                            7.2379,
                                            6.1658,
                                            6.1264,
                                            6.1658
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 524,
                                        "length": 10
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 0,
                                "content": "8,850.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            1.6073,
                                            6.1658,
                                            2.4637,
                                            6.1658,
                                            2.4637,
                                            6.3536,
                                            1.6073,
                                            6.3536
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 604,
                                        "length": 8
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 1,
                                "content": "24/08/2025",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            2.4637,
                                            6.1658,
                                            3.5145,
                                            6.1658,
                                            3.5145,
                                            6.3536,
                                            2.4637,
                                            6.3536
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 593,
                                        "length": 10
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 2,
                                "content": "2230018",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            3.5145,
                                            6.1658,
                                            4.2373,
                                            6.1658,
                                            4.2373,
                                            6.3536,
                                            3.5145,
                                            6.3536
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 585,
                                        "length": 7
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 3,
                                "content": "744",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            4.2373,
                                            6.1658,
                                            4.6261,
                                            6.1658,
                                            4.6261,
                                            6.3536,
                                            4.2373,
                                            6.3536
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 581,
                                        "length": 3
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 4,
                                "content": "10",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            4.6261,
                                            6.1658,
                                            5.2335,
                                            6.1658,
                                            5.2335,
                                            6.3536,
                                            4.6261,
                                            6.3536
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 578,
                                        "length": 2
                                    }
                                ]
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 5,
                                "content": "",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            5.2335,
                                            6.1658,
                                            6.1264,
                                            6.1658,
                                            6.1264,
                                            6.3536,
                                            5.2335,
                                            6.3536
                                        ]
                                    }
                                ],
                                "spans": []
                            },
                            {
                                "rowIndex": 1,
                                "columnIndex": 6,
                                "content": "העברה",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            6.1264,
                                            6.1658,
                                            7.2379,
                                            6.1658,
                                            7.2379,
                                            6.3536,
                                            6.1264,
                                            6.3536
                                        ]
                                    }
                                ],
                                "spans": [
                                    {
                                        "offset": 572,
                                        "length": 5
                                    }
                                ]
                            }
                        ],
                        "boundingRegions": [
                            {
                                "pageNumber": 1,
                                "polygon": [
                                    1.4124,
                                    5.93,
                                    7.2478,
                                    5.928,
                                    7.2485,
                                    6.3598,
                                    1.4129,
                                    6.3621
                                ]
                            }
                        ],
                        "spans": [
                            {
                                "offset": 567,
                                "length": 4
                            },
                            {
                                "offset": 555,
                                "length": 11
                            },
                            {
                                "offset": 549,
                                "length": 5
                            },
                            {
                                "offset": 544,
                                "length": 4
                            },
                            {
                                "offset": 540,
                                "length": 3
                            },
                            {
                                "offset": 535,
                                "length": 4
                            },
                            {
                                "offset": 524,
                                "length": 10
                            },
                            {
                                "offset": 604,
                                "length": 8
                            },
                            {
                                "offset": 593,
                                "length": 10
                            },
                            {
                                "offset": 585,
                                "length": 7
                            },
                            {
                                "offset": 581,
                                "length": 3
                            },
                            {
                                "offset": 578,
                                "length": 2
                            },
                            {
                                "offset": 572,
                                "length": 5
                            }
                        ]
                    }
                ]
            },
            {
                "name": "documents",
                "value": [
                    {
                        "docType": "invoice",
                        "boundingRegions": [
                            {
                                "pageNumber": 1,
                                "polygon": [
                                    0,
                                    0,
                                    10.625,
                                    0,
                                    10.625,
                                    13.75,
                                    0,
                                    13.75
                                ]
                            }
                        ],
                        "fields": {
                            "AmountDue": {
                                "type": "currency",
                                "valueCurrency": {
                                    "amount": 8850,
                                    "currencyCode": "ILS"
                                },
                                "content": "8,850.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            1.7907,
                                            6.7258,
                                            2.4593,
                                            6.7198,
                                            2.4533,
                                            6.9048,
                                            1.7907,
                                            6.9108
                                        ]
                                    }
                                ],
                                "confidence": 0.308,
                                "spans": [
                                    {
                                        "offset": 639,
                                        "length": 8
                                    }
                                ]
                            },
                            "CustomerAddress": {
                                "type": "address",
                                "content": "הקטיף 11 פארק תעשיות",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            6.178,
                                            2.5971,
                                            7.7193,
                                            2.608,
                                            7.718,
                                            2.8038,
                                            6.1767,
                                            2.7929
                                        ]
                                    }
                                ],
                                "confidence": 0.915,
                                "spans": [
                                    {
                                        "offset": 196,
                                        "length": 20
                                    }
                                ],
                                "valueAddress": {
                                    "houseNumber": "11",
                                    "road": "הקטיף",
                                    "streetAddress": "11 הקטיף",
                                    "house": "פארק תעשיות"
                                }
                            },
                            "CustomerAddressRecipient": {
                                "type": "string",
                                "valueString": "ט.פ.י פל ים בע״מ",
                                "content": "ט.פ.י פל ים בע״מ",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            6.572,
                                            2.3692,
                                            7.7419,
                                            2.3692,
                                            7.7419,
                                            2.5722,
                                            6.572,
                                            2.5722
                                        ]
                                    }
                                ],
                                "confidence": 0.891,
                                "spans": [
                                    {
                                        "offset": 179,
                                        "length": 16
                                    }
                                ]
                            },
                            "CustomerName": {
                                "type": "string",
                                "valueString": "ט.פ.י פל ים בע״מ",
                                "content": "ט.פ.י פל ים בע״מ",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            6.572,
                                            2.3692,
                                            7.7419,
                                            2.3692,
                                            7.7419,
                                            2.5722,
                                            6.572,
                                            2.5722
                                        ]
                                    }
                                ],
                                "confidence": 0.891,
                                "spans": [
                                    {
                                        "offset": 179,
                                        "length": 16
                                    }
                                ]
                            },
                            "CustomerTaxId": {
                                "type": "string",
                                "valueString": "513327064",
                                "content": "513327064",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.5133,
                                            2.9362,
                                            1.3729,
                                            2.9481,
                                            1.3669,
                                            3.151,
                                            0.5074,
                                            3.151
                                        ]
                                    }
                                ],
                                "confidence": 0.799,
                                "spans": [
                                    {
                                        "offset": 305,
                                        "length": 9
                                    }
                                ]
                            },
                            "InvoiceDate": {
                                "type": "date",
                                "valueDate": "2025-08-25",
                                "content": "25/08/2025",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.5074,
                                            2.4707,
                                            1.361,
                                            2.4826,
                                            1.361,
                                            2.6915,
                                            0.5074,
                                            2.6736
                                        ]
                                    }
                                ],
                                "confidence": 0.957,
                                "spans": [
                                    {
                                        "offset": 229,
                                        "length": 10
                                    }
                                ]
                            },
                            "InvoiceId": {
                                "type": "string",
                                "valueString": "052569",
                                "content": "052569",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            2.4414,
                                            1.7844,
                                            3.2711,
                                            1.7844,
                                            3.277,
                                            2.041,
                                            2.4473,
                                            2.0171
                                        ]
                                    }
                                ],
                                "confidence": 0.95,
                                "spans": [
                                    {
                                        "offset": 160,
                                        "length": 6
                                    }
                                ]
                            },
                            "InvoiceTotal": {
                                "type": "currency",
                                "valueCurrency": {
                                    "amount": 8850,
                                    "currencyCode": "ILS"
                                },
                                "content": "8,850.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.8058,
                                            5.019,
                                            1.4147,
                                            5.013,
                                            1.4147,
                                            5.1861,
                                            0.8118,
                                            5.1861
                                        ]
                                    }
                                ],
                                "confidence": 0.948,
                                "spans": [
                                    {
                                        "offset": 501,
                                        "length": 8
                                    }
                                ]
                            },
                            "Items": {
                                "type": "array",
                                "valueArray": [
                                    {
                                        "type": "object",
                                        "valueObject": {
                                            "Amount": {
                                                "type": "currency",
                                                "valueCurrency": {
                                                    "amount": 7500,
                                                    "currencyCode": "ILS"
                                                },
                                                "content": "7,500.00",
                                                "boundingRegions": [
                                                    {
                                                        "pageNumber": 1,
                                                        "polygon": [
                                                            0.8536,
                                                            4.082,
                                                            1.4027,
                                                            4.082,
                                                            1.4027,
                                                            4.2312,
                                                            0.8596,
                                                            4.2312
                                                        ]
                                                    }
                                                ],
                                                "confidence": 0.897,
                                                "spans": [
                                                    {
                                                        "offset": 412,
                                                        "length": 8
                                                    }
                                                ]
                                            },
                                            "Description": {
                                                "type": "string",
                                                "valueString": "2025 ריטיינר יולי",
                                                "content": "2025 ריטיינר יולי",
                                                "boundingRegions": [
                                                    {
                                                        "pageNumber": 1,
                                                        "polygon": [
                                                            6.3511,
                                                            4.082,
                                                            7.2763,
                                                            4.082,
                                                            7.2763,
                                                            4.2312,
                                                            6.3511,
                                                            4.2312
                                                        ]
                                                    }
                                                ],
                                                "confidence": 0.916,
                                                "spans": [
                                                    {
                                                        "offset": 378,
                                                        "length": 17
                                                    }
                                                ]
                                            },
                                            "Quantity": {
                                                "type": "number",
                                                "valueNumber": 1,
                                                "content": "1",
                                                "boundingRegions": [
                                                    {
                                                        "pageNumber": 1,
                                                        "polygon": [
                                                            4.7872,
                                                            4.088,
                                                            4.835,
                                                            4.088,
                                                            4.8409,
                                                            4.1895,
                                                            4.7932,
                                                            4.1954
                                                        ]
                                                    }
                                                ],
                                                "confidence": 0.887,
                                                "spans": [
                                                    {
                                                        "offset": 396,
                                                        "length": 1
                                                    }
                                                ]
                                            },
                                            "UnitPrice": {
                                                "type": "currency",
                                                "valueCurrency": {
                                                    "amount": 7500,
                                                    "currencyCode": "ILS"
                                                },
                                                "content": "7,500.00",
                                                "boundingRegions": [
                                                    {
                                                        "pageNumber": 1,
                                                        "polygon": [
                                                            2.71,
                                                            4.082,
                                                            3.2591,
                                                            4.0761,
                                                            3.2532,
                                                            4.2312,
                                                            2.71,
                                                            4.2253
                                                        ]
                                                    }
                                                ],
                                                "confidence": 0.852,
                                                "spans": [
                                                    {
                                                        "offset": 403,
                                                        "length": 8
                                                    }
                                                ]
                                            }
                                        },
                                        "content": "2025 ריטיינר יולי\n1\n0.00\n7,500.00\n7,500.00",
                                        "boundingRegions": [
                                            {
                                                "pageNumber": 1,
                                                "polygon": [
                                                    0.8536,
                                                    4.0761,
                                                    7.2763,
                                                    4.0761,
                                                    7.2763,
                                                    4.2312,
                                                    0.8536,
                                                    4.2312
                                                ]
                                            }
                                        ],
                                        "confidence": 0.852,
                                        "spans": [
                                            {
                                                "offset": 378,
                                                "length": 42
                                            }
                                        ]
                                    }
                                ]
                            },
                            "SubTotal": {
                                "type": "currency",
                                "valueCurrency": {
                                    "amount": 7500,
                                    "currencyCode": "ILS"
                                },
                                "content": "7,500.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.8237,
                                            4.5774,
                                            1.4147,
                                            4.5654,
                                            1.4147,
                                            4.7325,
                                            0.8237,
                                            4.7325
                                        ]
                                    }
                                ],
                                "confidence": 0.95,
                                "spans": [
                                    {
                                        "offset": 458,
                                        "length": 8
                                    }
                                ]
                            },
                            "TotalDiscount": {
                                "type": "currency",
                                "valueCurrency": {
                                    "amount": 0,
                                    "currencyCode": "ILS"
                                },
                                "content": "0.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            1.1103,
                                            4.3446,
                                            1.4147,
                                            4.3446,
                                            1.4147,
                                            4.4998,
                                            1.1103,
                                            4.4998
                                        ]
                                    }
                                ],
                                "confidence": 0.552,
                                "spans": [
                                    {
                                        "offset": 438,
                                        "length": 4
                                    }
                                ]
                            },
                            "TotalTax": {
                                "type": "currency",
                                "valueCurrency": {
                                    "amount": 1350,
                                    "currencyCode": "ILS"
                                },
                                "content": "1,350.00",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.8237,
                                            4.7982,
                                            1.4087,
                                            4.7922,
                                            1.4147,
                                            4.9533,
                                            0.8297,
                                            4.9474
                                        ]
                                    }
                                ],
                                "confidence": 0.956,
                                "spans": [
                                    {
                                        "offset": 477,
                                        "length": 8
                                    }
                                ]
                            },
                            "VendorAddress": {
                                "type": "address",
                                "content": "רח׳ המלאכה 8 ת.ד. 8642 א.ת. פולג נתניה",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            4.5305,
                                            0.8116,
                                            7.8971,
                                            0.8116,
                                            7.8971,
                                            1.0265,
                                            4.5305,
                                            1.0265
                                        ]
                                    }
                                ],
                                "confidence": 0.885,
                                "spans": [
                                    {
                                        "offset": 30,
                                        "length": 38
                                    }
                                ],
                                "valueAddress": {
                                    "houseNumber": "8",
                                    "road": "רח׳ המלאכה",
                                    "poBox": "ת.ד. 8642",
                                    "city": "נתניה",
                                    "streetAddress": "8 רח׳ המלאכה ת.ד. 8642",
                                    "house": "א.ת. פולג"
                                }
                            },
                            "VendorAddressRecipient": {
                                "type": "string",
                                "valueString": "דרין, טרגל ושות' - רואי חשבון",
                                "content": "דרין, טרגל ושות' - רואי חשבון",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            2.0355,
                                            0.4416,
                                            6.1959,
                                            0.4416,
                                            6.1959,
                                            0.7937,
                                            2.0355,
                                            0.7937
                                        ]
                                    }
                                ],
                                "confidence": 0.734,
                                "spans": [
                                    {
                                        "offset": 0,
                                        "length": 29
                                    }
                                ]
                            },
                            "VendorName": {
                                "type": "string",
                                "valueString": "דרין, טרגל ושות' - רואי חשבון",
                                "content": "דרין, טרגל ושות' - רואי חשבון",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            2.0355,
                                            0.4416,
                                            6.1959,
                                            0.4416,
                                            6.1959,
                                            0.7937,
                                            2.0355,
                                            0.7937
                                        ]
                                    }
                                ],
                                "confidence": 0.734,
                                "spans": [
                                    {
                                        "offset": 0,
                                        "length": 29
                                    }
                                ]
                            },
                            "VendorTaxId": {
                                "type": "string",
                                "valueString": "557149143",
                                "content": "557149143",
                                "boundingRegions": [
                                    {
                                        "pageNumber": 1,
                                        "polygon": [
                                            0.3999,
                                            1.2891,
                                            1.1759,
                                            1.301,
                                            1.1759,
                                            1.5158,
                                            0.3999,
                                            1.4979
                                        ]
                                    }
                                ],
                                "confidence": 0.561,
                                "spans": [
                                    {
                                        "offset": 115,
                                        "length": 9
                                    }
                                ]
                            }
                        },
                        "confidence": 1,
                        "spans": [
                            {
                                "offset": 0,
                                "length": 774
                            }
                        ]
                    }
                ]
            }
        ],
        "language": "javascript",
        "inputFormat": "string",
        "dependencies": [],
        "codeStringJavascript": "// ================================================================\n// Azure Invoice Processor v2.23 - EXPANDED STRUCTURE: vendor mapping\n// עודכן: 13 נובמבר 2025 (FIX #2)\n// ================================================================\n// שינויים ב-v2.23:\n// 🎯 EXPANDED STRUCTURE: מבנה מורחב לזיהוי ספק עתידי\n//\n//    מטרה: שיפור מערכת המיפוי לזיהוי ספקים חדשים\n//\n//    שיפורים:\n//    1. ✅ מילון תרגום מורחב עברית-אנגלית\n//       - פונקציה: getHeaderTranslationMap()\n//       - מיפוי מלא: שורה→LineNumber, הזמנתכם→CustomerOrder, וכו'\n//       - 10 שדות סטנדרטיים עם תרגומים דו-לשוניים\n//\n//    2. ✅ guessFieldNameGeneric() מחזיר אובייקט מורחב\n//       - לפני: מחזיר רק string (שם השדה)\n//       - עכשיו: { fieldName, originalHeader, isUnknown }\n//       - שמירת הכותרת המקורית מהמסמך\n//\n//    3. ✅ extractRealItemsFromTable() - מחזיר items + columnMap\n//       - לפני: מחזיר רק מערך פריטים\n//       - עכשיו: { items: [], columnMap: {} }\n//       - columnMap שומר originalHeader לכל עמודה\n//       - 🔧 FIX: תמיד מנתח טבלה תחילה (לא מדלג על ניתוח!)\n//\n//    4. ✅ buildItemsStructure() - structure מורחב\n//       - לפני: ProductCode: \"string\"\n//       - עכשיו: ProductCode: { type: \"string\", originalHeader: \"מק\\\"ט\" }\n//       - מאפשר זיהוי ספק עתידי לפי הכותרות המקוריות\n//       - 🔧 FIX: buildAzureFieldToHeaderMap() למיפוי שדות Azure\n//\n//    5. ✅ שמירת עמודות לא מזוהות\n//       - עמודות שלא מזוהו ← UnknownColumn_N\n//       - שומר originalHeader גם לעמודות לא ידועות\n//       - אף מידע לא נזרק!\n//\n//    6. ✅ isRealItemRow() - תמיכה ב-TotalPrice\n//       - תמיכה בשמות שדות חדשים (TotalPrice) וישנים (Amount)\n//       - מזהה שורות תקינות עם TotalPrice במקום Amount\n//\n//    7. ✅ buildAzureFieldToHeaderMap() - מיפוי שדות Azure\n//       - ממפה Amount_amount → TotalPrice → \"סה\\\"כ מחיר\"\n//       - ממפה UnitPrice_amount → UnitPrice → \"מחיר ליחידה\"\n//       - תואם בין שדות Azure המעובדים לכותרות המקוריות\n//\n// שינויים קודמים (v2.22):\n// 🧹 CODE CLEANUP: ריפקטור וייעול קוד\n//\n// שינויים קודמים (v2.21):\n// 🔴 FIX: lists with URLs and long mixed content\n//\n// שינויים קודמים (v2.20):\n// 🔴 FIX: mobile phones, OCR artifacts, lists, cleanup\n//\n// שינויים קודמים (v2.19):\n// 🔴 FIX: sentences, short hyphenated numbers, partial codes\n//\n// שינויים קודמים (v2.18):\n// 🔴 FIX: phones, dates, system names\n//\n// שינויים קודמים (v2.17):\n// 🔴 FIX: isList broken + noise values + phone parts\n//\n// שינויים קודמים (v2.16):\n// 🎯 GENERIC APPROACH + ביטול currentSection\n// ================================================================\n//\n// ⚠️ חובה! לפני כל תיקון - בדוק בקודים הבאים:\n// - Processing Invoice (v4.2-COMPLETE.js)\n// - Production Invoice (v1.0-production.js)\n//\n// 📁 קבצי בדיקה:\n// - MakeCode/AzureInvoiceProcessor/EXEMPTS/input.txt + output.txt\n// - MakeCode/Processing Invoice/QA/\n// - MakeCode/Production Invoice/QA/\n//\n// 📖 תיעוד מפורט והיסטוריה: ראה README.md\n// ================================================================\n\n// ============================================================================\n// TextStandardization Functions (embedded - Make.com compatible)\n// ============================================================================\n\nfunction removeInvisibleCharacters(text) {\n    return text\n        .replace(/[\\u200B-\\u200D\\uFEFF]/g, '')\n        .replace(/\\u00A0/g, ' ')\n        .replace(/\\u00AD/g, '')\n        .replace(/[\\u200E\\u200F]/g, '')\n        .replace(/[\\u0000-\\u0008\\u000B-\\u000C\\u000E-\\u001F\\u007F-\\u009F]/g, '');\n}\n\nfunction normalizeLineBreaks(text) {\n    return text\n        .replace(/\\r\\n/g, '\\n')\n        .replace(/\\r/g, '\\n')\n        .replace(/\\n{3,}/g, '\\n\\n');\n}\n\nfunction normalizeWhitespace(text) {\n    return text\n        .replace(/\\t/g, ' ')\n        .replace(/  +/g, ' ')\n        .replace(/^ +/gm, '')\n        .replace(/ +$/gm, '')\n        .replace(/ +([,.:;!?])/g, '$1')\n        .replace(/\\(\\s+/g, '(')\n        .replace(/\\s+\\)/g, ')');\n}\n\nfunction normalizeHyphens(text) {\n    return text\n        .replace(/\\u2013/g, '-')\n        .replace(/\\u2014/g, '-')\n        .replace(/\\u2212/g, '-')\n        .replace(/\\u2012/g, '-')\n        .replace(/\\u2015/g, '-');\n}\n\nfunction normalizeHebrew(text) {\n    return text\n        .replace(/\\u05F4/g, '\"')\n        .replace(/\\u05F3/g, \"'\")\n        .replace(/[\\u05BE\\u05C0]/g, '-');\n}\n\nfunction standardizeText(text, options) {\n    if (!text || typeof text !== 'string') return \"\";\n\n    const opts = {\n        removeInvisibleChars: true,\n        normalizeWhitespace: true,\n        normalizeLineBreaks: true,\n        normalizeHyphens: true,\n        normalizeHebrew: true,\n        ...options\n    };\n\n    let cleaned = text;\n\n    if (opts.removeInvisibleChars) {\n        cleaned = removeInvisibleCharacters(cleaned);\n    }\n    if (opts.normalizeLineBreaks) {\n        cleaned = normalizeLineBreaks(cleaned);\n    }\n    if (opts.normalizeWhitespace) {\n        cleaned = normalizeWhitespace(cleaned);\n    }\n    if (opts.normalizeHyphens) {\n        cleaned = normalizeHyphens(cleaned);\n    }\n    if (opts.normalizeHebrew) {\n        cleaned = normalizeHebrew(cleaned);\n    }\n\n    return cleaned.trim();\n}\n\n// ============================================================================\n// פונקציות נרמול ערכים (מקוד DataNormalizer)\n// ============================================================================\n\n/**\n * בדוק אם ערך הוא רשימה - זיהוי גנרי לפי תבנית, לא מילות מפתח!\n * תבניות של רשימות:\n * 1. \"X: Y, Z: W\" - זוגות מפתח-ערך (פסיק + נקודה-שתיים במילים)\n * 2. \"X, Y, Z\" - רשימה של ערכים (2+ פסיקים)\n * 3. \"X; Y\" - נקודה-פסיק\n * 4. \"X | Y\" - pipe (קו אנכי)\n */\nfunction isList(value) {\n    if (typeof value !== 'string') return false;\n\n    // רשימה אם יש נקודה-פסיק או pipe\n    if (value.includes(';') || value.includes('|')) return true;\n\n    // ⚠️ FIX v2.21: רשימה אם יש URL/website\n    // \"04-6333334 פקס': 04-6344123 www.toyota-sos.co.il\" ← יש www = רשימה!\n    if (value.includes('www.') || value.includes('http://') || value.includes('https://')) {\n        return true;\n    }\n\n    const commaCount = (value.match(/,/g) || []).length;\n    const colonCount = (value.match(/:/g) || []).length;\n\n    // רשימה אם יש 2+ פסיקים (לפחות 3 פריטים)\n    if (commaCount >= 2) return true;\n\n    // אם יש 1 פסיק - בדוק אם יש מבנה של זוגות עם נקודה-שתיים\n    if (commaCount >= 1 && colonCount >= 1) {\n        const hasWords = /[א-תa-zA-Z]{2,}/.test(value);\n        if (hasWords) {\n            return true; // \"04-6445585, פקס: 1534-6438399\" ← רשימה!\n        }\n    }\n\n    // ⚠️ FIX v2.20: רשימה אם יש 2+ נקודותיים + מילים (גם ללא פסיק!)\n    // \"טל': 04-6333334 פקס': 04-6344123\" ← יש 2 נקודותיים + מילים = רשימה!\n    if (colonCount >= 2) {\n        const hasWords = /[א-תa-zA-Z]{2,}/.test(value);\n        if (hasWords) {\n            return true;\n        }\n    }\n\n    // ⚠️ FIX v2.21: רשימה אם ארוך מדי עם מספרים מרובים\n    // \"04-6333334 פקס 04-6344123\" ← ארוך (>40) + 2 מספרים = רשימה!\n    if (value.length > 40) {\n        const numberCount = (value.match(/\\d{2,}/g) || []).length;\n        if (numberCount >= 2) {\n            return true;\n        }\n    }\n\n    return false;\n}\n\n/**\n * נקה כותרת/label מתווים מיותרים\n */\nfunction cleanHeader(value) {\n    if (typeof value !== 'string') return value;\n\n    let cleaned = value;\n\n    // הסר תווים מיותרים בהתחלה/סוף\n    cleaned = cleaned.trim();\n\n    // הסר נקודות בסוף (אם יש)\n    cleaned = cleaned.replace(/\\.+$/, '');\n\n    // הסר נקודותיים בסוף\n    cleaned = cleaned.replace(/:+$/, '');\n\n    // הסר רווחים מרובים\n    cleaned = cleaned.replace(/\\s{2,}/g, ' ');\n\n    // הסר סוגריים ריקים\n    cleaned = cleaned.replace(/\\(\\s*\\)/g, '');\n\n    return cleaned.trim();\n}\n\nfunction cleanNumber(value) {\n    if (typeof value !== 'string') return value;\n\n    // ⚠️ FIX v2.18: אל תנרמל תאריכים בפורמט MM.YY או MM/YY\n    // \"06.25\" או \"06/25\" זה חודש/שנה, לא 6.25!\n    if (/^\\d{1,2}[.\\/]\\d{2}$/.test(value.trim())) {\n        return value.trim(); // השאר כמו שהוא - זה תאריך!\n    }\n\n    const cleaned = value.replace(/[,\\s]/g, '');\n\n    // אם זה רצף ספרות ארוך מאוד (>=16), לא להמיר למספר כדי לא לאבד דיוק\n    if (/^\\d{16,}$/.test(cleaned)) {\n        return value.trim(); // השאר מחרוזת מקורית\n    }\n\n    if (/^-?\\d+\\.?\\d*$/.test(cleaned)) {\n        const num = parseFloat(cleaned);\n        return isNaN(num) ? value : num;\n    }\n    return value;\n}\n\nfunction normalizeDate(value) {\n    if (typeof value !== 'string') return value;\n\n    // פורמט ISO: YYYY-MM-DD\n    const isoMatch = value.match(/^(\\d{4})-(\\d{2})-(\\d{2})$/);\n    if (isoMatch) {\n        const year = isoMatch[1];\n        const month = isoMatch[2];\n        const day = isoMatch[3];\n        return `${day}/${month}/${year}`;\n    }\n\n    // פורמט DD/MM/YY או DD/MM/YYYY\n    const dateMatch1 = value.match(/^(\\d{1,2})\\/(\\d{1,2})\\/(\\d{2,4})$/);\n    if (dateMatch1) {\n        const day = dateMatch1[1].padStart(2, '0');\n        const month = dateMatch1[2].padStart(2, '0');\n        let year = dateMatch1[3];\n\n        if (year.length === 2) {\n            year = parseInt(year) > 50 ? '19' + year : '20' + year;\n        }\n\n        return `${day}/${month}/${year}`;\n    }\n\n    return value;\n}\n\nfunction detectCurrencyInValue(value) {\n    if (typeof value !== 'string') return null;\n\n    // מטבע בתחילה: \"USD 24.99\"\n    const prefixMatch = value.match(/^(ILS|USD|EUR|GBP|₪|\\$|€|£|ש\"ח)\\s+/);\n    if (prefixMatch) return prefixMatch[1];\n\n    // מטבע בסוף: \"24.99 USD\"\n    const currencies = ['ILS', 'USD', 'EUR', 'GBP', '₪', '$', '€', '£', 'ש\"ח'];\n    for (const curr of currencies) {\n        if (value.includes(curr)) {\n            return curr;\n        }\n    }\n    return null;\n}\n\nfunction removeCurrency(value, currency) {\n    if (typeof value !== 'string' || !currency) return value;\n    return value.replace(currency, '').trim();\n}\n\nfunction isPercentageField(fieldName) {\n    if (typeof fieldName !== 'string') return false;\n    const lower = fieldName.toLowerCase();\n    return lower.includes('אחוז') || lower.includes('percentage') ||\n           lower.includes('percent') || lower.includes('שיעור') ||\n           fieldName.includes('%');\n}\n\nfunction cleanPercentage(value) {\n    if (typeof value !== 'string') return value;\n    if (!value.endsWith('%')) return value;\n\n    const cleaned = value.replace('%', '').trim();\n    const num = parseFloat(cleaned);\n    return isNaN(num) ? value : num;\n}\n\nconst contentLong = input.contentLong || input.contentlong || '';\nconst pagesInput = input.pages || [];\nconst tablesInput = input.tables || [];\nconst documentsInput = input.documents || [];\nconst modelId = input.modelId || '';\n\nconst azureJsonInput = {\n    content: contentLong,\n    pages: pagesInput,\n    tables: tablesInput,\n    documents: documentsInput,\n    modelId: modelId\n};\n\nfunction processAzureInvoice(azureInput) {\n    const analyzeResult = loadAnalyzeResult(azureInput);\n\n    // ✨ Apply TextStandardization as foundation layer\n    const rawContentFromAzure = analyzeResult.content || '';\n    const rawContent = standardizeText(rawContentFromAzure);\n\n    const tables = analyzeResult.tables || [];\n    const documents = analyzeResult.documents || [];\n\n    const result = {\n        docType: 'invoice',\n        fields: {}\n    };\n\n    if (documents.length > 0 && documents[0].fields) {\n        extractAzureFields(documents[0].fields, result.fields);\n    }\n\n    // אחד פריטים כפולים שAzure מחזיר מטבלאות שונות\n    if (result.fields.Items && result.fields.Items.length > 0) {\n        result.fields.Items = deduplicateItems(result.fields.Items);\n    }\n\n    // חילוץ פריטים מטבלאות + שמירת מפת עמודות מורחבת\n    const itemsExtraction = extractRealItemsFromTable(tables, result.fields.Items);\n    let columnMap = {};\n\n    if (itemsExtraction.items && itemsExtraction.items.length > 0) {\n        result.fields.Items = itemsExtraction.items;\n        columnMap = itemsExtraction.columnMap;\n    } else if (itemsExtraction.length > 0) {\n        // תמיכה לאחור - אם azureItems קיימים (מערך ישן)\n        result.fields.Items = itemsExtraction;\n    } else if (itemsExtraction.columnMap && Object.keys(itemsExtraction.columnMap).length > 0) {\n        // יש columnMap אבל אין items מהטבלה - השתמש ב-azureItems\n        columnMap = itemsExtraction.columnMap;\n    }\n\n    const detectedNumbers = detectNumbersByContext(rawContent, result.fields);\n    Object.assign(result.fields, detectedNumbers);\n\n    // ✨ חדש! זיהוי דינמי של מידע ייחודי\n    const uniqueData = extractUniqueData(rawContent, result.fields);\n    if (uniqueData.length > 0) {\n        result.fields.UnidentifiedNumbers = uniqueData;\n    }\n\n    const structure = buildStructure(result.fields, columnMap);\n    const data = buildData(result);\n\n    return {\n        structure: structure,\n        data: data,\n        metadata: {\n            modelId: analyzeResult.modelId,\n            totalFields: Object.keys(result.fields).length,\n            uniqueDataFound: uniqueData.length,\n            pageCount: analyzeResult.pages ? analyzeResult.pages.length : 0\n        }\n    };\n}\n\nfunction loadAnalyzeResult(input) {\n    if (Array.isArray(input) && input[0] && input[0].analyzeResult) {\n        return input[0].analyzeResult;\n    }\n    if (input.analyzeResult) {\n        return input.analyzeResult;\n    }\n    if (input.content || input.tables) {\n        return input;\n    }\n    throw new Error('Invalid input format');\n}\n\nfunction extractAzureFields(fields, target) {\n    for (const fieldName in fields) {\n        const fieldData = fields[fieldName];\n        if (!fieldData) continue;\n        \n        const type = fieldData.type;\n        \n        if (type === 'string') {\n            target[fieldName] = fieldData.valueString || fieldData.content;\n        }\n        else if (type === 'date') {\n            target[fieldName] = fieldData.valueDate || fieldData.content;\n        }\n        else if (type === 'number') {\n            target[fieldName] = fieldData.valueNumber;\n        }\n        else if (type === 'currency') {\n            if (fieldData.valueCurrency) {\n                target[fieldName + '_amount'] = fieldData.valueCurrency.amount;\n                target[fieldName + '_currency'] = fieldData.valueCurrency.currencyCode;\n            }\n        }\n        else if (type === 'address') {\n            target[fieldName] = fieldData.content;\n            if (fieldData.valueAddress) {\n                for (const key in fieldData.valueAddress) {\n                    const value = fieldData.valueAddress[key];\n                    if (value) {\n                        target[fieldName + '_' + key] = value;\n                    }\n                }\n            }\n        }\n        else if (type === 'array') {\n            if (fieldName === 'Items' && fieldData.valueArray) {\n                target.Items = [];\n                for (let i = 0; i < fieldData.valueArray.length; i++) {\n                    const item = fieldData.valueArray[i];\n                    if (item.valueObject) {\n                        const itemData = {};\n                        for (const key in item.valueObject) {\n                            const val = item.valueObject[key];\n                            if (val.type === 'currency' && val.valueCurrency) {\n                                itemData[key + '_amount'] = val.valueCurrency.amount;\n                                itemData[key + '_currency'] = val.valueCurrency.currencyCode;\n                            }\n                            else if (val.type === 'number') {\n                                itemData[key] = val.valueNumber;\n                            }\n                            else {\n                                itemData[key] = val.valueString || val.content;\n                            }\n                        }\n                        target.Items.push(itemData);\n                    }\n                }\n            }\n            else if (fieldName === 'PaymentDetails' && fieldData.valueArray) {\n                for (let i = 0; i < fieldData.valueArray.length; i++) {\n                    const payment = fieldData.valueArray[i];\n                    if (payment.valueObject) {\n                        for (const key in payment.valueObject) {\n                            const val = payment.valueObject[key];\n                            target['PaymentDetails_' + key] = val.valueString || val.content;\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\nfunction deduplicateItems(items) {\n    if (!items || items.length === 0) {\n        return items;\n    }\n\n    // ⚠️ FIX v2.14: אותו ProductCode יכול להופיע פעמיים - זה לגיטימי!\n    // דדופליקציה רק אם **כל השדות החשובים זהים** (ProductCode + Amount + Quantity)\n\n    const result = [];\n    const seen = [];\n\n    for (let i = 0; i < items.length; i++) {\n        const item = items[i];\n\n        // בדוק אם הפריט הזה כבר קיים (זהה לחלוטין)\n        let isDuplicate = false;\n        for (let j = 0; j < seen.length; j++) {\n            const existing = seen[j];\n\n            // פריט נחשב כפילות רק אם:\n            // 1. ProductCode זהה (או שניהם חסרים)\n            // 2. Amount זהה (או שניהם חסרים)\n            // 3. Quantity זהה (או שניהם חסרים)\n\n            const sameProductCode = (item.ProductCode || '') === (existing.ProductCode || '');\n            const sameAmount = (item.Amount_amount || 0) === (existing.Amount_amount || 0);\n            const sameQuantity = (item.Quantity || 0) === (existing.Quantity || 0);\n\n            if (sameProductCode && sameAmount && sameQuantity) {\n                // זהה לחלוטין - בחר את המלא יותר\n                const existingFields = Object.keys(existing).length;\n                const currentFields = Object.keys(item).length;\n\n                if (currentFields > existingFields) {\n                    // הפריט הנוכחי מלא יותר - החלף\n                    seen[j] = item;\n                }\n                // אחרת - השאר את הקיים\n                isDuplicate = true;\n                break;\n            }\n        }\n\n        if (!isDuplicate) {\n            seen.push(item);\n            result.push(item);\n        }\n    }\n\n    return result;\n}\n\nfunction extractRealItemsFromTable(tables, azureItems) {\n    // ⚠️ חשוב! תמיד נתח את הטבלה תחילה כדי לבנות columnMap\n    if (!tables || tables.length === 0) {\n        // אין טבלה - אם יש azureItems, החזר אותם עם columnMap ריק\n        if (azureItems && azureItems.length > 0) {\n            return {\n                items: azureItems,\n                columnMap: {}\n            };\n        }\n        return {\n            items: [],\n            columnMap: {}\n        };\n    }\n\n    let mainTable = {};\n    let maxCells = 0;\n\n    for (let i = 0; i < tables.length; i++) {\n        const table = tables[i];\n        if (table.cells && table.cells.length > maxCells) {\n            mainTable = table;\n            maxCells = table.cells.length;\n        }\n    }\n\n    if (!mainTable.cells) {\n        // אין תאים בטבלה - אם יש azureItems, החזר אותם עם columnMap ריק\n        if (azureItems && azureItems.length > 0) {\n            return {\n                items: azureItems,\n                columnMap: {}\n            };\n        }\n        return {\n            items: [],\n            columnMap: {}\n        };\n    }\n\n    const headers = [];\n    const dataCells = [];\n\n    for (let i = 0; i < mainTable.cells.length; i++) {\n        const cell = mainTable.cells[i];\n        if (cell.kind === 'columnHeader') {\n            headers.push(cell);\n        } else {\n            dataCells.push(cell);\n        }\n    }\n\n    // בניית מפת עמודות מורחבת עם originalHeader - תמיד!\n    const columnMap = {};\n    for (let i = 0; i < headers.length; i++) {\n        const header = headers[i];\n        const fieldInfo = guessFieldNameGeneric(header.content, header.columnIndex);\n        columnMap[header.columnIndex] = {\n            content: header.content,\n            fieldName: fieldInfo.fieldName,\n            originalHeader: fieldInfo.originalHeader,\n            isUnknown: fieldInfo.isUnknown\n        };\n    }\n\n    const rowsData = {};\n    for (let i = 0; i < dataCells.length; i++) {\n        const cell = dataCells[i];\n        const rowIdx = cell.rowIndex;\n\n        if (!rowsData[rowIdx]) {\n            rowsData[rowIdx] = {};\n        }\n\n        const colInfo = columnMap[cell.columnIndex];\n        if (colInfo && cell.content && cell.content.trim()) {\n            rowsData[rowIdx][colInfo.fieldName] = parseValue(cell.content);\n        }\n    }\n\n    const items = [];\n    const allRows = [];\n\n    for (const rowIdx in rowsData) {\n        const rowData = rowsData[rowIdx];\n        allRows.push(rowData);\n        if (isRealItemRow(rowData)) {\n            items.push(rowData);\n        }\n    }\n\n    // בדיקת ביטחון: אם לא נמצאו פריטים אבל יש שורות עם ProductCode\n    // זה יכול להיות מקרה לגיטימי של פריטים ללא מחירים\n    if (items.length === 0 && allRows.length > 0) {\n        for (let i = 0; i < allRows.length; i++) {\n            const row = allRows[i];\n            if (row.ProductCode && Object.keys(row).length >= 2) {\n                items.push(row);\n            }\n        }\n    }\n\n    // ✅ אם אין פריטים מהטבלה אבל יש azureItems - השתמש בהם\n    // אבל שמור את columnMap שנבנה מהטבלה!\n    if (items.length === 0 && azureItems && azureItems.length > 0) {\n        return {\n            items: azureItems,\n            columnMap: columnMap\n        };\n    }\n\n    return {\n        items: items,\n        columnMap: columnMap\n    };\n}\n\n// ============================================================================\n// מילון תרגום מורחב - עברית לאנגלית\n// ============================================================================\n\n/**\n * מילון תרגום מכותרות עבריות/אנגליות לשמות שדות סטנדרטיים\n * כל ערך מכיל:\n * - field: שם השדה באנגלית\n * - hebrewHeaders: מערך של כותרות בעברית\n * - englishHeaders: מערך של כותרות באנגלית\n */\nfunction getHeaderTranslationMap() {\n    return [\n        {\n            field: 'LineNumber',\n            hebrewHeaders: ['שורה', 'מס שורה', \"מס' שורה\", 'מספר שורה', 'ש', '#'],\n            englishHeaders: ['line', 'line number', 'line no', 'row', 'row number', '#']\n        },\n        {\n            field: 'CustomerOrder',\n            hebrewHeaders: ['הזמנתכם', 'הזמנת לקוח', \"מס' הזמנה\", 'מספר הזמנה', 'הזמנה'],\n            englishHeaders: ['customer order', 'your order', 'order number', 'order no', 'po number', 'po']\n        },\n        {\n            field: 'ProductCode',\n            hebrewHeaders: ['מק\"ט', 'מקט', 'קוד פריט', 'קוד מוצר', 'מק״ט'],\n            englishHeaders: ['sku', 'item code', 'product code', 'code', 'item', 'part number', 'part no']\n        },\n        // ===== SPECIFIC COMPOUND TERMS (must come BEFORE generic terms!) =====\n        {\n            field: 'ChargeDescription',\n            hebrewHeaders: ['תאור חיוב', 'תיאור חיוב'],\n            englishHeaders: ['charge description']\n        },\n        {\n            field: 'PricePerSqm',\n            hebrewHeaders: ['מחיר למ\"ר', 'מחיר למ״ר', 'מחיר למטר', 'מחיר למ\\'\\'ר'],\n            englishHeaders: ['price per sqm', 'price per m2', 'price per square meter']\n        },\n        {\n            field: 'BillableArea',\n            hebrewHeaders: ['שטח לחיוב', 'שטח לחיוב במ\"ר', 'שטח לחיוב במ״ר', 'שטח במ\"ר'],\n            englishHeaders: ['billable area', 'area in sqm', 'chargeable area']\n        },\n        {\n            field: 'AmountToCharge',\n            hebrewHeaders: ['סכום לחיוב', 'סה\"כ לחיוב'],\n            englishHeaders: ['amount to charge', 'total to charge']\n        },\n        {\n            field: 'AmountBeforeLinkage',\n            hebrewHeaders: ['סכום לפני הצמדה', 'סכום לפני הצמדה', 'סכום לפני'],\n            englishHeaders: ['amount before linkage', 'amount before indexation']\n        },\n        {\n            field: 'LinkageCurrency',\n            hebrewHeaders: ['מטבע הצמדה', 'מטבע'],\n            englishHeaders: ['linkage currency', 'currency']\n        },\n        {\n            field: 'BaseRate',\n            hebrewHeaders: ['שער בסיס', 'שער יסוד'],\n            englishHeaders: ['base rate', 'basic rate']\n        },\n        {\n            field: 'CurrentRate',\n            hebrewHeaders: ['שער נוכחי', 'שער עדכני'],\n            englishHeaders: ['current rate', 'present rate']\n        },\n        {\n            field: 'FromDate',\n            hebrewHeaders: ['מתאריך', 'מ-תאריך', 'תאריך התחלה'],\n            englishHeaders: ['from date', 'start date']\n        },\n        {\n            field: 'ToDate',\n            hebrewHeaders: ['עד תאריך', 'עד-תאריך', 'תאריך סיום'],\n            englishHeaders: ['to date', 'end date', 'until date']\n        },\n        {\n            field: 'PaymentDetails',\n            hebrewHeaders: ['ד.תשלום', 'ד תשלום', 'פרטי תשלום'],\n            englishHeaders: ['payment details', 'payment info']\n        },\n        // ===== GENERIC TERMS (after specific terms) =====\n        {\n            field: 'Description',\n            hebrewHeaders: ['תאור', 'תאור מוצר', 'תיאור', 'תיאור מוצר', 'שם מוצר', 'פריט'],\n            englishHeaders: ['description', 'item description', 'product description', 'name', 'product name', 'item name']\n        },\n        {\n            field: 'Quantity',\n            hebrewHeaders: ['כמות', 'כמ', 'כמות מוזמנת'],\n            englishHeaders: ['quantity', 'qty', 'amount', 'ordered qty']\n        },\n        {\n            field: 'Unit',\n            hebrewHeaders: ['יחידה', 'יח', 'יח מידה', 'יחידת מידה'],\n            englishHeaders: ['unit', 'uom', 'unit of measure', 'measure']\n        },\n        {\n            field: 'UnitPrice',\n            hebrewHeaders: ['מחיר ליחידה', 'מחיר יחידה', 'מחיר ליח', \"מחיר ליח'\", 'מחיר'],\n            englishHeaders: ['unit price', 'price per unit', 'price']\n        },\n        {\n            field: 'TotalPrice',\n            hebrewHeaders: ['סה\"כ', 'סה״כ', 'סה\"כ מחיר', 'סך הכל', 'סכום כולל', 'סכום'],\n            englishHeaders: ['total', 'total price', 'sum', 'total amount', 'line total', 'amount']\n        },\n        {\n            field: 'Discount',\n            hebrewHeaders: ['הנחה', 'אחוז הנחה', '% הנחה'],\n            englishHeaders: ['discount', 'discount %', 'disc', 'discount percent']\n        },\n        {\n            field: 'Tax',\n            hebrewHeaders: ['מע\"מ', 'מעמ', 'מס', 'מע״מ'],\n            englishHeaders: ['tax', 'vat', 'sales tax']\n        }\n    ];\n}\n\nfunction guessFieldNameGeneric(content, colIndex) {\n    if (!content || content.trim() === '') {\n        return {\n            fieldName: 'UnknownColumn_' + colIndex,\n            originalHeader: '',\n            isUnknown: true\n        };\n    }\n\n    const originalHeader = content.trim();\n    const text = content.toLowerCase().trim();\n\n    // נסה למצוא התאמה במילון התרגום\n    const translationMap = getHeaderTranslationMap();\n\n    // PASS 1: Try EXACT matches first (highest priority)\n    for (let i = 0; i < translationMap.length; i++) {\n        const mapping = translationMap[i];\n\n        // בדיקה מול כותרות עבריות - התאמה מדויקת\n        for (let j = 0; j < mapping.hebrewHeaders.length; j++) {\n            const hebrewHeader = mapping.hebrewHeaders[j].toLowerCase();\n            if (text === hebrewHeader) {\n                return {\n                    fieldName: mapping.field,\n                    originalHeader: originalHeader,\n                    isUnknown: false\n                };\n            }\n        }\n\n        // בדיקה מול כותרות אנגליות - התאמה מדויקת\n        for (let k = 0; k < mapping.englishHeaders.length; k++) {\n            const englishHeader = mapping.englishHeaders[k].toLowerCase();\n            if (text === englishHeader) {\n                return {\n                    fieldName: mapping.field,\n                    originalHeader: originalHeader,\n                    isUnknown: false\n                };\n            }\n        }\n    }\n\n    // PASS 2: Try substring matches (lower priority, for partial matches)\n    for (let i = 0; i < translationMap.length; i++) {\n        const mapping = translationMap[i];\n\n        // בדיקה מול כותרות עבריות - התאמה חלקית\n        for (let j = 0; j < mapping.hebrewHeaders.length; j++) {\n            const hebrewHeader = mapping.hebrewHeaders[j].toLowerCase();\n            if (text.indexOf(hebrewHeader) >= 0) {\n                return {\n                    fieldName: mapping.field,\n                    originalHeader: originalHeader,\n                    isUnknown: false\n                };\n            }\n        }\n\n        // בדיקה מול כותרות אנגליות - התאמה חלקית\n        for (let k = 0; k < mapping.englishHeaders.length; k++) {\n            const englishHeader = mapping.englishHeaders[k].toLowerCase();\n            if (text.indexOf(englishHeader) >= 0) {\n                return {\n                    fieldName: mapping.field,\n                    originalHeader: originalHeader,\n                    isUnknown: false\n                };\n            }\n        }\n    }\n\n    // אם לא נמצאה התאמה - החזר עמודה לא מזוהה\n    return {\n        fieldName: 'UnknownColumn_' + colIndex,\n        originalHeader: originalHeader,\n        isUnknown: true\n    };\n}\n\nfunction isRealItemRow(rowData) {\n    const keys = Object.keys(rowData);\n\n    if (keys.length < 2) {\n        return false;\n    }\n\n    // ✅ תמיכה בשמות שדות חדשים (TotalPrice) וישנים (Amount)\n    const hasAmount = rowData.Amount !== undefined || rowData.TotalPrice !== undefined;\n    const hasQuantity = rowData.Quantity !== undefined;\n    const hasUnitPrice = rowData.UnitPrice !== undefined;\n\n    // שורה אמיתית חייבת לכלול לפחות אחד מהשדות המספריים:\n    // Amount/TotalPrice, Quantity, או UnitPrice\n    // שורות עם רק ProductCode + Description הן שורות המשך\n    if (!hasAmount && !hasQuantity && !hasUnitPrice) {\n        return false;\n    }\n\n    // אם יש Amount או TotalPrice בודק שהוא תקין\n    if (hasAmount) {\n        const amount = rowData.Amount || rowData.TotalPrice;\n        if (typeof amount === 'number' && amount > 0) {\n            return true;\n        }\n    }\n\n    // אם יש Quantity או UnitPrice - זה פריט תקין\n    if (hasQuantity || hasUnitPrice) {\n        return true;\n    }\n\n    return false;\n}\n\nfunction parseValue(value) {\n    if (typeof value !== 'string') return value;\n    \n    const cleaned = value.replace(/,/g, '').trim();\n    const numPattern = new RegExp('^[0-9]+\\\\.?[0-9]*$');\n    \n    if (numPattern.test(cleaned)) {\n        const num = parseFloat(cleaned);\n        if (!isNaN(num)) {\n            return num;\n        }\n    }\n    \n    return value;\n}\n\nfunction detectNumbersByContext(content, existingFields) {\n    const detected = {};\n    \n    if (!content) return detected;\n    \n    detectVendorAdditionalId(content, existingFields, detected);\n    detectPhoneNumbers(content, existingFields, detected);\n    detectTimes(content, existingFields, detected);\n    detectDates(content, existingFields, detected);\n    detectBankDetails(content, existingFields, detected);\n    detectEmails(content, existingFields, detected);\n    \n    return detected;\n}\n\nfunction findAllNumbers(content, minLen, maxLen) {\n    const numbers = [];\n    const pattern = new RegExp('\\\\b(\\\\d{' + minLen + ',' + maxLen + '})\\\\b', 'g');\n    const matches = content.match(pattern) || [];\n    for (let i = 0; i < matches.length; i++) {\n        numbers.push(matches[i]);\n    }\n    return numbers;\n}\n\nfunction detectVendorAdditionalId(content, existing, detected) {\n    const companyIdx = content.indexOf('Company');\n    if (companyIdx === -1) return;\n\n    const afterCompany = content.substring(companyIdx);\n    const numbers = findAllNumbers(afterCompany, 9, 10);\n\n    if (numbers.length >= 2) {\n        const first = numbers[0];\n        const second = numbers[1];\n\n        if (second !== first &&\n            second !== existing.VendorTaxId &&\n            second !== existing.CustomerTaxId) {\n            detected.VendorAdditionalId = second;\n        }\n    }\n}\n\nfunction detectPhoneNumbers(content, existing, detected) {\n    const phonePattern = new RegExp('[0-9]{2,3}[-\\\\s][0-9]{7,8}', 'g');\n    const matches = content.match(phonePattern) || [];\n    \n    const usedNumbers = [];\n    if (existing.VendorTaxId) usedNumbers.push(existing.VendorTaxId);\n    if (existing.CustomerTaxId) usedNumbers.push(existing.CustomerTaxId);\n    \n    const phones = [];\n    for (let i = 0; i < matches.length; i++) {\n        const phone = matches[i];\n        \n        if (phone.indexOf('\\n') >= 0 || phone.indexOf('\\r') >= 0) {\n            continue;\n        }\n        \n        const cleanPhone = phone.replace(/[-\\s]/g, '');\n        \n        let isUsed = false;\n        for (let j = 0; j < usedNumbers.length; j++) {\n            if (usedNumbers[j] === cleanPhone) {\n                isUsed = true;\n                break;\n            }\n        }\n        \n        if (!isUsed) {\n            const position = content.indexOf(phone);\n            phones.push({\n                phone: phone,\n                position: position,\n                isVendor: position < content.length / 3\n            });\n        }\n    }\n    \n    const vendorPhones = [];\n    const customerPhones = [];\n    \n    for (let i = 0; i < phones.length; i++) {\n        if (phones[i].isVendor) {\n            vendorPhones.push(phones[i]);\n        } else {\n            customerPhones.push(phones[i]);\n        }\n    }\n    \n    if (vendorPhones.length > 0 && !existing.VendorTel) {\n        detected.VendorTel = vendorPhones[0].phone;\n    }\n    if (vendorPhones.length > 1 && !existing.VendorFax) {\n        detected.VendorFax = vendorPhones[1].phone;\n    }\n    if (customerPhones.length > 0 && !existing.CustomerTel) {\n        detected.CustomerTel = customerPhones[0].phone;\n    }\n    if (customerPhones.length > 1 && !existing.CustomerFax) {\n        detected.CustomerFax = customerPhones[1].phone;\n    }\n}\n\nfunction detectTimes(content, existing, detected) {\n    const timePattern = new RegExp('[0-9]{1,2}:[0-9]{2}(:[0-9]{2})?', 'g');\n    const matches = content.match(timePattern) || [];\n    \n    if (matches.length > 0 && !existing.InvoiceTime) {\n        detected.InvoiceTime = matches[0];\n    }\n    if (matches.length > 1 && !existing.PrintTime) {\n        detected.PrintTime = matches[matches.length - 1];\n    }\n}\n\nfunction detectDates(content, existing, detected) {\n    const dates = [];\n    \n    const pattern1 = new RegExp('[0-9]{1,2}[./][0-9]{1,2}[./][0-9]{4}', 'g');\n    const matches1 = content.match(pattern1) || [];\n    for (let i = 0; i < matches1.length; i++) {\n        const parsed = parseDateString(matches1[i]);\n        if (parsed) {\n            dates.push({\n                date: parsed,\n                position: content.indexOf(matches1[i])\n            });\n        }\n    }\n    \n    dates.sort(function(a, b) { return a.position - b.position; });\n    \n    if (dates.length > 0 && !existing.InvoiceDate) {\n        detected.InvoiceDate = dates[0].date;\n    }\n    if (dates.length > 1 && !existing.DueDate) {\n        detected.DueDate = dates[dates.length - 1].date;\n    }\n}\n\nfunction parseDateString(dateStr) {\n    const parts1 = dateStr.match(/([0-9]{1,2})[./]([0-9]{1,2})[./]([0-9]{4})/);\n    if (parts1) {\n        const day = parts1[1].length === 1 ? '0' + parts1[1] : parts1[1];\n        const month = parts1[2].length === 1 ? '0' + parts1[2] : parts1[2];\n        return parts1[3] + '-' + month + '-' + day;\n    }\n    \n    return null;\n}\n\nfunction detectBankDetails(content, existing, detected) {\n    if (!existing.PaymentDetails_IBAN) {\n        const ibanIdx = content.indexOf('IBAN');\n        if (ibanIdx >= 0) {\n            const afterIban = content.substring(ibanIdx);\n            const ibanPattern = new RegExp('IL[0-9]{21}');\n            const match = afterIban.match(ibanPattern);\n            if (match) {\n                detected.PaymentDetails_IBAN = match[0];\n                \n                const accountNum = match[0].substring(match[0].length - 6);\n                if (!existing.PaymentDetails_AccountNumber) {\n                    detected.PaymentDetails_AccountNumber = accountNum;\n                }\n            }\n        }\n    }\n    \n    if (!existing.PaymentDetails_SWIFT) {\n        const swiftIdx = content.indexOf('SWIFT');\n        if (swiftIdx >= 0) {\n            const afterSwift = content.substring(swiftIdx);\n            const swiftPattern = new RegExp('[A-Z0-9]{8,11}');\n            const match = afterSwift.match(swiftPattern);\n            if (match) {\n                detected.PaymentDetails_SWIFT = match[0];\n            }\n        }\n    }\n}\n\nfunction detectEmails(content, existing, detected) {\n    const emailPattern = new RegExp('[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,}', 'g');\n    const matches = content.match(emailPattern) || [];\n    \n    for (let i = 0; i < matches.length; i++) {\n        const email = matches[i];\n        const position = content.indexOf(email);\n        const isVendor = position < content.length / 3;\n        \n        if (isVendor && !existing.VendorEmail && !detected.VendorEmail) {\n            detected.VendorEmail = email;\n        } else if (!isVendor && !existing.CustomerEmail && !detected.CustomerEmail) {\n            detected.CustomerEmail = email;\n        }\n    }\n}\n\n// ================================================================\n// חילוץ גנרי של מידע ייחודי\n// ================================================================\n\nfunction extractUniqueData(content, existingFields) {\n    const uniqueData = [];\n    const seen = {};\n\n    // 1. זוגות \"תווית: ערך\"\n    const pairs = extractLabelValuePairs(content, existingFields);\n    for (let i = 0; i < pairs.length; i++) {\n        if (!seen[pairs[i].value]) {\n            uniqueData.push(pairs[i]);\n            seen[pairs[i].value] = true;\n\n            // סמן גם מספרים שנמצאים בתוך הvalue כדי למנוע כפילויות\n            // לדוגמה: \"1917035 (202857)\" -> סמן גם 1917035 ו-202857\n            const valueStr = String(pairs[i].value); // המרה ל-string למקרה שנרמל למספר\n            const numbersInValue = valueStr.match(/\\d{3,}/g) || [];\n            for (let n = 0; n < numbersInValue.length; n++) {\n                seen[numbersInValue[n]] = true;\n            }\n        }\n    }\n\n    // 2. מספרי תעודות (BOOKNUM) לפי הקשר - זיהוי ספציפי!\n    const docNumbers = extractDocumentNumbers(content, existingFields);\n    for (let i = 0; i < docNumbers.length; i++) {\n        if (!seen[docNumbers[i].value]) {\n            uniqueData.push(docNumbers[i]);\n            seen[docNumbers[i].value] = true;\n        }\n    }\n\n    // 3. מספרים עם פורמט מיוחד (מקפים, קווים נטויים) - לפני pure numbers!\n    const formattedNumbers = extractFormattedNumbers(content, existingFields);\n    for (let i = 0; i < formattedNumbers.length; i++) {\n        if (!seen[formattedNumbers[i].value]) {\n            uniqueData.push(formattedNumbers[i]);\n            seen[formattedNumbers[i].value] = true;\n\n            // סמן גם את החלקים כדי למנוע כפילויות (741-69-103 -> גם 741, 69, 103)\n            const parts = formattedNumbers[i].value.split('-');\n            for (let p = 0; p < parts.length; p++) {\n                seen[parts[p]] = true;\n            }\n        }\n    }\n\n    // 4. כל המספרים (6-12 ספרות) - מונע ברקודים ארוכים ומספרים קצרים מדי\n    const pureNumbers = extractAllPureNumbers(content, existingFields, 6, 12);\n    for (let i = 0; i < pureNumbers.length; i++) {\n        if (!seen[pureNumbers[i].value]) {\n            uniqueData.push(pureNumbers[i]);\n            seen[pureNumbers[i].value] = true;\n        }\n    }\n\n    // 5. כל הקודים האלפא-נומריים (לפחות 5 תווים)\n    const alphaCodes = extractAlphanumericCodes(content, existingFields, 5, 30);\n    for (let i = 0; i < alphaCodes.length; i++) {\n        if (!seen[alphaCodes[i].value]) {\n            uniqueData.push(alphaCodes[i]);\n            seen[alphaCodes[i].value] = true;\n        }\n    }\n\n    return uniqueData;\n}\n\nfunction extractLabelValuePairs(content, existing) {\n    const pairs = [];\n    const lines = content.split('\\n');\n\n    // Pattern 1: \"תווית: ערך\" באותה שורה (מאפשר כל תו בlabel חוץ מ-:)\n    const labelValuePattern = /^([^:\\n]{2,80}):\\s*([^\\n]+)$/;\n    // Pattern 2: תווית עם 2+ רווחים ואז ערך\n    const spacedPattern = /^([א-תA-Za-z\\s\\.]{2,20})\\s{2,}([^\\n]+)$/;\n    // Pattern 3: תווית קצרה (עד 3 מילים) + רווח + ערך מספרי - זיהוי \"מס' תעודה 12345678\"\n    const shortLabelNumericPattern = /^([א-תA-Za-z\\s\\.]{3,30})\\s+(\\d[\\d\\s\\-\\.,\\(\\)]+)$/;\n    // ⚠️ v2.16: ביטול currentSection - יוצר יותר רעש מאשר עוזר!\n    // labels צריכים להיות standalone, ללא שילוב מסקשנים\n\n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i].trim();\n        if (!line || line.length < 3) continue;\n\n        // בדוק \"תווית: ערך\" בכל התבניות\n        let match = line.match(labelValuePattern);\n        if (!match) {\n            match = line.match(spacedPattern);\n        }\n        if (!match) {\n            // נסה את התבנית החדשה - תווית קצרה + ערך מספרי\n            match = line.match(shortLabelNumericPattern);\n            // אבל רק אם הtווית לא מכילה יותר מ-4 מילים (למנוע תפיסת שורות טבלה)\n            if (match) {\n                const wordCount = match[1].trim().split(/\\s+/).length;\n                if (wordCount > 4) {\n                    match = null; // יותר מדי מילים - זה לא label\n                }\n            }\n        }\n\n        if (match) {\n            let label = match[1].trim();\n            let value = match[2].trim();\n\n            // אם הערך ריק או \"לא צויין\" - דלג\n            if (!value || value === '(לא צויין)' || value === '(לא צוינו)') {\n                continue;\n            }\n\n            // ⚠️ FIX v2.19: דלג על ערכים ארוכים מדי (משפטים שלמים)\n            // ערך ארוך מ-100 תווים = כנראה משפט או טקסט ארוך, לא מידע מזהה\n            if (value.length > 100) {\n                continue; // \"לתשומת לבך: רישיון הרכב תקף רק לאחר תשלום...\" ← משפט!\n            }\n\n            // ✅ FIX v2.17: דלג על ערכים שהם רעש\n            // ערכים קצרים מדי (1-2 תווים) כמו \"=\", \":\", וכו'\n            if (value.length <= 2 && !/^\\d+$/.test(value)) {\n                continue; // \"=\" ← רעש!\n            }\n\n            // דלג על ערכים שהם מטא-דאטה/קוד\n            const valueLower = value.toLowerCase();\n            if (valueLower.includes('winsert') || valueLower.includes('@@@')) {\n                continue; // \"WINSERT:...\" או \"בע\"מ @@@\" ← מטא-דאטה!\n            }\n\n            // דלג על ערכים שנראים כמו paths/emails אבל לא דוא\"ל לגיטימי\n            if (value.includes('@') && value.split(':').length > 2) {\n                continue; // \"a240210:120825:C:SI25003642:Account2@t-p-y.co.il\" ← קוד!\n            }\n\n            // ⚠️ FIX v2.20: דלג על OCR artifacts\n            // \":selected:\", \":unselected:\" וכו' = רעש מ-OCR\n            if (value.includes(':selected:') || value.includes(':unselected:')) {\n                continue; // \":selected:\" או \"...www.site.com:selected::selected:\" ← OCR!\n            }\n\n            // ✅ FIX v2.15: דלג על values שהם רשימות (מכילות פסיקים מרובים)\n            if (isList(value)) {\n                continue; // \"טלפון: 04-6445585, פקס: 1534-6438399\" ← רשימה!\n            }\n\n            // ✅ נקה את הlabel מתווים מיותרים\n            label = cleanHeader(label);\n\n            // דלג על labels שהם רק מספרים או קצרים מדי\n            if (label.length < 2 || /^\\d+$/.test(label)) {\n                continue;\n            }\n\n            // ⚠️ FIX v2.19: דלג על labels ארוכים מדי (3+ מילים)\n            // label עם 3 מילים או יותר = לא label אמיתי (כנראה חלק ממשפט)\n            const wordCount = label.split(/\\s+/).filter(w => w.length > 0).length;\n            if (wordCount >= 3) {\n                continue; // \"לתשומת לבך\" ← 2 מילים = בסדר, אבל 3+ = לא label!\n            }\n\n            // ✅ FIX v2.15: דלג על שורות שנראות כמו חלק מטבלה\n            // (מכילות \"סה\"כ\", \"הנחה\", \"total\", \"discount\", אחוזים)\n            const labelLower = label.toLowerCase();\n            if (labelLower.includes('סה\"כ') || labelLower.includes('סה״כ') ||\n                labelLower.includes('הנחה') || labelLower.includes('discount') ||\n                labelLower.includes('total') || label.includes('%') ||\n                labelLower.includes('לתשלום')) {\n                continue;\n            }\n\n            // ⚠️ v2.16: ביטול currentSection - labels הם standalone!\n\n            // ✨ נרמול הערך לפני שמירה\n            let normalizedValue = value;\n\n            // זיהוי והסרת מטבע\n            const currency = detectCurrencyInValue(value);\n            if (currency) {\n                normalizedValue = removeCurrency(normalizedValue, currency);\n            }\n\n            // נרמול אחוזים\n            if (isPercentageField(label)) {\n                normalizedValue = cleanPercentage(normalizedValue);\n            }\n            // ניסיון המרה למספר\n            else {\n                const asNumber = cleanNumber(normalizedValue);\n                if (asNumber !== normalizedValue) {\n                    normalizedValue = asNumber;\n                } else {\n                    // ניסיון המרה לתאריך\n                    const asDate = normalizeDate(normalizedValue);\n                    if (asDate !== normalizedValue) {\n                        normalizedValue = asDate;\n                    }\n                }\n            }\n\n            // ⚠️ FIX v2.20: דלג על labels של מילה בודדת עם ערך מספרי קצר\n            // \"since: 1947\" ← מילה בודדת + 4 ספרות = לא רלוונטי!\n            if (wordCount === 1 && typeof normalizedValue === 'number' && normalizedValue < 100000) {\n                continue; // שנים, מספרים קצרים וכו'\n            }\n\n            if (!isValueExists(normalizedValue, existing) && !isCommonLabel(label)) {\n                pairs.push({label: label, value: normalizedValue});\n            }\n        }\n    }\n    return pairs;\n}\n\nfunction extractFormattedNumbers(content, existing) {\n    const numbers = [];\n\n    // זיהוי מספרים עם מקפים (כמו מספר רישוי: 741-69-103)\n    // מחפש לפחות 2 חלקים מספריים עם מקף ביניהם\n    const hyphenPattern = /\\b(\\d{1,4}-\\d{1,4}(?:-\\d{1,4})*)\\b/g;\n    const matches = content.match(hyphenPattern) || [];\n\n    for (let i = 0; i < matches.length; i++) {\n        const num = matches[i];\n\n        // דלג על תאריכים (DD/MM/YY או DD-MM-YY)\n        if (/^\\d{1,2}[-\\/]\\d{1,2}[-\\/]\\d{2,4}$/.test(num)) {\n            continue;\n        }\n\n        // ⚠️ FIX v2.19: דלג על מספרים קצרים מדי עם מקפים\n        // מספר עם מקף שאורכו הכולל < 6 תווים (כולל מקפים) = כנראה לא רלוונטי\n        if (num.length < 6) {\n            continue; // \"26-9\" (4 תווים) ← לא רלוונטי!\n        }\n\n        // דלג אם יש חלק קצר מדי (< 2 ספרות)\n        const parts = num.split('-');\n        let hasShortPart = false;\n        for (let p = 0; p < parts.length; p++) {\n            if (parts[p].length < 2) {\n                hasShortPart = true;\n                break;\n            }\n        }\n        if (hasShortPart) {\n            continue; // \"765-0021\" עם \"0021\" → אולי בסדר, אבל \"26-9\" עם \"9\" → לא בסדר!\n        }\n\n        // דלג אם כבר קיים בשדות אחרים\n        if (!isValueExists(num, existing)) {\n            numbers.push({label: 'מספר', value: num});\n        }\n    }\n\n    return numbers;\n}\n\nfunction extractAllPureNumbers(content, existing, minLen, maxLen) {\n    const numbers = [];\n\n    // שימוש בפטרן עם negative lookbehind/lookahead למנוע תפיסת חלקים ממחירים וקודים\n    // לא לתפוס מספרים שלפניהם או אחריהם יש: נקודה, פסיק, ספרה, אות, מקף, פלוס, או pipe\n    // כך נמנע מלתפוס \"256\" מ-\"SI256SP005599\" או \"3600\" מ-\"13.3600\" או \"972-4\" מ-\"+972-4-9111442+\"\n    const pattern = new RegExp('(?<![.,\\\\-+|\\\\dA-Za-z])(\\\\d{' + minLen + ',' + maxLen + '})(?![.,\\\\-+|\\\\dA-Za-z])', 'g');\n\n    let match;\n    while ((match = pattern.exec(content)) !== null) {\n        const num = match[1];\n\n        // ⚠️ FIX v2.20: דלג על מספרים שנראים כמו טלפונים\n        // טלפון = 9-10 ספרות שמתחילות ב-0 (ניידים = 9, קוויים = 10)\n        if ((num.length === 9 || num.length === 10) && num.startsWith('0')) {\n            continue; // \"528553984\", \"0506371401\" ← טלפונים!\n        }\n\n        if (!isValueExists(num, existing)) {\n            numbers.push({label: 'מספר', value: num});\n        }\n    }\n\n    return numbers;\n}\n\nfunction extractAlphanumericCodes(content, existing, minLen, maxLen) {\n    const codes = [];\n\n    // ⚠️ FIX v2.19: הגבל אורך מקסימלי ל-15 (לא ארוך מדי)\n    const actualMaxLen = Math.min(maxLen, 15);\n    const pattern = new RegExp('\\\\b([A-Za-z0-9]{' + minLen + ',' + actualMaxLen + '})\\\\b', 'g');\n\n    let match;\n    while ((match = pattern.exec(content)) !== null) {\n        const code = match[1];\n        const matchIndex = match.index;\n\n        // חייב להכיל גם אותיות וגם ספרות\n        if (!/[A-Za-z]/.test(code) || !/\\d/.test(code)) {\n            continue;\n        }\n\n        // ⚠️ FIX v2.19: דלג על קודים שהם חלק מקוד ארוך יותר\n        // בדוק אם יש \"/\" או \"-\" לפני/אחרי הקוד (boundary בעייתי)\n        const charBefore = matchIndex > 0 ? content[matchIndex - 1] : '';\n        const charAfter = matchIndex + code.length < content.length ? content[matchIndex + code.length] : '';\n\n        // אם יש \"/\" או \"-\" ממש לפני או אחרי = זה חלק מקוד ארוך יותר\n        if (charBefore === '/' || charBefore === '-' || charAfter === '/' || charAfter === '-') {\n            continue; // \"65R17\" מ-\"175/65R17\" או \"KGB70L\" מ-\"KGB70L-AHXNKW\" ← חלקי קוד!\n        }\n\n        // ✅ FIX v2.18: דלג על \"קודים\" שהם בעיקר אותיות (כמו \"Invoice4U\")\n        // קוד אמיתי = לפחות 30% ספרות\n        const digitCount = (code.match(/\\d/g) || []).length;\n        const digitRatio = digitCount / code.length;\n        if (digitRatio < 0.3) {\n            continue; // \"Invoice4U\" → 1/9 = 11% ספרות ← לא קוד!\n        }\n\n        // ✅ FIX v2.15: דלג על קודים שכבר קיימים בשדות אחרים\n        if (isValueExists(code, existing)) {\n            continue;\n        }\n\n        // ✅ FIX v2.15: דלג על קודים שנראים כמו מק\"ט לקוח מטבלה\n        // דפוס נפוץ: אות אחת + 6-8 ספרות (r5273535, SO25000145)\n        // אבל אם זה קוד ארוך עם אותיות ומספרים מעורבבים - זה בסדר\n        const singleLetterPattern = /^[a-zA-Z]{1,2}\\d{6,8}$/;\n        if (singleLetterPattern.test(code)) {\n            // זה נראה כמו מק\"ט לקוח - דלג\n            continue;\n        }\n\n        codes.push({label: 'קוד', value: code});\n    }\n\n    return codes;\n}\n\n/**\n * זיהוי ספציפי של מספרי תעודות (BOOKNUM) לפי הקשר\n * מחפש מספרים (6-10 ספרות) בסביבה של מילות מפתח כמו \"תעודה\", \"מס׳ תעודה\", וכו׳\n */\nfunction extractDocumentNumbers(content, existing) {\n    const docNumbers = [];\n    const lines = content.split('\\n');\n\n    // מילות מפתח שמסמנות תעודות\n    const docKeywords = [\n        'תעודה', 'תעוד', \"מס' תעודה\", \"מס׳ תעודה\", 'מספר תעודה',\n        'document', 'doc number', 'doc no', 'doc#', 'document number',\n        'delivery note', 'ת.משלוח', 'ת. משלוח', 'תעודת משלוח',\n        'receipt', 'קבלה', 'מס׳ קבלה', 'מספר קבלה'\n    ];\n\n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i];\n        const lineLower = line.toLowerCase();\n\n        // בדוק אם בשורה יש מילת מפתח של תעודה\n        let hasDocKeyword = false;\n        for (let k = 0; k < docKeywords.length; k++) {\n            if (lineLower.includes(docKeywords[k].toLowerCase())) {\n                hasDocKeyword = true;\n                break;\n            }\n        }\n\n        if (!hasDocKeyword) continue;\n\n        // חפש מספרים בשורה (6-10 ספרות)\n        const numberPattern = /\\b(\\d{6,10})\\b/g;\n        let match;\n        while ((match = numberPattern.exec(line)) !== null) {\n            const num = match[1];\n\n            // דלג אם המספר כבר קיים בשדות אחרים\n            if (!isValueExists(num, existing)) {\n                // נסה לזהות את הlabel המדויק\n                let label = 'מס׳ תעודה';\n\n                // אם יש \":\" לפני המספר, קח את מה שלפני ה-\":\"\n                const beforeNumber = line.substring(0, match.index);\n                const colonMatch = beforeNumber.match(/([^\\n:]{3,30}):\\s*$/);\n                if (colonMatch) {\n                    label = colonMatch[1].trim();\n                }\n                // אם אין \":\", נסה למצוא מילת מפתח סמוכה\n                else {\n                    for (let k = 0; k < docKeywords.length; k++) {\n                        const keyword = docKeywords[k];\n                        const keywordIndex = lineLower.lastIndexOf(keyword.toLowerCase(), match.index);\n                        if (keywordIndex >= 0 && match.index - keywordIndex < 40) {\n                            label = keyword;\n                            break;\n                        }\n                    }\n                }\n\n                docNumbers.push({label: label, value: num});\n            }\n        }\n    }\n\n    return docNumbers;\n}\n\nfunction normalizeValue(value) {\n    // Remove special characters (hyphens, spaces, dots, parentheses, colons)\n    return value.toString().replace(/[-\\s.():]/g, '').toLowerCase();\n}\n\nfunction isValueExists(value, existing) {\n    const valueStr = value.toString().toLowerCase();\n    const normalizedValue = normalizeValue(value);\n\n    // Skip very short values (less than 3 chars) as they create too many false positives\n    if (normalizedValue.length < 3) {\n        return false;\n    }\n\n    for (const key in existing) {\n        const fieldValue = existing[key];\n\n        if (typeof fieldValue === 'string') {\n            const fieldStr = fieldValue.toLowerCase();\n            const normalizedField = normalizeValue(fieldValue);\n\n            // Exact match (before normalization)\n            if (fieldStr === valueStr) {\n                return true;\n            }\n\n            // Check if value is part of field (after normalization)\n            if (normalizedField.includes(normalizedValue)) {\n                // If it's a prefix or suffix, filter it out (e.g., \"052\" in \"052-5457201\")\n                if (normalizedField.startsWith(normalizedValue) || normalizedField.endsWith(normalizedValue)) {\n                    return true;\n                }\n\n                // If it's in the middle, only filter if it's a significant portion (50%+)\n                // This prevents \"256\" from being filtered just because it's in \"SI256SP005599\"\n                const lengthRatio = normalizedValue.length / normalizedField.length;\n                if (lengthRatio >= 0.5) {\n                    return true;\n                }\n            }\n        } else if (typeof fieldValue === 'number') {\n            if (fieldValue.toString() === valueStr) {\n                return true;\n            }\n        } else if (Array.isArray(fieldValue)) {\n            for (let i = 0; i < fieldValue.length; i++) {\n                const item = fieldValue[i];\n                if (typeof item === 'string') {\n                    const itemStr = item.toLowerCase();\n                    const normalizedItem = normalizeValue(item);\n\n                    if (itemStr === valueStr) {\n                        return true;\n                    }\n\n                    if (normalizedItem.includes(normalizedValue)) {\n                        if (normalizedItem.startsWith(normalizedValue) || normalizedItem.endsWith(normalizedValue)) {\n                            return true;\n                        }\n                        const lengthRatio = normalizedValue.length / normalizedItem.length;\n                        if (lengthRatio >= 0.5) {\n                            return true;\n                        }\n                    }\n                }\n                if (typeof item === 'object') {\n                    if (isValueExists(value, item)) {\n                        return true;\n                    }\n                }\n            }\n        } else if (typeof fieldValue === 'object' && fieldValue !== null) {\n            if (isValueExists(value, fieldValue)) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\n\nfunction isCommonLabel(label) {\n    const common = [\n        'total', 'sum', 'סך', 'סכום', 'page', 'עמוד',\n        'date', 'תאריך', 'amount', 'כמות', 'price', 'מחיר'\n    ];\n\n    const labelLower = label.toLowerCase();\n    return common.some(function(keyword) {\n        return labelLower.indexOf(keyword) >= 0;\n    });\n}\n\nfunction buildStructure(fields, columnMap) {\n    const structure = {\n        docType: \"string\",\n        fields: {}\n    };\n\n    for (const fieldName in fields) {\n        const fieldValue = fields[fieldName];\n        if (fieldName === 'Items') {\n            structure.Items = buildItemsStructure(fieldValue, columnMap);\n        }\n        else if (fieldName === 'UnidentifiedNumbers') {\n            structure.fields.UnidentifiedNumbers = [\"object\"];\n        }\n        else if (Array.isArray(fieldValue)) {\n            structure.fields[fieldName] = [\"string\"];\n        }\n        else {\n            structure.fields[fieldName] = getFieldType(fieldName, fieldValue);\n        }\n    }\n\n    return structure;\n}\n\n/**\n * בונה מיפוי בין שדות Azure (Amount_amount) לכותרות מקוריות\n * על ידי התאמה לפי לוגיקה - Amount_amount/TotalPrice → \"סה\"כ מחיר\"\n */\nfunction buildAzureFieldToHeaderMap(columnMap) {\n    const azureToOriginal = {};\n\n    if (!columnMap || typeof columnMap !== 'object') {\n        return azureToOriginal;\n    }\n\n    // מיפוי ידוע מראש: שדות Azure ← שדות חדשים\n    const knownMapping = {\n        'Amount_amount': 'TotalPrice',\n        'Amount_currency': 'TotalPrice',\n        'UnitPrice_amount': 'UnitPrice',\n        'UnitPrice_currency': 'UnitPrice',\n        'Discount': 'Discount',\n        'ProductCode': 'ProductCode',\n        'Description': 'Description',\n        'Quantity': 'Quantity',\n        'Unit': 'Unit'\n    };\n\n    // בנה מיפוי מהcolumnMap\n    for (const colIndex in columnMap) {\n        const colInfo = columnMap[colIndex];\n        const newFieldName = colInfo.fieldName;\n        const originalHeader = colInfo.originalHeader;\n\n        // מצא את שם השדה ב-Azure שמתאים לשדה החדש\n        for (const azureField in knownMapping) {\n            if (knownMapping[azureField] === newFieldName) {\n                azureToOriginal[azureField] = originalHeader;\n            }\n        }\n    }\n\n    return azureToOriginal;\n}\n\nfunction buildItemsStructure(items, columnMap) {\n    if (!items || items.length === 0) {\n        return [];\n    }\n\n    const itemStructure = {};\n    const firstItem = items[0];\n\n    // בנה מיפוי משדות Azure לכותרות מקוריות\n    const azureToOriginal = buildAzureFieldToHeaderMap(columnMap);\n\n    // בניית structure מורחב עם originalHeader\n    for (const fieldName in firstItem) {\n        const fieldValue = firstItem[fieldName];\n        const fieldType = getFieldType(fieldName, fieldValue);\n\n        // חפש את originalHeader - תחילה במיפוי Azure, אחר כך במפת העמודות\n        let originalHeader = '';\n\n        // בדוק אם זה שדה מ-Azure (Amount_amount, וכו')\n        if (azureToOriginal[fieldName]) {\n            originalHeader = azureToOriginal[fieldName];\n        } else if (columnMap && typeof columnMap === 'object') {\n            // זה שדה מהטבלה - חפש בcolumnMap\n            for (const colIndex in columnMap) {\n                const colInfo = columnMap[colIndex];\n                if (colInfo.fieldName === fieldName) {\n                    originalHeader = colInfo.originalHeader;\n                    break;\n                }\n            }\n        }\n\n        // בנה אובייקט מורחב לכל שדה\n        itemStructure[fieldName] = {\n            type: fieldType,\n            originalHeader: originalHeader || fieldName\n        };\n    }\n\n    return [itemStructure];\n}\n\nfunction getFieldType(fieldName, fieldValue) {\n    if (fieldName.indexOf('Date') >= 0) return \"YYYY-MM-DD\";\n    if (fieldName.indexOf('Time') >= 0) return \"HH:MM:SS\";\n    if (fieldName.indexOf('_amount') >= 0) return \"number\";\n    if (fieldName.indexOf('_currency') >= 0) return \"string\";\n    if (typeof fieldValue === 'number') return \"number\";\n    return \"string\";\n}\n\nfunction buildData(result) {\n    return {\n        docType: result.docType,\n        fields: result.fields\n    };\n}\n\n// הרץ את הפונקציה והחזר תוצאה\nconst finalResult = processAzureInvoice(azureJsonInput);\n\nfinalResult.status = 'success';\n\n// Export for require() compatibility\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = finalResult;\n}\n\nreturn finalResult;\n"
    }
]
